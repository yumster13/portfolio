apex.model={},function(e,t,i,n,s,r,a){"use strict";const l="table",d="tree",o="record",h="Malformed response",c="refresh",u="addData",g="revert",f="refreshRecords",_="delete",p="clearChanges",y="set",I="destroy";let v={},m=[],R=100,w=10;const x=new Set(["genIdPrefix","pageItemsToSubmit","fetchData","saveData","regionData","requestOptions","parentRecordId","editable","pageSize","callServer","visibilityFilter","visibilityFilterContext"]),F=n.hasOwnProperty,b=a.extend,M=Array.isArray,A=a.isPlainObject,D=e=>"function"==typeof e,K=a.Deferred,S=r.toNumber;function C(e){return e.replace(/#/g,"").split(/\s*,\s*/)}function T(e){return"object"==typeof e&&F(e,"v")}function E(e){if("string"==typeof e)return[e,null];if(M(e)&&2===e.length&&"string"==typeof e[0]&&(null===e[1]||"string"==typeof e[1]))return e;throw new Error("Invalid model id")}const k=new Map;function O(e){let t=k.get(e);return t||(t=1e3),k.set(e,t+1),t}function q(e){if(M(e)){let t=[];for(let i=0;i<e.length;i++)t.push(q(e[i]));return t}return A(e)?b(!0,{},e):e}function V(e,t,i){let n=e._listeners;for(let e=0;e<n.length;e++)n[e].onChange(t,i)}function P(e,t,i,n,s,r){e?t.call(e,i,n,s,r):t(i,n,s)}function N(e){e.allowedOperations&&(e.canEdit=!!e.allowedOperations.update,e.canDelete=!!e.allowedOperations.delete)}function j(e){return"string"==typeof e?e:M(e)?1===e.length?""+e[0]:JSON.stringify(e):e.toString()}function U(e,t){var i,s=[],r=[];function l(e){var t,i,n=e._listeners;for(t=0;t<n.length;t++)(i=n[t].progressView)&&i[0]&&i[0].offsetWidth&&i[0].offsetHeight&&(s.push(i),r.push(n[t].progressOptions||null))}if(l(e),t)for(i=0;i<t.length;i++)l(t[i]);return 0===s.length?null:e._options.makeLoadingIndicator?e._options.makeLoadingIndicator(s,r):function(){var e,t,i=a();for(e=0;e<s.length;e++)t=n.showSpinner(s[e],r[e]),i=i.add(t);return function(){i.remove()}}}function z(e,t){return b({},e.requestOptions,{loadingIndicator:U(t)})}function B(e,t,i,n){let s,r=e;return n&&(r+=" Server status: "+n),s=new Error(r),t&&t.status>=0&&(s.status=t.status),s}function $(e,t){var i,n;for(i in delete e.error,delete e.warning,delete e.message,e.fields)F(e.fields,i)&&(n=e.fields[i],t||(delete n.changed,delete n.stale),delete n.error,delete n.warning,delete n.message)}function W(e,t,i){let n=-1,s=-1;return t-1>=0&&(n=parseFloat(e[t-1][i])),t<e.length&&(s=parseFloat(e[t][i])),[n,s]}function H(e,t,i,n,s,r){let a;return-1===t&&(t=0),r&&r>t&&(-1===i||r<i)?r:(-1===i&&(i=t+e*n),a=i-t,t+a/(n+1)*s)}const G=e=>new Error(`Model has invalid shape for the ${e} method`),L=e=>new Error(`Wrong data type for ${e} aggregate`),X=()=>new Error("Model must have identityField defined"),Y=(e,t)=>new Error(`Field '${e}' depends on unknown field/item '${t}'`),J=(e,t)=>new Error(e+" field not found: "+t);function Q(e,t){var i,n=e,s=t;if(null!==e&&T(e)&&(n=e.v,null!==t&&T(t)&&(s=t.v)),M(n)&&M(s)){if(n.length!==s.length)return!1;for(i=0;i<n.length;i++)if(n[i]!=s[i])return!1;return!0}return n==s}function Z(e,t,i){var n,s,r,a;for(n in t)F(t,n)&&((s=t[n]).volatile||s.virtual||"string"==typeof(a=e[r=i?s.index:n])&&(e[r]=a.replace(/\r\n/g,"\n")))}function ee(e,t,i,n,r){let a=e._options,l=t.record,d=e._getIdentity(l),o=[];!function t(i,n,s){for(let r=0;r<i.length;r++){let l,d=i[r],o=a.fields[d];o&&!n[d]&&(o.dependsOn&&t(o.dependsOn,n,s),n[d]||!o.calcValue&&!o.dependsOn||(s.push(d),n[d]=1,l=e._dependentFields[d],l&&t(l,n,s)))}}(i,r||{},o);for(let i=0;i<o.length;i++){let r,h,c,u,g,f,_,p,I=o[i],v=a.fields[I];if(v.calcValue){f=[];for(let t=0;t<v.dependsOn.length;t++)c=v.dependsOn[t],":"===c.substr(0,1)?_=s(c.substr(1)).getValue():(u=a.fields[c],_=e.getValue(l,c),"NUMBER"===v.dataType&&(_=S(_,u?u.formatMask:null))),f.push(_);if(p=v.calcValue(f,e,l),r=e.getFieldKey(I),t.fields&&t.fields[I]&&t.fields[I].ck)throw new Error("Set calculated value not allowed for field");h=l[r],Q(h,p)||(l[r]=p,t.fields||(t.fields={}),g=t.fields[I],g||(g={},t.fields[I]=g),g.changed=!0,n&&V(e,y,{oldValue:h,oldIdentity:null,recordId:d,record:l,field:I}),e._checkAggregates(I))}else g=t.fields[I],g||(g={},t.fields[I]=g),g.stale=!0,n&&e.metadataChanged(d,I,"stale")}}function te(e,t){var i,n,s={},r=t.record,a=[];for(i=0;i<e._calculatedFields.length;i++)n=e._calculatedFields[i],null==r[e.getFieldKey(n)]?a.push(n):s[n]=1;a.length>0&&ee(e,t,a,!1,s)}const ie={SUM:{name:"SUM",init:function(e){if(e.dataType&&"NUMBER"!==e.dataType)throw L("SUM");e.total=0,e.grandTotal=0},add:function(e,t){t=S(t,e.formatMask),isNaN(t)||(e.total+=t,e.grandTotal+=t)},get:function(e,t){var i=t?e.total:e.grandTotal;return t&&(e.total=0),i}},AVG:{name:"AVG",init:function(e){if(e.dataType&&"NUMBER"!==e.dataType)throw L("AVG");e.total=0,e.grandTotal=0,e.count=0,e.totalCount=0},add:function(e,t){t=S(t,e.formatMask),isNaN(t)||(e.total+=t,e.grandTotal+=t,e.count+=1,e.totalCount+=1)},get:function(e,t){var i=t?e.total/e.count:e.grandTotal/e.totalCount;return t&&(e.total=0,e.count=0),i}},MAX:{name:"MAX",init:function(e){e.max=null,e.overallMax=null},add:function(e,t){"NUMBER"===e.dataType?t=S(t,e.formatMask):t.d&&(t=t.d),null===t||""===t.toString().trim()||isNaN(t)||((null===e.max||t>e.max)&&(e.max=t),(null===e.overallMax||t>e.overallMax)&&(e.overallMax=t))},get:function(e,t){var i=t?e.max:e.overallMax;return t&&(e.max=null),i}},MIN:{name:"MIN",init:function(e){e.min=null,e.overallMin=null},add:function(e,t){"NUMBER"===e.dataType?t=S(t,e.formatMask):t.d&&(t=t.d),null===t||""===t.toString().trim()||isNaN(t)||((null===e.min||t<e.min)&&(e.min=t),(null===e.overallMin||t<e.overallMin)&&(e.overallMin=t))},get:function(e,t){var i=t?e.min:e.overallMin;return t&&(e.min=null),i}},MEDIAN:{name:"MEDIAN",init:function(e){e.values=[],e.allValues=[]},add:function(e,t){t=S(t,e.formatMask),isNaN(t)||(e.values.push(t),e.allValues.push(t))},get:function(e,t){var i,n=t?e.values:e.allValues,s=n.length;return n.sort((function(e,t){return e-t})),i=s%2==0?(n[s/2]+n[s/2-1])/2:n[(s-1)/2],t&&(e.values=[]),i}},COUNT:{name:"COUNT",init:function(e){e.count=0,e.totalCount=0},add:function(e,t){t.v&&(t=t.v),null!==t&&""!==t.toString().trim()&&(e.count+=1,e.totalCount+=1)},get:function(e,t){var i=t?e.count:e.totalCount;return t&&(e.count=0),i}},COUNT_DISTINCT:{name:"COUNT_DISTINCT",init:function(e){e.count=0,e.totalCount=0,e.distinctValues={}},add:function(e,t){t.v&&(t=t.v),null!==t&&""!==t.toString().trim()&&(e.distinctValues[t]||(e.count+=1,e.totalCount+=1),e.distinctValues[t]=1)},get:function(e,t){var i=t?e.count:e.totalCount;return t&&(e.count=0),i}}},ne={modelId:function(){return null===this.instance?this.name:[this.name,this.instance]},_addToFetchRequest:function(e,t){let n,s,r,a,c,u=this,g=this._options;if(g.shape===l){if(f=t,_=g.pageSize,c=Math.floor(f/_)*_,t=function(e){let t,i=u._data;for(t=e;t<i.length&&void 0!==i[t];t++);return t}(c),this._haveAllData&&t>=this._data.length||this._masterRecordIsInserted||this._masterRecordIsDeleted)return!1;a=this._getServerOffset(t),r=c+g.pageSize-a,r<g.pageSize&&void 0===this._data[c+g.pageSize]&&(r+=g.pageSize),n={version:g.version,firstRow:a+1,maxRows:r}}else n={version:g.version};var f,_;if(this._requestsInProgress.fetch)return null;if(s=b({},g.regionData,{id:g.regionId,ajaxIdentifier:g.ajaxIdentifier,fetchData:b({},g.fetchData,n)}),e.regions||(e.regions=[]),e.regions.push(s),g.pageItemsToSubmit){let t,i=e.pageItems;i?M(i)||(i=C(i),e.pageItems=i):(i=[],e.pageItems=i),t=g.pageItemsToSubmit,M(t)||(t=C(t));for(let e=0;e<t.length;e++)i.includes(t[e])||i.push(t[e])}return this._addParentItems(s),this._requestsInProgress.fetch=!0,function(e){e.done((function(e){let n=!1;if(delete u._requestsInProgress.fetch,!u._destroyed){if(e.regions)for(let i=0;i<e.regions.length;i++){let s=e.regions[i];if(s.id===g.regionId){let e=null,i=null,r=null,a=null,h=null;s=s.fetchedData,g.shape===l?(e=s.values,i=s.totalRows,r=s.firstRow-1,a=s.moreData,h=s.dataOverflow):g.shape===d?e=s.root:g.shape===o&&(e=s.value),e&&(u._addData(t,r,e,i,a,h),n=!0)}}if(!n){let t=B(h);i.error("Failed to fetch data.",t),e.error=t}}})).fail((function(){delete u._requestsInProgress.fetch}))}},fetch:function(e,t,i){let n,s,r,a,l=this._options,d=K(),o={};return"number"!=typeof e&&(i=t,t=e,e=0),s=this._addToFetchRequest(o,e),s?(a=b({},l.requestOptions),i?delete a.loadingIndicator:a.loadingIndicator=U(this),n=this._callServer(o,a),s(n),n.done((e=>{e.error?d.reject(e.error):e.errors?d.reject(e.errors):d.resolve()})).fail(((e,t,i)=>{d.reject(B("Error fetching data.",e,0,i))})),r=d.promise(),r.always((e=>{this._destroyed||(t&&t(e),this._drainWaiters(e))})),r):null},fetchAll:function(e){var t=this,i=0,n=this._options,s=n.pageSize;if(n.shape!==l)throw G("fetchAll");for(;this._data[i];)i+=1;!function n(){var r=t.fetch(i,(function(r){r?e({error:r}):(e({offset:i,total:t.getTotalRecords(),done:!1}),i+=s,n())}),!0);null===r?setTimeout((function(){n()}),500):!1===r&&e({offset:i,total:t.getTotalRecords(),done:!0})}()},fetchRecords:function(e,t){let n,s,r,a,l,d=this._options,c=[],u=K();if(d.shape===o)throw G("fetchRecords");if(void 0===this._identityKeys)throw X();for(let t=0;t<e.length;t++){let i=this._getIdentity(e[t]),n=this.getRecordMetadata(i);n&&!n.inserted&&c.push({recordId:i,pk:this._getPrimaryKey(e[t])})}return 0===c.length?null:(l=b({},d.regionData,{id:d.regionId,ajaxIdentifier:d.ajaxIdentifier,fetchData:b({},d.fetchData,{version:d.version,primaryKeys:c})}),r={regions:[l]},d.pageItemsToSubmit&&(r.pageItems=d.pageItemsToSubmit),this._addParentItems(r.regions[0]),a=z(d,this),n=this._callServer(r,a),n.done((e=>{let t;if(!this._destroyed){if(e.regions&&e.regions.length>0){let i=e.regions[0];i.fetchedData&&i.id===d.regionId&&(t=i.fetchedData.values)}if(t)this._updateData(t),u.resolve();else{let e=B(h);i.error("Failed update data.",e),u.reject(e)}}})).fail((function(e,t,i){u.reject(B("Error fetching records.",e,0,i))})),s=u.promise(),t&&s.always(t),s)},save:function(e){let t,i,n,s=z(this._options,this),r=K(),a={};return i=this.addChangesToSaveRequest(a),i?(t=this._callServer(a,s),i(t),t.done((function(e){e.errors?r.reject(e.errors):e.error?r.reject(e.error):r.resolve(null,e)})).fail((function(e,t,i){r.reject(B("Error saving data.",e,0,i))})),n=r.promise(),e&&n.always(e),n):null},saveInProgress:function(){return!!this._requestsInProgress.save},addChangesToSaveRequest:function(e){let t,s,r,a,l,d,o,c=this,u=this._options,g=this._metaKey,f=[],_=[],p={},y=[],I=0;function v(){delete c._requestsInProgress.save,c._changes=c._pendingChanges.concat(c._changes)}function m(e){let t,i,n,s,r,a,l=e.record;r=e.inserted&&!e.originalId,t=u.recordIsArray?[]:{};for(let s=0;s<_.length;s++)n=_[s],i=l[n],null!==i&&T(i)&&(i=i.v),a=p[n],e.fields&&e.fields[a]&&e.fields[a].disabled&&(i=""),!r||!c.isIdentityField(a)||e.original&&i!==e.original[n]||(i=""),"string"==typeof i&&(i=i.replace(/\n/g,"\r\n")),u.recordIsArray?t.push(q(i)):t[n]=q(i);s=null,e.deleted?s="d":e.inserted?s="i":e.updated&&(s="u"),t[g]||(t[g]={}),s&&(t[g].op=s),t[g].recordId=c._getIdentity(l),e.originalId&&(t[g].originalId=e.originalId),u.saveSelection&&(t[g].sel=e.sel?"Y":"N"),y.push(t)}if(u.pageItemsToSubmit){let t,i=e.pageItems;if(i||(i=[],e.pageItems=i),M(i)){t=u.pageItemsToSubmit,M(t)||(t=C(t));for(let e=0;e<t.length;e++)i.includes(t[e])||i.push(t[e])}}if(this._requestsInProgress.save||0===this._changes.length&&!u.saveSelection)return null;for(let e in u.fields)F(u.fields,e)&&(t=u.fields[e],t.virtual||(I+=1),t.volatile||t.virtual||(s=u.recordIsArray?t.index:e,_.push(s),p[s]=e,u.recordIsArray&&t.index===this._metaKey&&(g=_.length-1)));u.recordIsArray&&_.sort((function(e,t){return e-t})),g||(g=u.recordIsArray?_.length:"_meta");for(let e=0;e<this._changes.length;e++)r=this._changes[e],r.autoInserted&&!r.updated&&f.push(r.record);f.length&&this.deleteRecords(f);for(let e=0;e<this._changes.length;e++)r=this._changes[e],m(r);if(this._pendingChanges=this._changes,this._changes=[],u.saveSelection)for(const e of this._selection.values())e.inserted||e.deleted||e.updated||m(e);a=e.regions,a||(e.regions=a=[]);for(let e=0;e<a.length&&(l=a[e],l.id!==u.regionId);e++)l=null;return l||(l=b({},u.regionData,{id:u.regionId,ajaxIdentifier:u.ajaxIdentifier,saveData:{models:[]}}),a.push(l)),d=l.saveData.models,o=b({},u.saveData,{instance:this.instance,version:u.version,values:y}),this._addParentItems(o),d.push(o),this._requestsInProgress.save=!0,function(e){e.done((function(e){let t,s;if(!c._destroyed){if(e.errors){for(let t=0;t<e.errors.length;t++){let i=e.errors[t],s=i.message;i.unsafe||(s=n.unescapeHTML(s)),i.regionStaticId===u.regionStaticId&&i.recordId&&i.instance==c.instance&&c.setValidity("error",i.recordId,i.columnName||null,s)}v()}else if(e.regions){let n,r=!1,a=null;for(let i=0;i<e.regions.length;i++){if(t=e.regions[i],t.id===u.regionId){n=t.fetchedData.models;for(let e=0;e<n.length;e++)if(n[e].instance==c.instance){a=n[e].values,c._metaKey||(s=u.recordIsArray?I:"_meta"),a&&(c._updateData(a,s),r=!0);break}break}t=null}if(!r){let t=B(h);i.error("Failed update data after save.",t),e.error=t}c._clearChanges("_pendingChanges")}delete c._requestsInProgress.save}})).fail((function(){v()}))}},setData:function(e,t=0,i=null,n=!1){null===i&&e&&!n&&(i=e.length),this._addData(t,t,e,i,n,!1),0!==t&&null!==t||V(this,c,{})},clearData:function(e=!0){let t=this._requestsInProgress;return!t.fetch&&!t.save&&(this._clear(),e&&V(this,c,{}),!0)},getTotalRecords:function(e){let t=this._options;return t.shape===l?this._haveAllData||"none"===t.paginationType?this._data.length:this._totalRecords<0&&!0!==e?this._totalRecords:Math.max(this._data.length,this._totalRecords):t.shape===o?1:t.shape===d?this._index.size:void 0},getServerTotalRecords:function(){var e=this._options;return e.shape===l?this._totalRecords<0?this._totalRecords:this._totalRecords+this._numInsertedRecords-this._numDeletedRecords:e.shape===o?1:e.shape===d?-1:void 0},getDataOverflow:function(){return!!this.dataOverflow},forEach:function(e,t){var i,n,s,r=this,a=this._options,l=this._data;if(a.shape===o)throw G("forEach");if(a.shape===d)i=0,l&&this.walkTree(l,{node:function(n){P(t,e,n,i,r._getIdentity(n)),i+=1}});else for(s=l.length,i=0;i<s;i++)(n=l[i])&&P(t,e,n,i,this._getIdentity(n,i))},transform:function(e,t){var i,n,s,r,a,l=/^\[\W*([^ \t/]+)\W*]$/,d=e.template,o=e.showNullAs,h=d.length,c=[],u={},g=this;function f(e,t){var i;return(i=e[t])||(i={values:{},paths:[]},e[t]=i),i}function _(e,t,i,n,s,r){var a,d,o,h,c,u,g,_;if(e){for(c=e.split("/"),u=n,g=null,_=null,o=null,a=0;a<c.length;a++){if(o=c[a],d=l.exec(o)){f(r,d[1]).paths[t]=c.slice(a+1).join("/");break}g=u,_=o,F(u,o)||(u[o]={}),u=u[o]}g?(M(g[_])?(h=g[_]).length=0:h=[],g[_]=h):h=n,s[t]=h}else{if(!M(n))throw new Error("Context must be an array when there is no path");s[t]=n}i&&f(r,i)}function p(e,i,n,s){var r,a,l,d,h=!1;return"string"==typeof e?(r=e.length,l=e.charAt(0),d=e.charAt(r-1),"'"===l&&"'"===d?e.substring(1,r-1):("("===l&&")"===d&&(e=e.substring(1,r-1),h=!0),null!==(a=g.getValue(i,e))&&"object"==typeof a&&F(a,"d")&&(a=h?a.v:a.d),h||!o||null!==a&&""!==a||(a=o),a)):D(e)?e.call(t,g,i,n,s):null===e?e:M(e)?function(e,t,i,n,s){var r,a;for(r=0;r<e.length;r++)void 0!==(a=p(e[r],i,n,s))&&(t[r]=a);return t}(e,[],i,n,s):"object"==typeof e?function(e,t,i,n,s){var r,a;for(r in e)F(e,r)&&void 0!==(a=p(e[r],i,n,s))&&(t[r]=a);return t}(e,{},i,n,s):void 0}function y(e,t,i,n){var s,r,a,d=[];if(e)for(e=e.split("/"),s=0;s<e.length;s++)r=e[s],(a=l.exec(r))&&d.push({key:a[1],value:p(a[1],t,i,n)});return d}function I(i,n,s){var l,o,I,v,m,R,w,x,F,b,M;if(!(n<r||a>0&&n>=r+a)&&(e.includeAggregates||!g._metaKey||!i[g._metaKey].agg)&&(!e.filter||e.filter.call(t,g,i,n,s)))for(l=0;l<h;l++)if(R=null,I=d[l],v=c[l],!I.filter||I.filter.call(t,g,i,n,s)){if(I.uniqueIndexField&&(R=u[I.uniqueIndexField],w=p(I.uniqueIndexField,i,n,s),void 0!==R.values[w]))continue;if(void 0!==(m=p(I.item,i,n,s))){if(R)R.values[w]={index:v.length,arrays:[],indexes:{}};else for(x=y(I.path,i,n,s),M=u,o=0;o<x.length;o++)void 0===(F=(R=f(M,x[o].key)).values[x[o].value])&&(F={index:v.length,arrays:[],indexes:{}},b=""===R.paths[l]?[]:{},v.push(b),R.values[x[o].value]=F),b=v[F.index],F.arrays[l]||_(R.paths[l],l,null,b,F.arrays,F.indexes),v=F.arrays[l],M=F.indexes;v.push(m)}}}for(null!==t&&"object"==typeof t||(t={}),function(){var e,i;for(e=0;e<d.length;e++)_((i=d[e]).path,e,i.uniqueIndexField,t,c,u)}(),r=0,e.offset>=0&&(r=e.offset),a=e.fetchData?this._options.pageSize:null,e.count>0&&(a=e.count),e.fetchData?this.forEachInPage(r,a,I):this.forEach(I),i=0;i<h;i++)n=d[i],s=c[i],n.sort&&s.array.sort(n.sort);return t},forEachInPage:function(e,t,n,s){var r,a,d,o,h=e,c=this,u=this._options,g=this._data;function f(r){var a=t-(r-e);i.trace("Model: "+c.modelId()+". forEachInPage fetching more data starting at: ",r),c._waitingPages.push({offset:r,callback:n,thisArg:s,next:function(){c.forEachInPage(r,a,n,s)}}),c._requestsInProgress.fetch||c.fetch(r,(function(e){e||setTimeout((function(){c._waitingPages.length>0&&c._waitingPages.shift().next()}),1)}))||(c._waitingPages.pop(),P(s,n,null,-1,null))}if(u.shape!==l)throw G("forEachInPage");if(t>u.pageSize&&(u.pageSize=10*Math.floor((t+9)/10)),"one"===u.paginationType&&(h=e-this._offset),h<0||h>=g.length)this._haveAllData?(P(s,n,null,-1,null),this._drainWaiters()):f(e);else{for(a=h+t,o=e,r=h;r<a;r++){if(void 0===(d=g[r]))return void(this._haveAllData&&r>=g.length?(P(s,n,null,-1,null),this._drainWaiters()):f(r+this._offset));d&&(P(s,n,d,o,this._getIdentity(d,r)),o+=1)}this._drainWaiters()}},indexOf:function(e){let t,i=this._options.shape;if(i===o)throw G("indexOf");if(e){if(t=this.getRecordMetadata(this._getIdentity(e)),i===d)return t&&t.parent?t.parent[this._childrenKey].indexOf(e):-1;if(t)return t.index}return this._data.indexOf(e)},recordAt:function(e){if(this._options.shape!==l)throw G("recordAt");return this._data[e]||null},getRecordId:function(e){return this._getIdentity(e)},getAggregateRecord:function(e,t){var i,n,s,r,a=null;if(t>=0){if(s=this._breakEndIds[t],(i=this.indexOf(this.getRecord(s)))>=0)for(r=!1;i<this._data.length;i++)if((n=(a=this._data[i])[this._metaKey])&&n.agg){if(r=!0,n.agg===e)break}else if(r){a=null;break}}else for(i=this._data.length-1;i>=0;i--){if(!((n=(a=this._data[i])[this._metaKey])&&n.agg&&n.grandTotal)){a=null;break}if(n.agg===e)break}return a},isIdentityField:function(e){return void 0!==this._identityKeys&&this._identityKeys.includes(this.getFieldKey(e))},getRecordMetadata:function(e){let t,i,n=this._options;return i=e||n.shape!==o||n.identityField?j(e):"0",t=this._index.get(i),t||null},metadataChanged:function(e,t=null,i=null){let n=this._index.get(j(e));n&&V(this,"metaChange",{record:n.record,recordId:e,field:t,property:i})},getTypeMetadata:function(e){return this._options.types[e]||null},getFieldMetadata:function(e){return this._options.fields[e]||null},getFieldKey:function(e){var t=this._options;if(F(t.fields,e)&&!t.fields[e].virtual)return t.recordIsArray?t.fields[e].index:e},isChanged:function(){var e,t,i;if(0===this._changes.length)return!1;for(i=0,e=0;e<this._changes.length;e++)(t=this._changes[e]).autoInserted&&!t.updated||(i+=1);return i>0},getChanges:function(){return this._changes},clearChanges:function(){this._clearChanges("_changes")},hasErrors:function(){return this._errors.length>0},getErrors:function(){return this._errors},setHiddenState:function(e,t){let i=this.getRecordMetadata(e);i&&i.hidden!==t&&(i.hidden=t,this.metadataChanged(e,null,"hidden"))},updateVisibility:function(e=null){const t=this._options,i=t.visibilityFilter;if(i){null!==e&&(t.visibilityFilterContext=e);let n=this,s=t.visibilityFilterContext;if(null===s)return;if(t.shape===d){let e=[];n.walkTree(n.root(),{node:function(t){if(!1===n.hasChildren(t)){let r=i(n,t,s);n.setHiddenState(n.getRecordId(t),!r),r&&(e[e.length-1]=r)}},beginChildren:function(){e.push(null)},endChildren:function(t){let r=!1,a=e.pop();0===e.length&&(r=!0,a=!0),null===a&&(a=i(n,t,s)),n.setHiddenState(n.getRecordId(t),!a),a&&!r&&(e[e.length-1]=a)}},null)}else t.shape===l&&n.forEach((function(e,t,r){let a=i(n,e,s);n.setHiddenState(r,!a)}))}},setDisabledState:function(e,t){let i=this.getRecordMetadata(e);i&&i.disabled!==t&&(i.disabled=t,this.metadataChanged(e,null,"disabled"))},setSelectionState:function(e,t,i="set"){let n,s,r;const a=(e,t)=>{let i=!1;for(let a=e;a<t;a++)r=this._data[a],r?(n=this._getIdentity(r,a),s=this._index.get(n),s&&!s.agg&&(s.sel=!0,this._selection.set(n,s))):i=!0;return i};if("all"===i)a(0,this._data.length),this._selectAll=!0;else if(n=j(e),s=this._index.get(n),s){if(t=!!t,this._selectAll&&["set","range"].includes(i)&&this.clearSelection(),"range"===i){let e,t,i,n=s.index;s=this._index.get(this._selectAnchor),s&&(t=s.index,n>t&&(e=n,n=t,t=e),i=a(n,t+1),i&&(this._selectRange=[n,t]))}else s.sel!==t&&(s.sel=t,t?(this._selection.set(n,s),this._selectAllExcept.delete(n)):(this._selection.delete(n),this._selectAll&&this._selectAllExcept.add(n))),this._selectAnchor=n,"toggle"!==i&&(this._selectRange=null);if(!this._selectAll){let e=this._totalRecords>=0?this.getServerTotalRecords():this.getTotalRecords(!0)-this._numAggregateRecords;this.getSelectedCount()===e&&(this._selectAll=!0)}}},clearSelection:function(){for(const e of this._selection.values())e.sel=!1;this._selection.clear(),this._selectAll=!1,this._selectRange=null,this._selectAllExcept.clear()},getSelectedCount:function(){let e=this._selection.size;if(this._selectAll)e=this._totalRecords>=0?this.getServerTotalRecords():this.getTotalRecords(!0)-this._numAggregateRecords,e-=this._selectAllExcept.size;else if(this._selectRange){let t=0,i=this._selectRange[0],n=this._selectRange[1]+1;for(let e=i;e<n;e++)this._data[e]||(t+=1);e+=t}return e},getSelectedRecords:function(){return[...this._selection.values()].sort(((e,t)=>e.index-t.index)).map((e=>e.record))},getSelectionState:function(){return{selectAll:this._selectAll,records:this.getSelectedRecords(),except:[...this._selectAllExcept],count:this.getSelectedCount(),rangeAnchor:this._selectAnchor}},allowEdit:function(e){return this.check("canEdit",e)},allowDelete:function(e){var t=this._options;return t.shape!==o&&(t.shape!==d||e!==this._data)&&this.check("canDelete",e)},allowAdd:function(e,t,i){var n,s,r,a,l=this._options;if(l.shape===o)return!1;if(!(l.shape!==d||e&&e[this._childrenKey]))return!1;if((r=this.check("canAdd",e,t,i))&&i&&l.shape===d&&!0!==(s=void 0!==(a=this._getType(e)).validChildren?a.validChildren:void 0===l.types.default.validChildren||l.types.default.validChildren))for(n=0;n<i.length;n++)if(!s.includes(i[n][this._typeKey])){r=!1;break}return r},allowDrag:function(e){return this._options.shape!==o&&this.check("canDrag",e)},dragOperations:function(e){let t,i,n=this._options;if(e){if(e.length>0&&this._typeKey){i=e[0][this._typeKey]||"default";for(let t=1;t<e.length;t++)if((e[t][this._typeKey]||"default")!==i){i="default";break}}else i="default";t=n.types[i].operations&&void 0!==n.types[i].operations.drag?n.types[i].operations.drag:n.types.default.operations.drag}else t=n.types.default.operations.externalDrag;return t},check:function(e,t,i,n){var s,r=!1,a=this._options,l=this._getType(t);if(!a.editable||this._masterRecordIsDeleted)return!1;if(t&&(s=this.getRecordMetadata(this._getIdentity(t)))){if(s.deleted||s.agg)return!1;if(s.inserted&&("canEdit"===e||"canDelete"===e))return!0}return s&&void 0!==s[e]?r=s[e]:l.operations&&void 0!==l.operations[e]?r=l.operations[e]:void 0!==a.types.default.operations[e]&&(r=a.types.default.operations[e]),D(r)&&(r=r.call(this,t,i,n)),D(a.check)&&(r=a.check(r,e,t,i,n)),r},isDisabled:function(e,t){let i=this._getType(e),n=this._options,s=!1;if(t){if(t.record!==e)throw new Error("Record metadata doesn't match record")}else t=this.getRecordMetadata(this.getRecordId(e));return null!=t.disabled?s=t.disabled:void 0!==i.isDisabled?s=i.isDisabled:void 0!==n.types.default.isDisabled&&(s=n.types.default.isDisabled),s},getValue:function(e,t){return void 0===t&&(t=e,e=this._data),e[this.getFieldKey(t)]},setValue:function(e,t,i,n){var s,r,a,l,o,h,c,u,g,f,_,p,I,v=this._options,m=!1;if(void 0===i&&(i=t,t=e,e=this._data),a=this.getFieldKey(t),!this.allowEdit(e))throw new Error("Set value not allowed for record");if(c=this._getIdentity(e),!(l=this.getRecordMetadata(c)))return null;if(I=v.fields[t],void 0===a||I.readonly&&!I.parentField||l.fields&&l.fields[t]&&l.fields[t].ck)throw new Error("Set value not allowed for field");if(!Q(r=e[a],i)){if(!n&&(t===v.sequenceField||t===v.parentIdentityField))if(u=g=f=null,t===v.sequenceField){if(v.shape===d?(g=this.parent())&&(u=g[this._childrenKey]):u=this._data,u){let t=parseFloat(i);for(s=0;s<u.length&&!(parseFloat(u[s][this._sequenceKey])>t);s++)f=u[s];f===e&&(f=null)}}else t===v.parentIdentityField&&(g=this.getRecord(i));if(l.original||(l.original=function(e){let t,i;if(M(e))for(i=[],t=0;t<e.length;t++)i[t]=q(e[t]);else for(t in i={},e)F(e,t)&&(i[t]=q(e[t]));return i}(e),m=!0),e[a]=i,(h=this._getIdentity(e))!==c){if(this._index.has(h))return e[a]=r,m&&delete l.original,"DUP";l.originalId||(l.originalId=c),this._index.delete(c),this._index.set(h,l),l.sel&&(this._selection.delete(c),this._selection.set(h,l))}return l.updated||l.deleted||l.inserted||this._addChange(l),l.updated=!0,l.fields||(l.fields={}),(o=l.fields[t])||(o={},l.fields[t]=o),o.changed=!0,(l.error||l.warning)&&this.setValidity("valid",h),V(this,y,{oldValue:r,oldIdentity:h!==c?c:null,recordId:h,record:e,field:t}),this._checkAggregates(t),(_=this._dependentFields[t])&&(I.calcValue&&((p={})[t]=1),ee(this,l,_,!0,p)),(g||f)&&this.moveRecords([e],g,f),"SET"}return"NC"},getRecordValue:function(e,t){return this.getValue(this.getRecord(e),t)},setRecordValue:function(e,t,i){this.setValue(this.getRecord(e),t,i)},setValidity:function(e,t,i,n){let s,r,a,l,d,o,h,c=this._index.get(j(t));if(c&&(i?(c.fields||(c.fields={}),r=c.fields[i],r||(r={},c.fields[i]=r)):r=c,d="valid",o=r.message||n,r.warning&&(d="warning"),r.error&&(d="error"),e!==d||o!==n)){switch(h="message",e){case"error":s="error",delete r.warning;break;case"warning":s="warning",delete r.error;break;case"valid":delete r.error,delete r.warning,delete r.message;break;default:throw new Error("Invalid value for pValidity parameter: "+e)}if(e!==d&&("valid"!==d&&(h+=","+d),s&&(h+=","+s)),s&&(r[s]=!0,r.message=n),a=c.error,!a&&c.fields)for(let e in c.fields)if(F(c.fields,e)&&c.fields[e].error){a=!0;break}a?(l=this._errors.indexOf(c),l>=0&&this._errors.splice(l,1),this._errors.push(c)):this._removeError(c),this.metadataChanged(t,i,h)}},deleteRecords:function(e){var t,n,s,r,a=[],d=[],h=this._options;if(h.shape===o)throw G("deleteRecords");for(t=0;t<e.length;t++)r=e[t],s=this._getIdentity(r),(n=this.getRecordMetadata(s))?this.allowDelete(r)?(h.shape===l&&(this._numDeletedRecords+=1),h.onlyMarkForDelete&&!n.inserted||(h.shape===l&&n.inserted&&(this._numDeletedRecords-=1,this._numInsertedRecords-=1),this._removeRecord(s,n)),n.inserted?(delete n.inserted,delete n.autoInserted,delete n.updated,this._removeError(n),this._removeChange(n)):($(n,!0),this._removeError(n),n.deleted=!0,this._addChange(n)),a.push(r),d.push(s)):i.warn("Delete not allowed for record: "+s):i.warn("Record to delete not found: "+s);return a.length>0&&(V(this,_,{records:a,recordIds:d}),this._checkAggregates()),a.length},canRevertRecord:function(e){var t;return!(!(t=this.getRecordMetadata(this._getIdentity(e)))||!t.original&&!t.deleted)},revertRecords:function(e){var t,n,s,r,a,o,h={},c=[],u=[],f=this._options;for(t=0;t<e.length;t++)s=e[t],r=this._getIdentity(s),(n=this.getRecordMetadata(r))?n.original||n.deleted?(f.shape===l?a=this._data:f.shape===d&&(a=this.parent(n.record)[this._childrenKey]),o=a.indexOf(n.record),n.deleted?(f.shape===l&&(this._numDeletedRecords-=1),delete n.deleted):(n.originalId&&(this._index.set(n.originalId,n),this._index.delete(r),n.sel&&(this._selection.set(n.originalId,n),this._selection.delete(r)),h[r]=n.originalId,delete n.originalId),n.original&&(n.record=n.original,delete n.original),delete n.updated,$(n),this._removeError(n)),this._removeChange(n),s=n.record,a[o]!==s&&(a[o]=s),c.push(s),u.push(r)):i.warn("Nothing to revert for record "+r):i.warn("Record to revert not found: "+r);return c.length>0&&(V(this,g,{records:c,recordIds:u,newIds:h}),this._checkAggregates()),c.length},insertNewRecord:function(e,t,i){let n,s,r,a,l,h,c=this._options,u=null;if(c.shape===o)throw G("insertNewRecord");if(a=this._initRecord(i,null,e),!this.allowAdd(e,"new",[a]))throw new Error("Insert not allowed for new record");if(c.shape===d?(h=e||this._data,l=h[this._childrenKey]):l=this._data,s=0,t&&(u=this._getIdentity(t),n=this.getRecordMetadata(u),n&&(s=l.indexOf(n.record)+1)),this._sequenceKey){let e=parseFloat(a[this._sequenceKey])||null,[t,i]=W(l,s,this._sequenceKey);a[this._sequenceKey]=""+H(c.sequenceStep,t,i,1,1,e)}return l.splice(s,0,a),c.shape!==d&&this._reindex(s+1),r=this._getIdentity(a),n={record:a,inserted:!0,index:s},this._index.set(r,n),this._addChange(n),c.shape===d?n.parent=h:this._numInsertedRecords+=1,te(this,n),V(this,"insert",{record:a,recordId:r,insertAfterId:u}),r},moveRecords:function(e,t,n){let s,r,a,l,h,c,u,g,f,_,p,y=this._options,I=[],v=[],m=null;if(y.shape===o)throw G("moveRecords");y.shape===d?(t||(t=this._data),a=t[this._childrenKey]):a=this._data,r=0,n&&(m=this._getIdentity(n),s=this.getRecordMetadata(m),s&&(r=a.indexOf(s.record)+1),(!s||r<0)&&(i.warn("AfterRecord not found, move to beginning."),r=0)),this._sequenceKey&&([g,f]=W(a,r,this._sequenceKey)),p=0,_=this._data.length;for(let n=0;n<e.length;n++)if(c=e[n],u=this._getIdentity(c),s=this.getRecordMetadata(u),s){if(y.shape===d){if(l=this.parent(c),!l){i.warn("Move not allowed for root");continue}l=l[this._childrenKey]}else l=a;if(h=l.indexOf(c),y.shape!==d&&(h>p&&(p=h),h<_&&(_=h)),l.splice(h,1),a===l&&h<r&&(r-=1),v.push(c),I.push(u),a.splice(r,0,c),y.shape!==d&&(r>p&&(p=r),r<_&&(_=r)),r+=1,this._sequenceKey){let t=parseFloat(c[this._sequenceKey])||null;this.setValue(c,y.sequenceField,""+H(y.sequenceStep,g,f,e.length,n+1,t),!0)}y.shape===d&&(s.parent=t,this._parentIdKey&&this.setValue(c,y.parentIdentityField,this._getIdentity(t),!0))}else i.warn("Record to move not found: "+u);return y.shape!==d&&this._reindex(_,p+1),V(this,"move",{records:v,recordIds:I,insertAfterId:m}),I},copyRecords:function(e,t,n){let s,r,a,l,h,c,u,g,f,_,p=this,y=this._options,I=[],v=[],m=null;if(y.shape===o)throw G("copyRecords");y.shape===d?(g={node:function(e,t){var i,n;t&&(i=p._getIdentity(e),n={record:e,inserted:!0,parent:t},p._index.set(i,n),p._addChange(n))}},t||(t=this._data),c=t[this._childrenKey]):c=this._data,r=0,n&&(m=this._getIdentity(n),s=this.getRecordMetadata(m),s&&(r=c.indexOf(s.record)+1),(!s||r<0)&&(i.warn("AfterRecord not found, copy to beginning."),r=0)),this._sequenceKey&&([f,_]=W(c,r,this._sequenceKey));for(let n=0;n<e.length;n++)a=e[n],h=this._getIdentity(a),s=this.getRecordMetadata(h),s?(l=this._initRecord(null,e[n],t),c.splice(r,0,l),this._sequenceKey&&(l[this._sequenceKey]=""+H(y.sequenceStep,f,_,e.length,n+1)),u=this._getIdentity(l),v.push(l),I.push(u),s={record:l,inserted:!0,index:r},this._index.set(u,s),this._addChange(s),y.shape===d?(s.parent=t,this.walkTree(l,g,null)):this._numInsertedRecords+=1,r+=1):i.warn("Record to copy not found: "+h);return this._reindex(r),V(this,"copy",{records:v,recordIds:I,insertAfterId:m}),this._checkAggregates(),I},root:function(){if(this._options.shape!==d)throw G("root");return this._data},child:function(e,t){var i=e[this._childrenKey];if(i)return i[t]},parent:function(e){if(this._identityKeys){let t=this._getIdentity(e),i=this.getRecordMetadata(t);if(i&&F(i,"parent"))return i.parent?i.parent:null}},childCount:function(e){const t=e[this._childrenKey];return null===t?null:t?t.length:0},hasChildren:function(e){const t=e[this._childrenKey];return null===t?null:!!t&&t.length>0},fetchChildNodes:function(e,t){let i,n,s,r,a,l=this._options,d=K();return a=b({},l.regionData,{id:l.regionId,ajaxIdentifier:l.ajaxIdentifier,fetchData:b({},l.fetchData,{version:l.version,parentId:e?this._getPrimaryKey(e):null})}),s={regions:[a]},l.pageItemsToSubmit&&(s.pageItems=l.pageItemsToSubmit),this._addParentItems(s.regions[0]),r=z(l,this),e&&delete r.loadingIndicator,i=this._callServer(s,r),i.done((t=>{if(this._destroyed)return;let i,n=t.regions[0].fetchedData;if(e){let t=n[this._childrenKey];this._addData(e,null,t),i=t.length}else this._addData(null,null,n.root),i=1;d.resolve(i)})).fail((function(e,t,i){d.reject(B("Error fetching child nodes.",e,0,i))})),n=d.promise(),t&&n.always(t),n},clearChildNodes:function(e){e[this._childrenKey]=null},walkTree:function(e,t,i){let n,s,r,a;if(e&&(void 0===i&&(i=null,n=this._getIdentity(e),n&&(s=this.getRecordMetadata(n),s&&(i=s))),a=t.node(e,i),!a&&(r=e[this._childrenKey],r&&r.length>0))){t.beginChildren&&t.beginChildren(e);for(let i=0;i<r.length;i++)this.walkTree(r[i],t,e);t.endChildren&&t.endChildren(e)}},subscribe:function(e){var t=e.viewId;return t||(t="v::"+R,R+=1,e.viewId=t),this._listeners.push(e),t},unSubscribe:function(e){var t;for(t=0;t<this._listeners.length;t++)this._listeners[t].viewId===e&&this._listeners.splice(t,1)},getOption:function(e){var t=this._options[e];if(void 0===t)throw new Error("No such option: "+e);return t},setOption:function(e,t){if(x.has(e)){if("editable"===e&&!this._options.identityField)throw X();this._options[e]=t}else i.warn("Option cannot be set: "+e)},_callServer:function(e,i){return(this._options.callServer||t.plugin)(e,i)},_drainWaiters:function(e){for(let t=0;t<this._waitingPages.length;t++){let i=this._waitingPages[t];if((this._haveAllData||this._data[i.offset]||e)&&(this._waitingPages.splice(t,1),t-=1,e&&0!==e.status?P(i.thisArg,i.callback,null,-1,null,e):i.next(),this._requestsInProgress.fetch))return}},_getServerOffset:function(e){var t,i,n,s=e-1;for(n=this._data[s];n;){if(t=this._getIdentity(n,s),(i=this.getRecordMetadata(t))&&i.serverOffset>=0)return i.serverOffset+1;s-=1,n=this._data[s]}return e},_clear:function(){let e=this._options;(this._requestsInProgress.fetch||this._requestsInProgress.save)&&i.error("Model cleared during ajax request"),e.shape===l?(this._data=[],e.hasTotalRecords?this._totalRecords=0:this._totalRecords=-1,this._haveAllData=!1,this._offset=0,this._numInsertedRecords=0,this._numDeletedRecords=0,this._numAggregateRecords=0,this._masterRecordIsInserted&&(this._haveAllData=!0),this.dataOverflow=!1):this._data=null,this._changes=[],this._errors=[],this._index.clear(),this._breakEndIds=[],this._selection.clear(),this._selectAll=!1,this._selectRange=null,this._selectAnchor=null,this._selectAllExcept.clear()},_saveDataState:function(){this._saveState={_data:this._data,_totalRecords:this._totalRecords,_haveAllData:this._haveAllData,_offset:this._offset,_numInsertedRecords:this._numInsertedRecords,_numDeletedRecords:this._numDeletedRecords,_numAggregateRecords:this._numAggregateRecords,dataOverflow:this.dataOverflow,_changes:this._changes,_errors:this._errors,_index:this._index,_breakEndIds:this._breakEndIds,_selection:this._selection,_selectAll:this._selectAll,_selectRange:this._selectRange,_selectAllExcept:this._selectAllExcept},this._index=new Map,this._selection=new Map,this._selectAllExcept=new Set},_restoreDataState:function(){var e=this._saveState;this._data=e._data,this._totalRecords=e._totalRecords,this._haveAllData=e._haveAllData,this._offset=e._offset,this._numInsertedRecords=e._numInsertedRecords,this._numDeletedRecords=e._numDeletedRecords,this._numAggregateRecords=e._numAggregateRecords,this.dataOverflow=e.dataOverflow,this._changes=e._changes,this._errors=e._errors,this._index=e._index,this._breakEndIds=e._breakEndIds,this._selection=e._selection,this._selectAll=e._selectAll,this._selectRange=e._selectRange,this._selectAllExcept=e._selectAllExcept},_clearChanges:function(e){var t,i,n,s=[],r=[],a=this._options,l=this[e];for(t=0;t<l.length;t++)i=l[t],n=this._getIdentity(i.record),i.deleted&&a.onlyMarkForDelete&&this._removeRecord(n,i),i.deleted?s.push(n):(i.inserted||i.updated)&&r.push(n),delete i.deleted,delete i.recordId,delete i.inserted,delete i.autoInserted,delete i.updated,delete i.original;this[e]=[],V(this,p,{deletedIds:s,changedIds:r})},_reindex:function(e,t){let i,n=this._data.length;for(null!=t&&t<n&&(n=t),i=e;i<n;i++){let e=this._getIdentity(this._data[i]);this.getRecordMetadata(e).index=i}},_addData:function(e,t,n,s,r,a){var h,c,g,f,_,p,y,I,v,m,R,w,x,F,M=this._options,A=this,D=this._calculatedFields.length>0;function K(e,t,i,n){var s={record:n};A._metaKey&&(b(s,n[A._metaKey]),s.sel="Y"===s.sel,s.agg&&(!e||A._identityKeys&&!n[A._identityKeys[0]])&&(A._assignTempIdentity(n),e=A._getIdentity(n)),N(s)),null!=t&&(s.serverOffset=t),null!=i&&(s.index=i),s.agg&&(A._numAggregateRecords+=1),A._index.set(e,s),(s.sel||A._selectAll||A._selectRange&&i>A._selectRange[0]&&i<=A._selectRange[1])&&(s.sel=!0,A._selection.set(e,s)),M.visibilityFilter&&M.visibilityFilterContext&&(s.hidden=!M.visibilityFilter(A,n,M.visibilityFilterContext)),Z(n,M.fields,M.recordIsArray),D&&!s.agg&&te(A,s)}function S(e,t,i){var n,s,r,a,l,d,o;for(r=0,n=0;n<A._aggregateRecs.length;n++)t[s=A._aggregateRecs[n]]||(l=A._initRecord(!1),o=A._getIdentity(l),d={agg:s},i&&(d.grandTotal=i),l[A._metaKey]=d,a=e+r,A._data[a]?A._data.splice(a,0,l):A._data[a]=l,K(o,null,a,l),r+=1);return r}function C(){if(A._data.length>0&&A._haveAllData&&A._aggregateRecs.length>0){if(x){if(p&&p.grandTotal){for(h=A._data.length-1;h>=0&&(g=A._data[h],(p=A._metaKey&&g[A._metaKey])&&p.agg&&p.grandTotal);h--);h+=1}h+=S(h,F),A._reindex(h)}(h=S(A._data.length,F,!0))>0&&A._checkAggregates()}}if(M.shape===l?((0===e&&!this.isChanged()||"none"===M.paginationType)&&this._clear(),"one"===M.paginationType&&(this._offset=e),this._totalRecords=-1,null!=s?this._totalRecords=s:M.hasTotalRecords&&i.warn("Model missing total records"),this._haveAllData||r||(this._haveAllData=!0),a&&(this.dataOverflow=!0)):M.shape===o&&this._clear(),M.shape===d&&e)(I=e)[this._childrenKey]=n,M.identityField&&A.walkTree(I,{node:function(e,t){var i;t&&(K(i=A._getIdentity(e),null,null,e),A.getRecordMetadata(i).parent=t)}},null),V(this,u,{parentNode:I,offset:0,count:n.length});else if(null===this._data||0===this._data.length||M.shape!==l||"one"===M.paginationType){if(i.trace("Model: "+this.modelId()+". add data set: ",e,s,r),this._data=n,this._numInsertedRecords=0,this._numDeletedRecords=0,this._numAggregateRecords=0,M.shape!==o)if(R={offset:0,count:n.length},v=t,M.shape===d&&this.root()&&M.identityField)this.walkTree(this.root(),{node:function(e,t){f=A._getIdentity(e),A._metaKey&&e[A._metaKey].agg?m=null:(m=v,v+=1),K(f,m,null,e),A.getRecordMetadata(f).parent=t}},null),R.parentNode=null,R.count=1;else{for(x=!1,F={},h=0;h<this._data.length;h++)g=this._data[h],f=this._getIdentity(g,h),(p=this._metaKey&&g[this._metaKey])&&p.agg?(m=null,F[p.agg]=1):(m=v,v+=1,x&&(h+=S(h,F)),x=!1),p&&p.endControlBreak&&(this._breakEndIds.push(f),this._aggregateRecs.length>0&&(x=!0,F={})),K(f,m,h,g);C()}else this._data?(R={offset:0,count:1},K(this._getIdentity(this._data),null,null,this._data)):R={offset:0,count:0};V(this,u,R)}else{for(i.trace("Model: "+this.modelId()+". add data merge: ",e,s,r),c=e,v=t,w=[],x=!1,F={},h=0;h<n.length;h++){if(g=n[h],f=this._getIdentity(g,c),(p=this._metaKey&&g[this._metaKey])&&p.agg?(m=null,F[p.agg]=1):(m=v,v+=1),y=this.getRecordMetadata(f)){if(y.updated||y.inserted||y.deleted)continue;_=this._data.indexOf(y.record),this._data[_]=g,Z(g,M.fields,M.recordIsArray),y.record=g,y.serverOffset=m,p&&b(y,p),w.push(f),D&&!y.agg&&te(this,y)}else this._data[c]?this._data.splice(c,0,g):this._data[c]=g,K(f,m,c,g),c+=1;p&&(p.agg||(x&&(c+=S(c,F)),x=!1),p.endControlBreak&&(this._breakEndIds.push(f),this._aggregateRecs.length>0&&(x=!0,F={})))}C(),R={offset:e,count:c-e},w.length&&(R.replacedIds=w),V(this,u,R)}},_updateData:function(e,t){var i,n,s,r,a,l,d=this._options,o=!1,h=[],c=[],u=[],g=[],p={},y=t||this._metaKey;for(i=0;i<e.length;i++)r=(l=(n=e[i])[y])?l.recordId:null,l&&r&&l.notFound?(a=this.getRecordMetadata(r),this._removeRecord(r,a),u.push(a.record),g.push(r)):(r===(s=this._getIdentity(n))&&(r=null),(a=this.getRecordMetadata(r||s))&&(r&&(p[r]=s,this._index.set(s,a),this._index.delete(r),this._selection.delete(r),a.sel&&this._selection.set(s,a)),h.push(n),c.push(r||s),this._data[this._data.indexOf(a.record)]=n,Z(n,d.fields,d.recordIsArray),a.record=n,y&&l?(b(!0,a,l),a.highlight&&void 0===l.highlight&&delete a.highlight,N(a),delete a.recordId):t&&(d.recordIsArray?n.splice(t,1):delete n[t]),d.visibilityFilter&&d.visibilityFilterContext&&(a.hidden=!d.visibilityFilter(this,n,d.visibilityFilterContext)),te(this,a),delete a.deleted,delete a.inserted,delete a.autoInserted,delete a.updated,delete a.original,$(a),this._removeError(a),this._removeChange(a)));h.length>0&&(V(this,f,{records:h,recordIds:c,newIds:p}),o=!0),u.length>0&&(V(this,_,{records:u,recordIds:g}),o=!0),o&&this._checkAggregates()},_initRecord:function(t,i,n){var s,r,a,l,o,h,c,u,g,f,_=!0,p=this._options;if(t)h=t;else for(s in!1===t&&(_=!1),h=p.recordIsArray?[]:{},p.fields)if(F(p.fields,s)&&(r=p.fields[s],a=p.recordIsArray?r.index:s,!r.virtual))if(!i||r.noCopy){if(r.parentField&&p.parentModel&&(c||(c=e.get(p.parentModel))&&!u&&p.parentRecordId&&(u=c.getRecord(p.parentRecordId)),u)){h[a]=c.getValue(u,r.parentField);continue}g="",_&&void 0!==(f=r.defaultValue)&&(g="function"==typeof f?f(this,i):f),h[a]=g}else h[a]=i[a];if(c&&e.release(p.parentModel),this._identityKeys&&this._assignTempIdentity(h),this._metaKey&&(h[this._metaKey]={}),p.shape===d&&(this._parentIdKey&&(h[this._parentIdKey]=this._getIdentity(n)),o=[],h[this._childrenKey]=o,i&&(l=i[this._childrenKey])))for(s=0;s<l.length;s++)o.push(this._initRecord(null,l[s],h));return h},_assignTempIdentity:function(e){for(let t=0;t<this._identityKeys.length;t++)e[this._identityKeys[t]]=this._options.genIdPrefix+O(this.name)},_getIdentity:function(e,t){let i=null;if(void 0!==this._identityKeys)if(1===this._identityKeys.length)i=e[this._identityKeys[0]]+"";else{i=[];for(let t=0;t<this._identityKeys.length;t++)i.push(e[this._identityKeys[t]]+"")}else null!=t?i=t+"":this._options.shape===o&&(i="0");return null!==i?j(i):i},_getPrimaryKey:function(e){var t,i;if(void 0!==this._identityKeys)for(i=[],t=0;t<this._identityKeys.length;t++)i.push(e[this._identityKeys[t]]+"");return i},_getType:function(e){let t="default",i=this._options;return e&&void 0!==this._typeKey&&(t=e[this._typeKey],null!==t&&T(t)&&(t=t.v),t||(t="default")),i.types[t]||i.types.default},_getRecordById:function(e){let t=this._index.get(j(e));return t?t.record:null},_removeRecord:function(e,t){var i,n,s,r=this._options;r.shape===l?i=this._data:r.shape===d&&(i=t.parent[this._childrenKey],delete t.parent),s=i.indexOf(t.record),i.splice(s,1),this._reindex(s),n=j(e),this._index.delete(n),t.sel&&this._selection.delete(n)},_addChange:function(e){var t=this._changes.indexOf(e);t>=0&&this._changes.splice(t,1),this._changes.push(e)},_removeChange:function(e){var t=this._changes.indexOf(e);t>=0&&!e.deleted&&!e.updated&&!e.inserted&&this._changes.splice(t,1)},_removeError:function(e){var t=this._errors.indexOf(e);t>=0&&this._errors.splice(t,1)},_addParentItems:function(t){var i,n,s,r,a,l,d={values:[]},o=this._options;if(o.parentModel&&o.parentRecordId){for(i in o.fields)F(o.fields,i)&&(n=o.fields[i]).parentField&&(s||(s=e.get(o.parentModel))&&!r&&(r=s.getRecord(o.parentRecordId),l=s.getRecordMetadata(o.parentRecordId)),r&&(a={n:n.parentField,v:s.getValue(r,n.parentField)},d.values.push(a)));l&&(l.salt&&(d.salt=l.salt),l.protected&&(d.protected=l.protected)),s&&e.release(o.parentModel),t.parentRecordId=o.parentRecordId,d.values.length>0&&(t.parentItems=d)}},_updateAggregates:function(){var e,t,i,n,s,a,l=this._options.fields,d=[];if(!(this._staleAggFields.length<=0)){for(e=0;e<this._staleAggFields.length;e++)for(i=l[n=this._staleAggFields[e]],t=0;t<i.aggregates.length;t++)"string"==typeof(s=i.aggregates[t])&&(s=ie[s]),(a={name:s.name,fieldName:n,key:this.getFieldKey(this._staleAggFields[e]),state:{dataType:i.dataType,formatMask:i.formatMask},agg:s}).agg.init(a.state),d.push(a);this.forEach((function(e,t,i){var n,s,l,o=this.getRecordMetadata(i);for(n=0;n<d.length;n++)if(a=d[n],o.agg){if(o.agg===a.name){let t=a.state.dataType,n=a.state.formatMask;l=e[a.key],s=a.agg.get(a.state,!o.grandTotal)+"",s="NUMBER"===t&&n?r.formatNumber(s,n):""+s,e[a.key]=s,V(this,y,{oldValue:l,oldIdentity:null,recordId:i,record:e,field:a.fieldName})}}else o.deleted||(s=e[a.key],a.agg.add(a.state,s))}),this),this._staleAggFields=[]}},_checkAggregates:function(e){var t;if(e)this._aggregatedFields[e]&&this._staleAggFields.indexOf(e)<0&&(this._staleAggFields.push(e),this._debouncedUpdateAggregates());else for(t in this._aggregatedFields)F(this._aggregatedFields,t)&&this._checkAggregates(t)},_recalculate:function(e){this.forEach((function(t,i,n){var s=this.getRecordMetadata(n);s.agg||ee(this,s,e,!0)}),this)}},se={shape:l,recordIsArray:!1,hasTotalRecords:!1,genIdPrefix:"t",regionId:null,ajaxIdentifier:null,pageItemsToSubmit:null,regionData:{},fetchData:{},saveData:{},requestOptions:{},version:1,parentModel:null,parentRecordId:null,editable:!1,onlyMarkForDelete:!0,identityField:null,typeField:null,childrenField:null,parentIdentityField:null,sequenceField:null,metaField:null,sequenceStep:10,saveSelection:!1,types:{default:{isDisabled:!1,validChildren:!0,operations:{canAdd:!0,canEdit:!0,canDelete:!0,canDrag:!0,drag:{normal:"move",ctrl:"copy"},externalDrag:{normal:"add"}}}},check:null,sortCompare:null,callServer:null,paginationType:"none",pageSize:100,preFetch:!1,visibilityFilterContext:null,visibilityFilter:null},re=new Set([l,d,o]),ae=new Set(["none","one","progressive"]);function le(e){var t,i=E(e);return(t=v[i[0]])&&(t=i[1]?t.instances[i[1]]:t.model),t}function de(e,t,i,n){let s=n?E(n):null,r=[];function a(n){let r=!(!i&&!n._options.regionId);return r&&("change"===e?r=n.isChanged():"error"===e&&(r=n.hasErrors()),r&&t&&(r=function(e){let t,i=e,n=E(i.modelId());for(;n;){if(n[0]===s[0]&&(n[1]===s[1]||null===s[1]))return!0;n=null,t=i.getOption("parentModel"),t&&(i=le(t),i&&(n=E(t)))}return!1}(n))),r}function l(e,t){r.push({id:e,model:t})}function d(e,t){e.model&&a(e.model)&&l(t,e.model);for(let i in e.instances)F(e.instances,i)&&a(e.instances[i])&&l([t,i],e.instances[i])}if(s||(t=!1),!t&&s&&s[0]){let e=s[0],t=v[e];t&&(s[1]?t.instances[s[1]]&&a(t.instances[s[1]])&&l([e,s[1]],t.instances[s[1]]):d(t,e))}else for(let e in v)if(F(v,e)){d(v[e],e)}return r}function oe(e){let t=m.indexOf(e);t>=0&&m.splice(t,1)}e.create=function(t,r,h,u,R,x){const A=E(t),D=Object.create(ne);let K,S,C,T,k,O,q,P,N,j,U;function z(e,t){const n=K.fields[e];(n.calcValue||n.dependsOn||n.aggregates&&n.aggregates.length>0)&&(i.warn("Model "+t+" field does not support calculations"),delete n.calcValue,delete n.dependsOn)}if(D.name=A[0],D.instance=A[1],D._requestsInProgress={},D._listeners=[],D._waitingPages=[],S=r.fields,D._options=b(!0,{},se,r),D._options.fields=S,K=D._options,!K.fields)throw new Error("The fields option is required");if(!re.has(K.shape))throw new Error("Invalid shape option: "+K.shape);if(!ae.has(K.paginationType))throw new Error("Invalid paginationType option: "+K.paginationType);if(K.editable&&!K.identityField)throw X();if(K.shape===d&&!K.childrenField)throw new Error("A tree shaped model requires a childrenField");if(K.shape===l&&"none"===K.paginationType&&void 0===r.hasTotalRecords&&(K.hasTotalRecords=!0),D._dependentFields={},D._calculatedFields=[],D._aggregatedFields={},D._aggregateRecs=[],function(e,t,i,r,l){let d,o,h,c,u,g,f,_=[],p={};const y=function(e){const t=e.target.id;D._recalculate(D._dependentFields[":"+t])};for(o in e)if(F(e,o)){if(h=e[o],h.calcValue&&i.push(o),c=h.dependsOn,c)for(let i=0;i<c.length;i++){if(g=c[i],":"===g.substr(0,1)){if(f=g.substr(1),!s(f).node)throw Y(o,f);_.push(f)}else if(!e[g])throw Y(o,g);I=o,t[v=g]||(t[v]=[]),t[v].push(I)}if(h.aggregates){for(let e=0;e<h.aggregates.length;e++){if(d=h.aggregates[e],"string"==typeof d&&!ie[d]||"object"==typeof d&&!(d.name&&d.init&&d.add&&d.get))throw new Error(`Field '${o}' has invalid aggregate`);u=d.name||d,p[u]||l.push(u),p[u]=1}r[o]=1}}var I,v;_.length>0&&(D._externalItems$=a(_.map((e=>"#"+n.escapeCSS(e))).join(",")),D._externalItems$.on("change",y),D._externalItemsHandler=y)}(K.fields,D._dependentFields,D._calculatedFields,D._aggregatedFields,D._aggregateRecs),D._staleAggFields=[],D._debouncedUpdateAggregates=n.debounce((function(){D._updateAggregates()}),250),K.identityField)if(M(K.identityField)){D._identityKeys=[];for(let e=0;e<K.identityField.length;e++)D._identityKeys.push(D.getFieldKey(K.identityField[e])),z(K.identityField[e],"identity")}else D._identityKeys=[D.getFieldKey(K.identityField)],z(K.identityField,"identity");if(K.typeField){if(D._typeKey=D.getFieldKey(K.typeField),void 0===D._typeKey)throw J("Type",K.typeField);z(K.typeField,"type")}if(K.childrenField){if(D._childrenKey=D.getFieldKey(K.childrenField),void 0===D._childrenKey)throw J("Children",K.childrenField);z(K.childrenField,"children")}if(K.parentIdentityField){if(D._parentIdKey=D.getFieldKey(K.parentIdentityField),void 0===D._parentIdKey)throw J("Parent identity",K.parentIdentityField);z(K.parentIdentityField,"parentIdentity")}if(K.sequenceField){if(D._sequenceKey=D.getFieldKey(K.sequenceField),void 0===D._sequenceKey)throw J("Sequence",K.sequenceField);z(K.sequenceField,"sequence")}if(K.metaField){if(D._metaKey=D.getFieldKey(K.metaField),void 0===D._metaKey)throw J("Meta",K.metaField);z(K.metaField,"meta")}if(K.shape!==o?K.identityField?D.getRecord=D._getRecordById:D.getRecord=D.recordAt:D.getRecord=function(){return D._data},D._index=new Map,D._selection=new Map,D._selectAllExcept=new Set,D._clear(),h?(P="none"!==K.paginationType&&(null!=R?R:null==u||h.length<u),D._addData(0,0,h,u,P,x)):null!=u&&(D._totalRecords=u),K.parentModel&&K.parentRecordId&&!h&&(U=e.get(K.parentModel),U)){j=U.getRecordMetadata(K.parentRecordId),j.inserted&&(D._masterRecordIsInserted=!0,D._clear()),j.deleted&&(D._saveDataState(),D._masterRecordIsDeleted=!0,D._clear(),D._addData(0,0,[],0,!1,!1)),k=D._parentFieldsMap={};for(let e in K.fields)F(K.fields,e)&&(T=K.fields[e],T.parentField&&(k[T.parentField]||(k[T.parentField]=[]),k[T.parentField].push(e)));D.parentModelViewId=U.subscribe({onChange:function(t,i){let n;if(t===_||t===g||t===f||t===p){n=i.recordIds||i.deletedIds;for(let s=0;s<n.length;s++)if(n[s]===K.parentRecordId){if(t===_)D._saveDataState(),D._masterRecordIsDeleted=!0,D._clear(),D._addData(0,0,[],0,!1,!1),V(D,c,{});else if(t!==g&&t!==f||!D._masterRecordIsDeleted)if(t===f&&i.newIds&&i.newIds[D.instance]){const t=i.newIds[D.instance];let n=[];K.parentRecordId=t,e.renameInstance(D.modelId(),t),D.forEach(((e,t,i)=>{let s=D.getRecordMetadata(i);s.autoInserted&&!s.updated&&n.push(s.record)})),n.length&&D.deleteRecords(n)}else t===p&&D._masterRecordIsDeleted&&delete D._saveState;else delete D._masterRecordIsDeleted,D._restoreDataState(),V(D,c,{});break}t===p&&D._masterRecordIsInserted&&delete D._masterRecordIsInserted}else t===y&&(i.oldIdentity||i.recordId)===K.parentRecordId?(O=i.field,O in k&&(C=k[O],q=U.getValue(i.record,O),D.forEach((function(e){let t;if(!D._metaKey||!e[D._metaKey].agg)for(let n=0;n<C.length;n++)t=C[n],i.oldValue===D.getValue(e,t)&&D.setValue(e,t,q)}))),i.oldIdentity&&(K.parentRecordId=i.recordId,e.renameInstance(D.modelId(),i.recordId))):t===c&&D._masterRecordIsDeleted?(delete D._masterRecordIsDeleted,D._restoreDataState(),V(D,c,{})):t===I&&(K.parentModel=null,D.parentModelViewId=null,delete D._masterRecordIsDeleted,delete D._masterRecordIsInserted)}}),e.release(K.parentModel)}return m.length>=w&&(N=function(){for(let e=0;e<m.length;e++){let t=m[e];if(!t.isChanged())return t}return null}(),N&&(i.info("Model: cache overflow; remove model from cache: "+N.modelId()),e.destroy(E(N.modelId())))),N=v[A[0]],N||(N={instances:{},instancesRef:{}},v[A[0]]=N),A[1]?(N.instancesRef[A[1]]=1,N.instances[A[1]]=D):(N.modelRef=1,N.model=D),i.info("Model: created model: "+t+" refCount: 1"),D},e.list=function(e,t,i){return de(null,i,e,t).map((e=>e.id))},e._resetTempIds=function(){k.clear()},e._getStats=function(){var e,t,i,n,s,r=[];for(e in v)if(F(v,e))for(s in(n=(t=v[e]).model)&&(i={name:n.name,instance:null,refCount:t.modelRef,cachePos:m.indexOf(n),subscribers:n._listeners.length,progressViews:n._listeners.map((function(e){return e.progressView||null}))},r.push(i)),t.instances)F(t.instances,s)&&(i={name:(n=t.instances[s]).name,instance:n.instance,refCount:t.instancesRef[s],cachePos:m.indexOf(n),subscribers:n._listeners.length,progressViews:n._listeners.map((function(e){return e.progressView||null}))},r.push(i));return r},e.anyChanges=function(e,t,i){return de("change",i,e,t).length>0},e.anyErrors=function(e,t,i){return de("error",i,e,t).length>0},e.addChangesToSaveRequest=function(e,t,i){let n=[],s=de("change",i,!1,t);if(s.length<=0)return null;for(let t=0;t<s.length;t++){let i=s[t].model.addChangesToSaveRequest(e);i&&n.push(i)}return function(e){for(let t=0;t<n.length;t++)n[t](e)}},e.save=function(e,i,n,s,r){let a,l,d,o;if(e=e||{},i=i||{},d=de("change",s,!1,n),a=apex.model.addChangesToSaveRequest(e,n,s),a){if(n&&void 0===i.loadingIndicator&&void 0===i.loadingIndicatorPosition){o=[];for(let e=1;e<d.length;e++)o.push(d[e].model);i.loadingIndicator=U(d[0].model,o)}return l=(r||t.plugin)(e,i),a(l),l}return null},e.multipleFetch=function(e,i,n,s){let r,a=[];if(e=e||{},i=i||{},n.forEach((t=>{let i,n=de(null,!1,!1,t);n.length>0&&(i=n[0].model._addToFetchRequest(e,0),i&&a.push(i))})),a.length>0){r=(s||t.plugin)(e,i);for(let e=0;e<a.length;e++)a[e](r);return r}return null},e.get=function(e){var t,n,s,r=E(e);return(t=v[r[0]])&&(r[1]?(n=t.instances[r[1]])&&(s=t.instancesRef[r[1]]+=1):(n=t.model)&&(s=t.modelRef+=1),n&&(oe(n),i.info("Model: get model: "+e+" refCount: "+s))),n},e.renameInstance=function(e,t){var n,s,r=E(e);(n=v[r[0]])&&r[1]&&((s=n.instances[r[1]]).instance=t,delete n.instances[r[1]],n.instances[t]=s,i.info("Model: rename model "+r[0]+" instance: "+r[1]+" to "+t),V(s,"instanceRename",{oldInstance:r[1],newInstance:t}))},e.release=function(t){const n=E(t);let s,r=v[n[0]];r&&(n[1]?(s=r.instancesRef[n[1]]-=1,r=r.instances[n[1]]):(s=r.modelRef-=1,r=r.model),i.info("Model: release model: "+t+" refCount: "+s),s<=0&&(r._options.parentModel&&le(r._options.parentModel)?(i.info("Model: save in cache model: "+t),function(e){let t=m.indexOf(e);t>=0&&m.splice(t,1),m.push(e)}(r)):r.isChanged()||e.destroy(t)))},e.destroy=function(t){const n=E(t);let s,r=v[n[0]];function a(n){if(n){if(oe(n),n.parentModelViewId){let t=n._options.parentModel,i=e.get(t);i&&(i.unSubscribe(n.parentModelViewId),n.parentModelViewId=null,e.release(t))}n._externalItems$&&n._externalItems$.off("change",n._externalItemsHandler),V(n,I,{}),n._data=null,n._index=null,n._selection=null,n._destroyed=!0,i.info("Model: destroy model: "+t)}}if(r){if(n[1])a(r.instances[n[1]]),delete r.instancesRef[n[1]],delete r.instances[n[1]];else if(a(r.model),delete r.model,delete r.modelRef,"string"==typeof t&&!n[1])for(s in r.instances)F(r.instances,s)&&(a(r.instances[s]),delete r.instancesRef[s],delete r.instances[s]);0!==Object.keys(r.instances).length||r.model||delete v[n[0]]}},e.getMaxCachedModels=function(){return w},e.setMaxCachedModels=function(e){w=parseInt(e,10)||10};const he=new Map;apex.binding.addDataRefType("model",{subscribe:function(t,n){if(!t.field||!(t.cursor&&!t.modelId||!t.cursor&&t.modelId))return void i.error("Invalid model data reference: ",t);const s=t.modelId||t.cursor.getModelId(),r=e.get(s);if(!r)return void i.error("No model: ",s);let a=he.get(s);if(!a){const e=(e,t)=>{if("refresh"===e);else if("refreshRecords"===e||"revert"===e);else if("move"===e);else if("insert"===e||"copy"===e);else if("clearChanges"===e);else if(t.recordIds);else if("set"===e||"metaChange"===e){const e=a.subscribers;for(let i=0;i<e.length;i++){let n=e[i],s=n.recordId;s||n.recordShape||(s=n.cursor.getCurentRecordId()),!n.recordShape&&s!==t.recordId||n.field!==t.field||n.notify()}}};a={subscribers:[],modelViewId:r.subscribe({onChange:e})},he.set(s,a)}e.release(s),a.subscribers.push({field:t.field,recordShape:"record"===r.getOption("shape"),cursor:t.cursor,recordId:t.recordId,notify:n})},unsubscribe:function(t,i){const n=t.modelId,s=he.get(n);if(s){let t=s.subscribers.findIndex((e=>e.notify===i));if(t>=0&&(s.subscribers.splice(t,1),0===s.subscribers.length)){e.get(n).unSubscribe(s.modelViewId),e.release(n),he.delete(n)}}},getValue:function(t){const n=t.modelId||t.cursor.getModelId(),s=e.get(n);if(!s)return void i.error("No model: ",n);let r,a,l;return"record"!==s.getOption("shape")?(l=t.recordId||t.cursor.getCurentRecordId(),a=s.getRecord(l)):a=s.getRecord(),a&&(r=s.getValue(a,t.field)),e.release(n),r},setValue:function(t,n,s,r,a){const l=t.modelId||t.cursor.getModelId(),d=e.get(l),o=t.field;if(!d)return void i.error("No model: ",l);let h,c;if("record"!==d.getOption("shape")?(c=t.recordId||t.cursor.getCurentRecordId(),h=d.getRecord(c)):h=d.getRecord(),h){let e,t=d.getValue(h,o);if(null!==t&&"object"==typeof t&&F(t,"v")&&(n={v:n,d:s}),e=d.setValue(h,o,n),"DUP"===e);else{let e=d.getRecordId(h);r.valid?d.setValidity("valid",e,o):d.setValidity("error",e,o,a)}}e.release(l)},parse:function(t,i){let n=a(i).attr("data-bind-cursor"),s=apex.region(n),r=null;if(n&&s&&s.getModelId&&s.getCurentRecordId){let i=s.getModelId();e.get(i)&&(r={type:"model",field:t,cursor:s},e.release(i))}return r}})}(apex.model,apex.server,apex.debug,apex.util,apex.item,apex.locale,apex.jQuery);
!function(t,o,e,a){"use strict";const n="a-Toolbar",i="a-Toolbar--small",r="a-Toolbar--simple",l="a-Toolbar-group",s="a-Toolbar-groupContainer",u="a-Button",c="a-Button--withIcon",d="data-action",p="class",h="disabled",b="aria-label",f="aria-hidden",m="aria-controls",g="start",C="center",_="end",y=t.ui.keyCode,T=o.hasOwnProperty;let k=1;function v(t,o){t.markup("<span aria-hidden='true' ").attr(p,"a-Icon "+o).markup("></span>")}function x(t,o,e,a,n){let i;o&&e&&v(t,o),n&&(i=a?"u-VisuallyHidden":"a-Button-label",t.markup(`<span class="${i}">`).content(n).markup("</span>")),o&&!e&&v(t,o)}function A(t,o,e,a){a&&o?(e||(e=o),t.attr("title",e).attr(b,o)):e&&t.attr("title",e)}t.widget("apex.toolbar",{version:"5.1",widgetEventPrefix:"toolbar",options:{label:"",toolbarFor:null,idPrefix:null,actionsContext:null,small:!1,simple:!1,toolbarClass:"",cursorKeyNavigation:!1,data:[]},_create:function(){const e=this.element,l=this,s=this.options;let u;u=o.debounce((function(o,a){"update"!==a&&"updateChoices"!==a||(l.enterActions[o.name]&&e.find('[data-enter-action="'+o.name+'"]').prop(h,!!o.disabled),e.is(":visible")&&e.find(".a-Toolbar-group").each((function(){let o,e=t(this);o=e.children().filter((function(){return!this.style||"none"!==this.style.display})).length>0,e.toggle(o)})))}),10),this.menus={},this.enterActions={},e.addClass(n).attr("role","toolbar").attr(b,s.label?s.label:a.formatMessage("APEX.TB.TOOLBAR")),s.toolbarFor&&e.attr(m,s.toolbarFor),s.small&&e.addClass(i),s.simple&&e.addClass(r),s.toolbarClass&&e.addClass(s.toolbarClass),apex.actions&&(this.actionsContext=s.actionsContext||apex.actions,this.actionsContext.observe(u),this.actionObserver=u),this.refresh(),s.cursorKeyNavigation&&(this.toolbarHasChanged(),this._on(this._keyNavHandlers))},_keyNavHandlers:{keydown:function(o){var e=this,a=o.which,n=t(o.target);function i(t){var a,n;t.attr("tabindex","-1"),a=(n=parseFloat(e.focusableElements.index(t[0])+1))>=e.focusableElements.length?e.focusableElements.first():e.focusableElements.filter(":eq("+n+")"),t.is(":input[type=radio]")&&t.attr("name")===a.attr("name")?i(a):a.attr("tabindex","0").trigger("focus"),o.preventDefault()}function r(t){var a,n;t.attr("tabindex","-1"),a=(n=parseFloat(e.focusableElements.index(t[0])-1))<0?e.focusableElements.last():e.focusableElements.filter(":eq("+n+")"),t.is(":input[type=radio]")&&t.attr("name")===a.attr("name")?r(a):a.attr("tabindex","0").trigger("focus"),o.preventDefault()}n.is(":input[type=text],:input[type=radio],select")?o.shiftKey&&a===y.TAB?r(n):a===y.TAB&&i(n):a===y.LEFT?r(n):a===y.RIGHT&&i(n)}},_destroy:function(){var o,e=this.element,a=this.options;for(o in e.removeClass("a-Toolbar a-Toolbar--small a-Toolbar--simple "+a.toolbarClass).removeAttr("role").empty(),this.actionsContext&&this.actionsContext.unobserve(this.actionObserver),this.menus)T(this.menus,o)&&t("#"+o).remove()},_setOption:function(t,o){const e=this.element;"small"===t&&e.toggleClass(i,o),"simple"===t&&e.toggleClass(r,o),"toolbarClass"===t&&e.removeClass(this.options.toolbarClass).addClass(o),this._super(t,o),"data"===t&&this.refresh()},_getControlProperty:function(t,o){let e,a;return a=t[o],void 0===a&&t.action&&(e=this.actionsContext.lookup(t.action),e&&e[o]&&(a=e[o])),a},_getControlIconProperty:function(t,o){let e=this._getControlProperty(t,"icon");return e||void 0===o||(e=this._getControlProperty(t,o?"onIcon":"offIcon")),e},_getLocalizedControlProperty:function(t,o){let e,n=null;return t[o+"Key"]?n=a.getMessage(t[o+"Key"]):void 0!==t[o]&&(n=t[o]),!n&&t.action&&(e=this.actionsContext.lookup(t.action),e&&void 0!==e[o]&&(n=e[o])),n},_getLocalizedControlLabelProperty:function(t,o){let e=this._getLocalizedControlProperty(t,"label");return e||void 0===o||(e=this._getLocalizedControlProperty(t,o?"onLabel":"offLabel")),e},_getNoUpdate:function(t){return t.label||t.labelKey||t.icon||t.title||t.titleKey?"true":null},_getId:function(t){var o=this.options.idPrefix||this.element[0].id||"tb";return t.id?o+"_"+t.id:null},_forceId:function(t){t.id||(t.id="m"+k,k+=1)},_buildText:function(o,e){var a=t.extend({id:"",label:"",size:"30",maxChars:"4000",placeholder:"",action:""},e);a.enterAction&&(this.enterActions[a.enterAction]=!0),o.markup("<input").optionalAttr("id",this._getId(a)).attr(p,"a-Toolbar-input a-Toolbar-inputText a-Toolbar-item").attr("title",this._getLocalizedControlProperty(a,"label")).attr("type","text").attr("size",a.size).attr("maxlength",a.maxChars).attr("value","").optionalAttr("placeholder",this._getLocalizedControlProperty(a,"placeholder")).optionalAttr("data-enter-action",a.enterAction).markup(" />")},_buildStatic:function(t,o){t.markup("<span").optionalAttr("id",this._getId(o)).attr(p,"a-Toolbar-static a-Toolbar-item").markup(">"),o.content?t.markup(o.content):t.content(this._getLocalizedControlProperty(o,"label")),t.markup("</span>")},_buildSelect:function(t,o){var e,a=this.actionsContext.lookup(o.action);(e=this._getLocalizedControlProperty(o,"title"))||(e=this._getLocalizedControlProperty(o,"label")),t.markup("<select").optionalAttr("id",this._getId(o)).attr(p,"a-Toolbar-selectList a-Toolbar-item").attr("size","1").optionalAttr("title",e).optionalAttr(b,e).optionalBoolAttr(h,a&&!!a.disabled).attr(d,o.action).markup("></select>")},_buildButton:function(t,o){let e,a,n,i,r,l,s="a-Button a-Toolbar-item",u=o.menu||o.menuId;u&&(o.menu?(this._forceId(o),e=this._getId(o)+"_menu"):e=o.menuId),r=this.actionsContext.lookup(o.action),r&&r.get&&(l=r.get(),!l||r.onLabel||r.onLabelKey||(s+=" is-active")),n=this._getControlIconProperty(o,l),n&&(s+=" "+c),n&&o.iconOnly&&(s+=" a-Button--noLabel"),o.hot&&(s+=" a-Button--hot"),t.markup("<button type='button'").attr(p,s).optionalAttr("id",this._getId(o)).optionalBoolAttr(h,r&&!!r.disabled),a=this._getLocalizedControlLabelProperty(o,l),i=this._getLocalizedControlProperty(o,"title"),A(t,a,i,n&&o.iconOnly),u?t.attr("data-menu",e).attr("aria-haspopup",!0):t.attr(d,o.action).optionalAttr("data-no-update",this._getNoUpdate(o)),t.markup(">"),x(t,n,o.iconBeforeLabel,o.iconOnly,o.iconOnly?null:a),u&&v(t,"a-Icon icon-menu-drop-down"),t.markup("</button>"),o.menu&&(this.menus[e]=o.menu)},_buildRadioButtonGroup:function(t,o){t.markup("<div role='group'").attr(b,this._getLocalizedControlProperty(o,"label")).attr(p,"a-Toolbar-radioGroup js-actionRadioGroup a-Toolbar-item").attr(d,o.action).attr("data-item",u).attr("data-item-wrap","a-Toolbar-button-item").markup("></div>")},_buildToggle:function(t,o){let e,a,n,i,r,l,s,u,g=this.actionsContext.lookup(o.action);this._forceId(o),a=this._getId(o),n=a+"_ON_STATE_ARIA_DESC",i=a+"_OFF_STATE_ARIA_DESC",u=g&&g.get(),e="a-Button a-Toolbar-button a-Toolbar-toggleButton",u&&(e+=" is-active"),r=this._getControlIconProperty(o,u),r&&(e+=" "+c),r&&o.iconOnly&&(e+=" a-Button--noLabel"),t.markup("<div").attr(p,"a-Toolbar-toggleButton js-actionToggle a-Toolbar-item").attr(d,o.action).optionalAttr("data-no-update",this._getNoUpdate(o)).markup(">"),g.onStateDescription&&t.markup("<span").attr("id",n).attr(p,"u-vh").attr(f,"true").markup(">").content(g.onStateDescription).markup("</span>"),g.offStateDescription&&t.markup("<span").attr("id",i).attr(p,"u-vh").attr(f,"true").markup(">").content(g.offStateDescription).markup("</span>"),t.markup("<button type='button'").attr(p,e).optionalAttr("data-no-update",this._getNoUpdate(o)).attr("name",o.action).attr("id",a).attr("aria-pressed",u?"true":"false").optionalAttr("aria-describedby",u?g.onStateDescription?n:null:g.offStateDescription?i:null).optionalAttr(m,g.ariaControls).attr(b,g.label).optionalBoolAttr(h,g&&!!g.disabled),l=this._getLocalizedControlLabelProperty(o,u),s=this._getLocalizedControlProperty(o,"title"),A(t,null,s,r&&o.iconOnly),t.markup(">"),x(t,r,o.iconBeforeLabel,o.iconOnly,l),t.markup("</button></div>")},_buildToolbar:function(t,o){var e,a=[],n=[],i=[];for(e=0;e<o.length;e++)o[e].align&&o[e].align!==g?o[e].align===C?n.push(o[e]):o[e].align===_&&i.push(o[e]):a.push(o[e]);a.length&&this._buildGroupContainer(t,g,a),n.length&&this._buildGroupContainer(t,C,n),i.length&&this._buildGroupContainer(t,_,i)},_buildGroupContainer:function(t,o,a){var n,i,r,u,c,d=s;switch(o){case g:d+=" a-Toolbar-groupContainer--start";break;case C:d+=" a-Toolbar-groupContainer--center";break;case _:d+=" a-Toolbar-groupContainer--end"}for(t.markup("<div").attr(p,d).markup(">"),n=0;n<a.length;n++){for(c=l,(r=a[n]).customCSS&&(c+=" "+r.customCSS),r.groupTogether&&(c+=" a-Toolbar-group--together"),t.markup("<div").attr(p,c).markup(">"),i=0;i<r.controls.length;i++)switch((u=r.controls[i]).type){case"STATIC":this._buildStatic(t,u);break;case"TEXT":this._buildText(t,u);break;case"SELECT":this._buildSelect(t,u);break;case"MENU":case"BUTTON":this._buildButton(t,u);break;case"RADIO_GROUP":this._buildRadioButtonGroup(t,u);break;case"TOGGLE":this._buildToggle(t,u);break;default:e.error("Unknown toolbar control type: "+u.type)}t.markup("</div>")}t.markup("</div>")},refresh:function(){let e,a,n,i=this,r=this.element,l=this.options,s=l.data,u=o.htmlBuilder();for(e in this.menus)T(this.menus,e)&&t("#"+e).remove();this._buildToolbar(u,l.data),r.html(u.toString());for(let t=0;t<s.length;t++){let o=s[t].controls;if(o)for(let t=0;t<o.length;t++){let e=o[t];n=this.actionsContext.lookup(e.action),n&&(n.hide&&this.actionsContext.update(e.action),n.choices&&this.actionsContext.updateChoices(e.action))}}for(e in r.find(".a-Toolbar-input").on("keydown",(function(o){var e=t(o.target).attr("data-enter-action");e&&13===o.which&&(i.actionsContext.invoke(e),o.preventDefault())})),this.menus)T(this.menus,e)&&(t("<div/>",{id:e,class:"a-Toolbar-menu",style:"display:none;"}).appendTo("body"),a=this.menus[e],a.actionsContext=this.actionsContext,a.idPrefix=this.options.idPrefix||this.element[0].id||"tb",t("#"+e).menu(a))},toolbarHasChanged:function(){var t,o;this.focusableElements=this.element.find(":focusable"),o=(t=this.focusableElements.filter("[tabindex=0]")).length?this.focusableElements.index(t[0]):0,this.focusableElements.filter(":eq("+o+")").attr("tabindex","0").end().not(":eq("+o+")").attr("tabindex","-1")},hideControl:function(t){const o=this.find(t);o&&(o.action?this.actionsContext.hide(o.action):(this.findElement(t).hide(),this.actionObserver&&this.actionObserver({},"update")))},showControl:function(t){const o=this.find(t);o&&(o.action?this.actionsContext.show(o.action):(this.findElement(t).show(),this.actionObserver&&this.actionObserver({},"update")))},disableControl:function(t){const o=this.find(t);o&&(o.action?this.actionsContext.disable(o.action):this.findElement(t).prop(h,!0))},enableControl:function(t){const o=this.find(t);o&&(o.action?this.actionsContext.enable(o.action):this.findElement(t).prop(h,!1))},findGroup:function(t){let o=this.options.data;for(let e=0;e<o.length;e++){let a=o[e];if(a.id===t)return a}return null},find:function(o){let e,a,n=this.options.data;for(let t=0;t<n.length;t++){let a=n[t].controls;if(a)for(let t=0;t<a.length;t++)if(e=a[t],e.id===o)return e}for(a in this.menus)if(T(this.menus,a)&&(e=t("#"+a).menu("find",o),e))return e;return null},findElement:function(o){let e,a=this._getId({id:o});return e=t("#"+a),e}})}(apex.jQuery,apex.util,apex.debug,apex.lang);
!function(t,e,i,s,n){"use strict";var o="a-IconList",a="a-IconList-item",r="."+a,l="u-selector",h=".u-selector",c="is-selected",d=".is-selected"+r,u="is-focused",f="aria-selected",g="aria-multiselectable",m="aria-labelledby",p="role",v="tabindex",b="u-RTL",C=n.ui.keyCode,y=0;function _(t){return t.parent().children().index(t)}function x(t){var e=t.find("a");return e.length?e[0]:t[0]}function w(t){return n(t).closest(r)}var I={begin:function(){this.text="<ul>\r\n"},item:function(t,e,i){this.text+="<li>"+s.escapeHTML(i)+"</li>\r\n"},end:function(){this.text+="</ul>\r\n"},toString:function(){return this.text}};n.widget("apex.iconList",n.extend(!0,{version:"19.1",widgetEventPrefix:"iconlist",options:{multiple:!1,itemSelector:!1,addItemSelector:!0,label:!0,navigation:!1,tabbableContent:null,noNavKeyContent:null,allowCopy:!0,dataTransferFormats:[{format:"text/plain",writer:Object.create({begin:function(){this.text=""},item:function(t,e,i){e>0&&(this.text+="\r\n"),this.text+=i},end:function(){},toString:function(){return this.text}})},{format:"text/html",writer:Object.create(I)}],selectionChange:null,activate:null},_create:function(){var t,i=this,r=this.options,l=this.element;this.columns=0,this.rows=0,this.searchString="",this.searchTimerId=null,r.navigation&&(r.multiple=!1),l.addClass(o).attr(p,"listbox"),r.multiple&&l.attr(g,"true"),this.forwardKey=C.RIGHT,this.backwardKey=C.LEFT,"rtl"===l.css("direction")&&(l.addClass(b),this.forwardKey=C.LEFT,this.backwardKey=C.RIGHT),l.attr(m)?(t=n("#"+l.attr(m).split(" ").join(",#")).last(),this.infoId=t.attr("id")+"_info",t.append("<span id='"+this.infoId+"' class='u-VisuallyHidden'></span>")):(y+=1,this.infoId=(l.attr("id")||"il"+y)+"_info",l.before("<span id='"+this.infoId+"' class='u-VisuallyHidden'></span>"),l.attr(m,this.infoId),this.addedLabel=!0),this._initContextMenu(a,(function(){return!1}),(function(t){var e=w("keydown"===t.type&&i.lastFocused?i.lastFocused:t.target);return!!e.length&&(!!e.hasClass(c)||e)})),this._on(this._eventHandlers),r.allowCopy&&e.addHandler(l[0],(function(t){return i._copy(t),!0})),this._selNotifyDelay=s.debounce(this._selChangeNotify,1),this._selNotifyLongDelay=s.debounce(this._selChangeNotify,350),this.refresh(),r.disabled&&this._setOption("disabled",r.disabled)},_eventHandlers:{resize:function(t){t.target===this.element[0]&&(this._dim(),t.stopPropagation())},click:function(t){var e,i=this.options,s=i.navigation,o=n(t.target);s&&o.closest("a").length>0&&(t.shiftKey||t.ctrlKey)||(e=o.closest(r)).length&&(i.itemSelector&&o.closest(h).length&&(t.ctrlKey=!0,t.shiftKey=!1),this._select(e,t,!0,!1),s&&this._activate(t),!s&&i.tabbableContent&&o.closest(i.tabbableContent).length?i.tabbableContent&&o.closest(i.tabbableContent).length&&o.trigger("focus"):t.preventDefault())},dblclick:function(t){this.options.navigation||w(t.target).length&&this._activate(t)},mousedown:function(t){t.preventDefault()},keydown:function(t){var e,i,s,o=this.element,a=this.options,r=n(t.target),l=null,h=t.which;!a.navigation&&a.noNavKeyContent&&r.closest(a.noNavKeyContent).length||(h===C.HOME?l=o.children().first():h===C.END?l=o.children().last():h===C.DOWN?this.lastFocused&&(e=this._index2RowCol(_(w(this.lastFocused))),i=o.children(),e.row<Math.floor((i.length-1)/this.columns)&&((s=this._rowCol2Index(e.row+1,e.column))>=i.length&&(s=i.length-1),l=i.eq(s))):h===C.UP?this.lastFocused&&(e=this._index2RowCol(_(w(this.lastFocused))),i=o.children(),(s=this._rowCol2Index(e.row-1,e.column))>=0&&(l=i.eq(s)),l&&t.stopPropagation()):h===this.backwardKey?this.lastFocused&&(l=w(this.lastFocused).prev()):h===this.forwardKey?this.lastFocused&&(l=w(this.lastFocused).next()):h===C.SPACE?this.lastFocused&&!this.searchTimerId&&(l=w(this.lastFocused)):h===C.ENTER&&"A"!==t.target.nodeName&&this._activate(t),l&&l[0]&&(this._select(l,t,!0,!0),t.preventDefault()))},keypress:function(t){var e,i,s=this.options,o=this;if(0!==t.which&&s.label&&!t.altKey&&!t.ctrlKey&&(s.navigation||!s.noNavKeyContent||!n(t.target).closest(s.noNavKeyContent).length)){if(e=String.fromCharCode(t.which).toLowerCase(),this.searchTimerId)e!==this.searchString&&(this.searchString+=e),clearTimeout(this.searchTimerId),this.searchTimerId=null;else{if(" "===e)return;this.searchString=e}this.searchTimerId=setTimeout((function(){o.searchTimerId=null}),500),(i=this._findItem(this.searchString))&&this._select(i,t,!0,!0)}},focusin:function(t){var e=w(t.target);0!==e.length&&(e.addClass(u),this._setFocusable(t.target))},focusout:function(t){w(t.target).removeClass(u)}},_destroy:function(){var t=this.element,i=this.options;t.removeClass("a-IconList is-disabled u-RTL").removeAttr(p).removeAttr(g).children().removeClass(a).removeAttr(p).removeAttr(f).removeAttr(v),t.find("a").removeAttr(v).removeAttr(p),i.itemSelector&&i.addItemSelector&&t.find(h).remove(),e.removeHandler(t[0]),this._destroyContextMenu(),n("#"+this.infoId).remove(),this.addedLabel&&t.removeAttr(m)},_setOption:function(t,e){var i,s,n=this.options,o=this.element;if(this._checkContextMenuOptions(t,e),"multiple"===t)n.navigation&&(e=!1);else if("allowCopy"===t||"addItemSelector"===t||"navigation"===t)throw new Error("IconList "+t+" option cannot be set");this._super(t,e),"disabled"===t?(o.toggleClass("is-disabled ui-state-disabled",e).attr("aria-disabled",e),this.lastFocused&&(e?this.lastFocused&&((i=!n.navigation&&n.tabbableContent)?(s=w(this.lastFocused)).add(s.find(i).not(":disabled")).prop("tabIndex",-1):this.lastFocused.tabIndex=-1):this._setFocusable(this.lastFocused)),e&&this._dim()):"multiple"===t?e?o.attr(g,"true"):o.removeAttr(g):"itemSelector"===t&&this.refresh()},refresh:function(){var t,e,i,s=this.options,o=this.element;s.multiple&&!s.itemSelector&&apex.userHasTouched()&&(s.itemSelector=!0,s.addItemSelector=!0),o.find("a").attr(v,-1).attr(p,"option"),o.find(s.tabbableContent).attr(v,-1),(i=o.children()).addClass(a).filter((function(){return 0===n(this).find("a").length})).attr(p,"option").attr(v,-1),s.addItemSelector&&(s.itemSelector?(e=n("<span class='"+(s.multiple?l:"u-selector u-selector--single")+"'></span>"),i.filter((function(){return n(this).find(h).length<=0})).prepend(e)):o.find(h).remove()),this._dim(),(t=o.find(d)).length>0?this.setSelection(t,!1):(this.lastFocused&&n(this.lastFocused).is(":visible")||(this.lastFocused=x(o.children().first())),this.selectAnchor=this.lastFocused,this.lastFocused&&!s.disabled&&this._setFocusable(this.lastFocused))},resize:function(){this._dim()},focus:function(){this.lastFocused&&this.lastFocused.focus()},getColumns:function(){return this.columns},getRows:function(){return this.rows},getSelection:function(){return this.element.find(d)},getSelectionValues:function(){var t=[];return this.getSelection().each((function(){t.push(n(this).attr("data-value"))})),t},setSelection:function(t,e,i){e=!!e,this._select(t,null,e,!1,i)},_copy:function(t){var e,i,s=this.getSelection(),n=this.options.dataTransferFormats;if(s.length){for(n.forEach((function(t){t.writer.begin(s)})),e=0;e<s.length;e++)i=s.eq(e),n.forEach((function(t){t.writer.item(i,e,i.text())}));n.forEach((function(e){e.writer.end(),t.setData(e.format,e.writer.toString())}))}},_rowCol2Index:function(t,e){return t*this.columns+e},_index2RowCol:function(t){var e=Math.floor(t/this.columns);return{row:Math.floor(t/this.columns),column:t-e*this.columns}},_dim:function(){var t,e,s,o=this,a=this.element,r=a.width(),l=a.children(),h=l.length;h&&(t=l.first().position().top,s=l.first().outerWidth()),this.columns=h,l.each((function(e){var i=n(this).position().top;if(i>t)return t=i,o.columns=e,!1})),this.rows=h>0?Math.floor((h+this.columns-1)/this.columns):0,1===this.rows&&(this.columns=Math.floor(r/s)),e=1===this.columns?i.formatMessage("APEX.ICON_LIST.LIST_DIM",this.rows):i.formatMessage("APEX.ICON_LIST.GRID_DIM",this.columns,this.rows),n("#"+this.infoId).text(e)},_findItem:function(t){var e,i,s=this.element,n=t.length,o=this.options.label;for(e=i=w(this.lastFocused),1===n&&(e=e.next()),0===e.length&&(e=s.children().first());e.length>0;){if((!0===o?e.text().trim():e.find(o).text()).substring(0,n).toLowerCase()===t)return e;if(0===(e=e.next()).length&&(e=s.children().first()),e[0]===i[0])break}return null},_setFocusable:function(t){var e,i=this.options,s=!i.navigation&&i.tabbableContent;this.lastFocused&&this.lastFocused!==t&&(s?(e=w(this.lastFocused)).add(e.find(s).not(":disabled")).prop("tabIndex",-1):this.lastFocused.tabIndex=-1),s?(e=w(t)).find(s).not("disabled").prop("tabIndex",0).length||e.prop("tabIndex",0):t.tabIndex=0,this.lastFocused=t},_activate:function(t){var e,i;this._trigger("activate",t,{values:this.getSelectionValues()}),this.options.navigation&&!t.isDefaultPrevented()&&(i=(e=this.getSelection()).attr("href")||e.find("a").attr("href"))&&(t.preventDefault(),apex.navigation.redirect(i))},_select:function(t,e,i,o,a){var r,l,u,g,m,p,v,b,C,y="set",w=this.element,I=this.options,F=w.find(d);t=t.filter(":visible"),e&&I.multiple&&("click"===e.type?e.ctrlKey||e.metaKey?y="toggle":e.shiftKey&&(y="range"):"keydown"===e.type&&(e.keyCode===n.ui.keyCode.SPACE?y=e.ctrlKey?"toggle":e.shiftKey?"range":"add":e.ctrlKey?y="none":e.shiftKey&&(y="range"))),"range"!==y||this.selectAnchor||(y="set"),"set"!==y&&"range"!==y||F.removeClass(c).removeAttr(f).find(h).removeClass(c),r=t.hasClass(c),"set"===y||"add"===y||"toggle"===y&&!r?(t.addClass(c).attr(f,!0).find(h).addClass(c),this.selectAnchor=t[0]):"range"===y?(w.children().removeClass(c).removeAttr(f).find(h).removeClass(c),p=_(n(this.selectAnchor)),v=_(t.last()),p>v&&(b=v,v=p,p=b),w.children().filter((function(t){return t>=p&&t<=v})).addClass(c).attr(f,!0).find(h).addClass(c)):"toggle"===y&&r&&(t.removeClass(c).removeAttr(f).find(h).removeClass(c),this.selectAnchor=t[0]),t.length>0&&(C=x(t.first()),i?(C.tabIndex=0,C.focus()):this._setFocusable(C),(g=(u=w.scrollParent())[0]===document?{left:0,top:0}:u.offset())&&(m=w.offset(),((l=t.first().offset()).top<g.top||l.top>g.top+u[0].offsetHeight)&&(u[0].scrollTop=l.top-m.top),(l.left+t[0].offsetWidth<g.left||l.left>g.left+u[0].offsetWidth)&&(u[0].scrollLeft=l.left-m.left))),a||I.navigation&&e&&"click"===e.type||("toggle"===y||"range"===y&&!r||"add"===y&&!r||"set"===y&&!s.arrayEqual(F,t))&&(o?this._selNotifyLongDelay(e):this._selNotifyDelay(e))},_selChangeNotify:function(t){this.element.hasClass(o)&&this._trigger("selectionChange",t)}},apex.widget.contextMenuMixin))}(apex.debug,apex.clipboard,apex.lang,apex.util,apex.jQuery);
!function(e,t,a,s,i){"use strict";const o="a-Combobox",n="a-Combobox-wrapper",l="combobox",r="-values",u="-menu",p="-showAll";e.widget("apex.combobox",{version:"5.1",widgetEventPrefix:l,options:{source:[],multipleValues:!1,multipleValueDelimiter:",",label:""},_create:function(){var u=t.htmlBuilder(),p=this,m=this.options,h=e(".a-Combobox").length;this.baseId=this.element[0].id||l+(h+1),this.actions=a.createContext(l,this.element[0]),m.label||i.warn("Label not provided, which is an accessibility issue (unless the 'label' option is later set)."),u.markup("<span").attr("class",n).markup("></span>"),this.element.wrap(u.toString()).addClass(o),this.wrapper$=this.element.closest(".a-Combobox-wrapper"),this._createShowAllButton(),this._on(this.element,{keydown:function(t){(t.altKey||t.metaKey)&&t.which===e.ui.keyCode.DOWN&&(p.menu$.menu("open",p.element,!1),p.menu$.find(":focusable").first().trigger("focus"))}}),this.actions.add({name:this.baseId+r,label:s.getMessage("APEX.COMBOBOX.LIST_OF_VALUES"),set:function(e){var t=p.element.val();m.multipleValues?p.element.val((t?t+m.multipleValueDelimiter:t)+e):p.element.val(e),t!==p.element.val()&&p.element.trigger("change")},get:function(){return p.element.val()},choices:m.source})},_setOption:function(t,a){switch(this._super(t,a),t){case"multipleValues":break;case"source":this.actions.lookup(this.baseId+r).choices=a,this.actions.updateChoices(this.baseId+r);break;case"label":e("#"+this.baseId+p,this.wrapper$).attr("title",s.formatMessage("APEX.COMBOBOX.SHOW_ALL_VALUES",a)).attr("aria-label",s.formatMessage("APEX.COMBOBOX.SHOW_ALL_VALUES",a))}},_createShowAllButton:function(){var a=t.htmlBuilder();a.markup("<button type='button'").attr("id",this.baseId+p).attr("tabindex","-1").attr("title",s.formatMessage("APEX.COMBOBOX.SHOW_ALL_VALUES",this.options.label)).attr("aria-label",s.formatMessage("APEX.COMBOBOX.SHOW_ALL_VALUES",this.options.label)).attr("class","a-Button a-Button--withIcon a-Button--noLabel").attr("data-menu",this.baseId+u).attr("aria-haspopup",!0).attr("aria-expanded",!1).markup(">"),a.markup("<span").attr("aria-hidden",!0).attr("class","a-Icon icon-menu-drop-down").markup(">").markup("</span>"),a.markup("</button>"),this.wrapper$.append(a.toString()),this.menu$=e("<div/>",{id:this.baseId+u,class:"",style:"display:none;"}).appendTo("body"),this.menu$.menu({actionsContext:this.actions,items:[{type:"radioGroup",action:this.baseId+r}]})},_destroy:function(){this.element.insertBefore(this.wrapper$),this.wrapper$.remove(),this.menu$.remove(),this.element.removeClass(o),a.removeContext(l,this.element[0])}})}(apex.jQuery,apex.util,apex.actions,apex.lang,apex.debug);
!function(i,t,e){"use strict";var s=".a-Splitter",o="a-Splitter-barH",r="a-Splitter-barV",n=".a-Splitter-barH,."+r,a="a-Splitter-thumb",l="."+a,h="u-RTL",p="is-active",d="is-collapsed",c="is-disabled",f="button",b="title";i.widget("apex.splitter",{version:"5.0",widgetEventPrefix:"splitter",options:{orientation:"horizontal",positionedFrom:"begin",minSize:60,position:100,noCollapse:!1,dragCollapse:!0,collapsed:!1,snap:!1,inc:10,realTime:!1,iframeFix:!1,restoreText:null,collapseText:null,title:null,change:null},lastPos:null,bar$:null,before$:null,after$:null,horiz:!0,fromEnd:!1,barSize:1,_create:function(){var o,r,n,a,d,c,b=this,u=this.options,m=this.element,g=t.htmlBuilder(),z=i.ui.keyCode,S=!!u.snap&&[1*u.snap,1*u.snap],C=u.noCollapse?0:1,v=null;if(2!==m.children().length)throw new Error("Splitter must have exactly two children.");if("horizontal"!==u.orientation&&"vertical"!==u.orientation)throw new Error("Orientation bad value");if("begin"!==u.positionedFrom&&"end"!==u.positionedFrom)throw new Error("PositionedFrom bad value");if(u.minSize<C&&(u.minSize=C,e.warn("Option minSize adjusted")),this.horiz="horizontal"===u.orientation,this.fromEnd="end"===u.positionedFrom,c=this.horiz?"left":"top",this.before$=m.children().eq(0),this.after$=m.children().eq(1),m.addClass("a-Splitter resize"),"rtl"===m.css("direction")&&(m.addClass(h),this.horiz&&(this.before$=m.children().eq(1),this.after$=m.children().eq(0),this.fromEnd=!this.fromEnd)),m.parent(s).length>0||this.before$.is(s)||this.after$.is(s))throw new Error("Child of splitter cannot be a splitter");this.before$[0].id||(this.before$[0].id=(m[0].id||"splitter")+"_first"),this.after$[0].id||(this.after$[0].id=(m[0].id||"splitter")+"_second"),u.position<u.minSize&&(u.position=u.minSize),this.lastPos=u.position,u.snap&&(u.inc=u.snap),this._renderBar(g),this.bar$=i(g.toString()).insertAfter(m.children().eq(0)),this.horiz?this.barSize=this.bar$.width():this.barSize=this.bar$.height(),m.css({position:"relative"}).children().css({position:"absolute"}),this.horiz?(o=this.bar$.position()[c],r=0,n="e-resize",this.fromEnd?(a=z.LEFT,d=z.RIGHT):(a=z.RIGHT,d=z.LEFT)):(o=0,r=this.bar$.position()[c],n="s-resize",this.fromEnd?(a=z.UP,d=z.DOWN):(a=z.DOWN,d=z.UP)),this.bar$.css({left:o,top:r}).draggable({axis:b.horiz?"x":"y",containment:"parent",cancel:f,cursor:n,iframeFix:u.iframeFix,grid:S,scroll:!1,drag:function(i,t){var e;u.realTime&&(e=t.position[c],b.fromEnd&&(e=(b.horiz?m.width():m.height())-e-b.barSize),b._setPos(e,!1))},start:function(){b.bar$.addClass(p)},stop:function(i,t){var e=t.position[c];b.bar$.removeClass(p),b.fromEnd&&(e=(b.horiz?m.width():m.height())-e-b.barSize),b._setPos(e,!1)}}).on("click",(function(){i(this).find(l).trigger("focus")})).find(f).on("click",(function(){b._setPos(b._getPos(),!b._isCollapsed())})),apex.widget.util.TouchProxy.addTouchListeners(this.bar$[0]),this.bar$.find(l).on("focus",(function(){i(this).parent().addClass("is-focused is-active")})).blur((function(){i(this).parent().removeClass("is-focused is-active")})).keydown((function(i){var t,e,s=i.keyCode,o=null,r=!1;if(s!==d||u.collapsed?s===a&&((o=b._getPos())<0?(u.noCollapse||(r=!0),o=0):o+=u.inc,t=b._getMaxPos(),o>t&&(o=t)):(o=b._getPos(),(o-=u.inc)<u.minSize&&u.noCollapse&&(o=u.minSize),o<0&&(o=0)),null!==o)return e=o,b.fromEnd&&(e=(b.horiz?m.width():m.height())-e-b.barSize),b.bar$.css(c,e),v&&(clearTimeout(v),v=null),v=setTimeout((function(){v=null,b._setPos(o,r)}),100),!1})),this._on(!0,this._eventHandlers),u.disabled&&this._setOption("disabled",u.disabled),this.refresh()},_eventHandlers:{resize:function(e){var s,o,r,n,a=this.options,l=this.element;if(e.target===l[0]){if(s=l.height(),o=l.width(),0===s||0===o)throw new Error("Splitter needs to be in a component with size");n=l.offset(),this.horiz?(l.children().each((function(){t.setOuterHeight(i(this),s)})),this.fromEnd?(r=[n.left+a.minSize,n.top,n.left+o-this.barSize,n.top+s],a.dragCollapse&&!a.noCollapse||(r[2]-=a.minSize)):(r=[n.left,n.top,n.left+o-this.barSize-a.minSize,n.top+s],a.dragCollapse&&!a.noCollapse||(r[0]+=a.minSize+1))):(l.children().each((function(){t.setOuterWidth(i(this),o)})),this.fromEnd?(r=[n.left,n.top+a.minSize,n.left+o,n.top+s-this.barSize],a.dragCollapse&&!a.noCollapse||(r[3]-=a.minSize)):(r=[n.left,n.top,n.left+o,n.top+s-this.barSize-a.minSize],a.dragCollapse&&!a.noCollapse||(r[1]+=a.minSize+1))),this._setPos(a.position,a.collapsed),this.bar$.draggable("option","containment",r),l.children(".resize").filter(":visible").trigger("resize"),e.stopPropagation()}}},_destroy:function(){this.element.removeClass("a-Splitter is-disabled u-RTL resize").children(n).remove(),this.element.children().css("position","")},refresh:function(){this.element.is(":visible")&&this.element.trigger("resize")},_setOption:function(t,s){var o,r,n;if(!this.options.noCollapse||"collapsed"!==t&&"restoreText"!==t&&"collapseText"!==t){if("orientation"===t||"positionedFrom"===t||"noCollapse"===t)throw new Error("Readonly option: "+t);"position"===t?this._setPos(1*s,this._isCollapsed()):"collapsed"===t?this._setPos(this._getPos(),!!s):"snap"===t?(s=!!s&&1*s,this.options.snap=s,o=!!s&&[s,s],this.bar$.draggable("option","grid",o),s&&(this.options.inc=s)):"inc"===t?(s*=1,this.options.snap&&(s=this.options.snap),this.options.inc=s):"disabled"===t?(this.options.disabled=s,n=this.bar$.find(l),this.options.noCollapse?s?n.removeAttr("tabindex"):n.attr("tabindex","0"):(n[0].disabled=s,s?n.attr(b,this.options.title):n.attr(b,this.options.collapsed?this.options.restoreText:this.options.collapseText)),this.bar$.draggable("option","disabled",s),s?(this.element.addClass(c),this.bar$.addClass(c),n.attr("aria-disabled",!0)):(n.removeAttr("aria-disabled"),this.bar$.removeClass(c),this.element.removeClass(c))):"minSize"===t?(s<(r=this.options.noCollapse?0:1)&&(s=r,e.warn("Option minSize adjusted")),this.options.minSize=s):i.Widget.prototype._setOption.apply(this,arguments),"title"===t?(this.bar$.attr(b,s),(this.options.noCollapse||this.options.disabled)&&this.bar$.find(l).attr(b,s)):"restoreText"===t&&this.options.collapsed&&!this.options.disabled?this.bar$.find(f).attr(b,s):"collapseText"!==t||this.options.collapsed||this.options.disabled?"iframeFix"===t?this.bar$.draggable("option","iframeFix",s):"dragCollapse"===t&&this.refresh():this.bar$.find(f).attr(b,s)}else e.warn("Setting "+t+" option on noCollapse splitter has no effect.")},_renderBar:function(i){var t=this.options,e=this.horiz?o:r;this.fromEnd&&(e+=" a-Splitter--end"),t.noCollapse&&(t.collapsed=!1),t.collapsed&&(e+=" is-collapsed"),i.markup("<div").attr("class",e).optionalAttr(b,t.title).markup("><div></div>"),t.noCollapse?i.markup("<span role='separator' class='"+a+"' tabindex='0' aria-expanded='true'").optionalAttr(b,t.title).markup("></span>"):i.markup("<button role='separator' class='"+a+"' type='button'").attr("aria-expanded",!t.collapsed).optionalAttr(b,t.collapsed?t.restoreText:t.collapseText).markup("></button>"),i.markup("</div>")},_getPos:function(){var i=this.element,t=this.horiz?"left":"top",e=this.bar$.position()[t];return this.fromEnd&&(e=(this.horiz?i.width():i.height())-e-this.barSize),e},_isCollapsed:function(){return this.bar$.hasClass(d)},_getMaxPos:function(){var i=this.options,t=this.element;return this.horiz?t.width()-this.barSize-i.minSize:t.height()-this.barSize-i.minSize},_setPos:function(i,e){var s,o,r,n,a,h,p=this.options,c=this.element,f=this.horiz?"left":"top",u=this._isCollapsed(),m=this.lastPos;p.noCollapse&&(e=!1),u&&!e&&(i=this.lastPos)<p.minSize&&(i=p.minSize),i<p.minSize?p.noCollapse?i=p.minSize:e=!0:i>(s=this._getMaxPos())&&(i=s),p.noCollapse&&i<=0&&(i=0),i>0&&(this.lastPos=i),e&&(i=0,p.position=0),o=this.horiz?c.width():c.height(),a=i,this.fromEnd&&(a=o-i-this.barSize),this.bar$.css(f,a),h=this.bar$.find(l),this.fromEnd?(r=this.after$,n=o-a-this.barSize):(r=this.before$,n=a),e?(this.bar$.addClass(d),p.disabled||h.attr("aria-expanded",!1).attr(b,p.restoreText),r.hide()):(p.noCollapse?r.toggle(0!==i):(this.bar$.removeClass(d),p.noCollapse||p.disabled||h.attr("aria-expanded",!0).attr(b,p.collapseText),r.show()),this.horiz?t.setOuterWidth(r,n):t.setOuterHeight(r,n)),this.fromEnd?(r=this.before$,n=a):(r=this.after$,n=o-a-this.barSize),this.horiz?t.setOuterWidth(r,n):t.setOuterHeight(r,n),p.noCollapse&&r.toggle(0!==n),this.after$.css(f,a+this.barSize+"px"),this.before$.css(f,0),(!e&&i!==m||u!==e)&&(p.collapsed=e,p.position=i,c.children(".resize").filter(":visible").trigger("resize"),this._trigger("change",{},{position:p.position,collapsed:p.collapsed,lastPosition:this.lastPos}))}});var u=0,m=0;i.apex.splitter.nextSplitter=function(t){var e,s,o,a=t?-1:1,h=i(document.activeElement);if(!(u>0||m>0))return(o=(s=i(".a-Splitter >.a-Splitter-barH,.a-Splitter >."+r).filter(":visible").not(".ui-state-disabled").add(h)).index(h))>=0&&(o+=a,t&&h.parent().is(n)&&(o+=a),o>=0&&o<s.length&&(e=s.eq(o))),(e&&0===e.length&&!h.parent().is(n)||h.is("html,body"))&&(e=i(".a-Splitter >.a-Splitter-barH,.a-Splitter >."+r).filter(":visible").not(".ui-state-disabled")[t?"last":"first"]()),e&&e.length>0?(e.children(l).trigger("focus"),!0):void 0},i((function(){i(document.body).on("menubeforeopen",(function(){m+=1})).on("menuafterclose",(function(){m-=1})).on("dialogopen",(function(){u+=1})).on("dialogclose",(function(){u-=1}))})),apex.message&&apex.message.addVisibilityCheck((function(t){var e=i("#"+t);e.parents(".a-Splitter").each((function(){e.is(":visible")||i(this).splitter("option","collapsed",!1)}))}))}(apex.jQuery,apex.util,apex.debug);
!function(t,e,i,s,o,a){"use strict";const n="a-GV-noDataMsg",l="a-GV-moreDataMsg",r=".a-GV-altMessage",h="a-GV--hideDeleted",c="a-GV-scrollFiller",d=".a-GV-scrollFiller",g=".is-deleted",u="aria-selected",f="is-selected",p=".is-selected",m=".is-aggregate",_="aria-labelledby",v="js-tabbable",R=":tabbable",S=":visible",C="data-start",I="data-end",P="data-id",b="data-rownum",$="data-state",w="data-page",T="disabled",k=".js-pg-prev,.js-pg-next,.js-pg-first,.js-pg-last",y="before",O="after",A="pageChange",M=t.hasOwnProperty,D=Object.entries,L=t.applyTemplate,F=Array.isArray,E=t=>parseInt(t,10);let x={};function V(t){return s.getMessage("APEX.GV."+t)}function N(t,...e){return s.formatMessage("APEX.GV."+t,...e)}function H(t,e){return Math.floor(t/e)*e}function G(t,e,i,s,o){let a=Math.ceil((i+1-e)/s)*o;t.css("height",a)}function z(t,e,i){t.find(d).each((function(){let t=a(this),s=E(t.attr(C)),o=E(t.attr(I));G(t,s,o,e,i)}))}function B(t){return"collapse"!==t.css("visibility")}function K(t,e){t.css("visibility",e?"":"collapse").toggleClass("is-hidden",!e)}function j(t){return t.getOption("hasTotalRecords")}a.widget("apex.tableModelViewBase",{version:"21.1",widgetEventPrefix:"tableModelViewBase",options:{modelName:null,progressOptions:null,noDataMessage:"",noDataIcon:"icon-irr-no-results",moreDataMessage:"",editable:!1,autoAddRecord:!1,hideDeletedRows:!1,hasSize:!1,footer:!0,fixedRowHeight:!0,showNullAs:"-",applyTemplateOptions:{},stickyTop:!1,stickyFooter:!1,hideEmptyFooter:!1,pagination:{scroll:!1,virtual:!1,loadMore:!1,showPageLinks:!1,maxLinks:5,showPageSelector:!1,showRange:!0,firstAndLastButtons:!1,hideSinglePage:!1},persistSelection:!1,highlights:{},highlighter:null,highlighterContext:null,rowsPerPage:null,selectionStatusMessageKey:"APEX.GV.SELECTION_COUNT",scrollParentOverride:null},firstPage:function(){let t;return!this.renderInProgress&&(this.options.pagination.scroll?(t=this.scrollParent$,t.scrollTop(this.scrollDelta)):this.pageOffset>0&&(this.pageOffset=0,this.refresh(!1)),!0)},previousPage:function(){let t,e;return!this.renderInProgress&&(this.options.pagination.scroll?(t=this.scrollParent$,e=t.scrollTop()-this.scrollDelta-this.viewportHeight,e<0&&(e=0),t.scrollTop(e+this.scrollDelta)):this.pageOffset>0&&(this.pageOffset-=this.pageSize,this.pageOffset<0&&(this.pageOffset=0),this.refresh(!1)),!0)},nextPage:function(){let t,e,i,s;return!this.renderInProgress&&(this.options.pagination.scroll?(t=this.scrollParent$,e=this._getDataContainer().first().height()-this.viewportHeight,i=t.scrollTop()-this.scrollDelta+this.viewportHeight,i>e&&(i=e),t.scrollTop(i+this.scrollDelta)):(s=this.model.getTotalRecords(),(s<0||this.pageOffset+this.pageCount<s)&&(this.pageOffset+=this.pageSize,this.refresh(!1))),!0)},lastPage:function(){let t,e,i,s;return!this.renderInProgress&&(this.options.pagination.scroll?(e=this.scrollParent$,i=this._getDataContainer().first().height()-this.viewportHeight,e.scrollTop(i+this.scrollDelta)):(s=this.model.getTotalRecords(),s>0&&this.pageOffset+this.pageCount<s&&(t=Math.ceil(s/this.pageSize),this.pageOffset=(t-1)*this.pageSize,this.refresh(!1))),!0)},loadMore:function(){return this.options.pagination.scroll&&!this._scrollHandler?this._addNextPage():this.nextPage()},getPageInfo:function(){let e=null,i=j(this.model),s=this.options.pagination,o=this.model.getTotalRecords(),n=this.model.getServerTotalRecords();if(!this.noData)if(e={rowHeight:this.avgRowHeight,recordsPerRow:this._getRecordsPerRow(),firstOffset:this.pageFirstOffset||null,lastOffset:this.pageLastOffset||null,pageSize:this.pageSize,pageOffset:this.pageOffset},i&&(e.total=n),s.scroll){let i,s=this.scrollParent$[0]===window,o="TBODY"===this._getDataContainer()[0].nodeName,n=this._getDataContainer().children().not(m);e.scrollOffset=this.scrollParent$.scrollTop(),i=t.binarySearch(n,e.scrollOffset,((t,i)=>{let n=a(i),l=s?n.offset().top:n.position().top;return s||o||n.offsetParent().closest(this.scrollParent$).length>0||(l+=e.scrollOffset),t-l})),e.viewOffset=E(n.eq(i).attr(b))-1}else e.currentPage=Math.floor(this.pageOffset/this.pageSize),o>=0&&(e.totalPages=Math.ceil(o/this.pageSize));return e},gotoPage:function(t){let e,i=this.model.getTotalRecords();return!this.renderInProgress&&(i>0&&(e=Math.ceil(i/this.pageSize),t>=0&&t<e&&(this.pageOffset=t*this.pageSize,this.refresh(!1))),!0)},getActiveRecordId:function(){return this.activeRecordId},getActiveRecord:function(){return this.activeRecord},getModel:function(){return this.model},setActiveRecordValue:function(t){var e=this.columnItems[t];this.activeRecord&&e&&(this.ignoreItemChange=!0,this._setModelValue(null,e.item,this.activeRecord,t,!0),this.ignoreItemChange=!1)},lockActive:function(){this.activeRecord&&(this.activeLockCount+=1)},unlockActive:function(){this.activeRecord&&(this.activeLockCount-=1,this.activeLockCount<0&&(this.activeLockCount=0),0===this.activeLockCount&&(this.activeUnlockCallback&&(this.activeUnlockCallback(),this.activeUnlockCallback=null),this.finishEditingCallback&&(this.finishEditingCallback(),this.finishEditingCallback=null)))},finishEditing:function(){var t=this,e=a.Deferred();function i(){t._finishEditing?t._finishEditing(e):e.resolve()}return this.activeLockCount>0?this.finishEditingCallback=i:i(),e.promise()},addStateIcon:function(e,i,s){var o=t.htmlBuilder();this.stateIconMessages[e]=s,0===this._findStateIcon(e).length&&(o.markup("<span tabindex='0'").attr("class",i).attr($,e).markup("></span>"),this.stateIcons$.append(o.toString()))},removeStateIcon:function(t){this._findStateIcon(t).remove(),delete this.stateIconMessages[t]},_create:function(){var t=this.options;t.hideDeletedRows&&this.element.addClass(h),this.noData=!0,this.pendingRefresh=null,this.renderInProgress=!1,this.pageOffset=0,this.highWaterMark=0,this.pageCount=0,this.totalRenderedRecords=0,this.pageSize=10,this.onLastPage=!1,this.lastScrollLeft=null,this.lastScrollTop=null,this.scrollPageTimer=null,this.hasScrollFillers=!1,this._scrollHandler=null,this.stateIconMessages={},this.ignoreFieldChange=null,this.reinitCallbacks=null,this.activeRecord=null,this.activeRecordId=null,this.activeLockCount=0,this.activeUnlockCallback=null,this.columnItems=null,this.columnItemsContainer$=null,t.progressOptions||(t.progressOptions={fixed:!t.hasSize}),t.pagination.scroll&&!t.pagination.loadMore&&(t.rowsPerPage=null),t.rowsPerPage&&(this.pageSize=t.rowsPerPage),this._setOption("applyTemplateOptions",t.applyTemplateOptions)},_tableModelViewDestroy:function(){this.footer$&&(this.footer$.remove(),this.footer$=null),this.pageRange$=null,this.pageSelector$=null,this.status$=null,this.stateIcons$=null,this.element.removeClass(h),this._removeScrollHandler()},_refreshCheckIfVisible:function(){return null===this.element[0].offsetParent?(this.pendingRefresh=!0,!1):(this.pendingRefresh=!1,!0)},_initModel:function(i,s){const o=this.options,a=this;let n;let l=!0;if(this.model&&(this.model.unSubscribe(this.modelViewId),l=F(this.modelName)&&F(i)?!t.arrayEqual(this.modelName,i):this.modelName!==i,l&&(e.release(this.modelName),this.model=null,this.modelName=null)),this.modelChanged=l,i){if(l&&(this.modelName=i,this.model=e.get(i),!this.model))throw new Error("Model not found: "+i);this.modelViewId=this.model.subscribe({onChange:s||function(t,e){var i,s,l,r,h,c,d,p,m,_,v;if(!a.pendingRefresh){if("refresh"===t)a.pageOffset=0,a.highWaterMark=0,a.pageCount=0,a.refresh();else if("refreshRecords"===t||"revert"===t)for(s=a._elementsFromRecordIds(e.recordIds),i=0;i<s.length;i++)(l=s[i])&&(r=e.records[i],c=e.recordIds[i],h=e.newIds[c]||c,d=a.model.getRecordMetadata(h),a._replaceRecord(l,r,c,h,d));else if("move"===t)for(_=e.records,e.insertAfterId&&(l=(s=a._elementsFromRecordIds([e.insertAfterId])).length>0?s[0]:null),i=_.length-1;i>=0;i--)r=_[i],h=a.model.getRecordId(r),d=a.model.getRecordMetadata(h),(s=a._elementsFromRecordIds([h])).length>0&&s[0]&&a._removeRecord(s[0]),p=a._insertRecord(l,r,h,d,l?O:y);else if("insert"===t||"copy"===t)if("insert"===t?(v=!1,_=[e.record]):(v=!0,_=e.records),e.insertAfterId&&(l=(s=a._elementsFromRecordIds([e.insertAfterId])).length>0?s[0]:null),a.noData)setTimeout((function(){a.refresh(),(s=a._elementsFromRecordIds([a.model.getRecordId(_[0])])).length>0&&s[0]&&a._afterInsert(s,v)}),1);else{for(m=[],i=_.length-1;i>=0;i--)r=_[i],h=a.model.getRecordId(r),d=a.model.getRecordMetadata(h),p=a._insertRecord(l,r,h,d,l?O:y),m.push(p);a._afterInsert(m,v)}else if("clearChanges"===t){if(n)for(s=a._elementsFromRecordIds(e.deletedIds),i=0;i<s.length;i++)s[i]&&a._removeRecord(s[i]);for(s=a._elementsFromRecordIds(e.changedIds),i=0;i<s.length;i++)(l=s[i])&&(h=e.changedIds[i],d=a.model.getRecordMetadata(h),r=a.model.getRecord(h),a._updateRecordState(l,h,r,d))}else if(e.recordIds){for(s=a._elementsFromRecordIds(e.recordIds),i=0;i<s.length;i++)(l=s[i])&&(h=e.recordIds[i],d=a.model.getRecordMetadata(h),r=e.records[i],"delete"===t?(!o.hideDeletedRows&&n&&null!==d||a._removeFocus(l),n&&null!==d?a._updateRecordState(l,h,r,d):a._removeRecord(l)):a._updateRecordState(l,h,r,d));"delete"===t&&(0===a.model.getTotalRecords()?a.refresh():o.hideDeletedRows&&(a.element.find(g).removeClass(f).removeAttr(u),a._updateStatus()))}else if("set"===t||"metaChange"===t){if(null===a.ignoreFieldChange||a.ignoreFieldChange!==e.field){let i=e.property;r=e.record,h=a.model.getRecordId(r),e.oldIdentity&&a._identityChanged(e.oldIdentity,h),d=a.model.getRecordMetadata(h),(s=a._elementsFromRecordIds([h])).length>0&&s[0]&&("set"===t&&a._updateRecordField(s[0],r,e.field,d),a._updateRecordState(s[0],h,r,d,i))}}else"instanceRename"===t&&a.modelName[1]===e.oldInstance&&(a.modelName[1]=e.newInstance);a._updateTotalRecords()}},progressView:this.element,progressOptions:o.progressOptions}),n=this.model.getOption("onlyMarkForDelete"),this.options.pagination.scroll&&this.scrollParent$&&this.scrollParent$.scrollTop()>this.scrollDelta&&this.scrollParent$.scrollTop(this.scrollDelta),this.pageOffset=0,this.highWaterMark=0,this.pageCount=0}},_renderButton:function(t,e,i,s,o){t.markup(`<button class='${e}' type='button'`).attr("aria-label",s).attr("title",s).optionalAttr("aria-expanded",null==o?null:o?"true":"false").markup("><span aria-hidden='true' class='a-Icon ").attr(i).markup("'></span></button>")},_renderAltDataMessages:function(t,e){const i=this.options;function s(i,s,o,a){t.markup(`<div class='${i} a-GV-altMessage' style='display:none;'><div class='a-GV-altMessage-icon'><span aria-hidden='true' class='a-Icon ${o}'></span></div><span class='a-GV-altMessage-text'`).optionalAttr("id",e?e+s+"_msg":null).markup(`>${a}</span></div>`)}s(n,"_no",i.noDataIcon,i.noDataMessage),s(l,"_more","icon-warning",i.moreDataMessage)},_renderLoadMore:function(t){var e=this.options.pagination;e.scroll&&e.loadMore&&t.markup("<div class='a-GV-loadMore'><button type='button' class='js-load a-GV-loadMoreButton'>").content(V("LOAD_MORE")).markup("</button></div>")},_renderFooter:function(t,e){var i,s,o="a-GV-pageButton a-GV-pageButton--nav ",a=this.options;function n(){var i=V("PAGE_RANGE");t.markup("<span class='js-rangeDisplay'").optionalAttr("id",e?e+"_pageRange":null).attr("title",i).markup("><span class='u-vh'>").content(i).markup("</span> <span class='a-GV-pageRange'></span></span>")}a.footer&&(t.markup("<div class='a-GV-footer'><div class='a-GV-stateIcons'></div><div").optionalAttr("id",e?e+"_status":null).markup(" class='a-GV-status'></div><div class='a-GV-pagination'>"),a.pagination&&(i=!1,s=j(this.model),a.pagination.scroll||(s&&a.pagination.firstAndLastButtons&&this._renderButton(t,o+"js-pg-first","icon-first",V("FIRST_PAGE")),this._renderButton(t,o+"js-pg-prev","icon-prev",V("PREV_PAGE"))),s&&(a.pagination.showPageLinks||a.pagination.showPageSelector)?t.markup("<span class='a-GV-pageSelector'></span>"):a.pagination.showRange&&(n(),i=!0),a.pagination.scroll||(this._renderButton(t,o+"js-pg-next","icon-next",V("NEXT_PAGE")),s&&a.pagination.firstAndLastButtons&&this._renderButton(t,o+"js-pg-last","icon-last",V("LAST_PAGE"))),!i&&a.pagination.showRange&&n()),t.markup("</div></div>"))},_refreshPagination:function(t){let e=this.options,i=e.pagination;this.hasScrollFillers=i.scroll&&i.virtual&&!i.loadMore,this.lastScrollTop=null,this.lastScrollLeft=null,t.length&&(e.hasSize||(t=e.scrollParentOverride?a(e.scrollParentOverride):a(window)),this.lastScrollLeft=t.scrollLeft(),this.lastScrollTop=t.scrollTop())},_paginationHasFocus:function(){var t,e=a(document.activeElement);if(e.closest(".a-GV-footer").length>0){if(e.parent().hasClass("a-GV-pageSelector-item"))return e.parent().attr(w);if(t=/js-pg-\S+/.exec(e.attr("class")))return"."+t[0]}return!1},_restorePaginationFocus:function(t){if(t){let e,i=t;i>=0&&(i=`[data-page='${t}'] button`),e=this.footer$.find(i),e[0]&&e[0].disabled&&(e=this.footer$.find(":focusable").eq(0)),e.trigger("focus")}},_initPagination:function(t,e){let i,s=this.options,o=this.element,n=o.hasClass("u-RTL")?"right":"left";if(this.pageKey=null,i=this.footer$=o.find(".a-GV-footer"),this.status$=i.find(".a-GV-status"),this.stateIcons$=i.find(".a-GV-stateIcons"),this.pageRange$=i.find(".a-GV-pageRange"),this.pageSelector$=i.find(".a-GV-pageSelector"),this.noData$=o.find(".a-GV-noDataMsg"),this.moreData$=o.find(".a-GV-moreDataMsg"),a.ui.tooltip){let t=this.stateIconMessages;this.stateIcons$.tooltip({content:function(){let e=a(this).attr($);return t[e]},items:"[data-state]",show:apex.tooltipManager.defaultShowOption(),tooltipClass:"a-GV-tooltip",position:{my:n+" bottom",at:n+" top-10",collision:"flipfit"}})}if(this._updateScrollHandler(e),s.pagination.scroll&&(this.pageOffset=0,this.highWaterMark=0,this.pageCount=0,this.totalRenderedRecords=0),!s.hasSize&&a.apex.stickyWidget){if(s.stickyTop){let e={stickToEnd:!0,toggleWidth:!0,bottom:()=>o.offset().top+o.outerHeight()-this._footerHeight()};"function"==typeof s.stickyTop&&(e.top=s.stickyTop),t.css("overflow","hidden").stickyWidget(e)}s.footer&&s.stickyFooter&&i.stickyWidget({isFooter:!0,toggleWidth:!0,stickToEnd:!0,top:()=>o.offset().top+this._getHeaderHeight()})}s.pagination.showPageLinks?this.pageSelector$.on("click",(t=>{let e=a(t.target).parent();e.length&&this.gotoPage(E(e.attr(w))),t.preventDefault()})):s.pagination.showPageSelector&&this.pageSelector$.on("change",(t=>{this.gotoPage(E(a(t.target).val()))})),i.find(".js-pg-first").on("click",(()=>{this.firstPage()})),i.find(".js-pg-prev").on("click",(()=>{this.previousPage()})),i.find(".js-pg-next").on("click",(()=>{this.nextPage()})),i.find(".js-pg-last").on("click",(()=>{this.lastPage()})),o.find(".js-load").on("click",(()=>{this.loadMore()}))},_footerHeight:function(){return this.footer$.outerHeight()||0},_addNextPage:function(){if(this.renderInProgress)return!1;let t=this.model.getTotalRecords();return(t<0||this.pageOffset+this.pageCount<t)&&(this.pageOffset+=this.pageCount,this._addPageOfRecords()),!0},_addPageOfRecords:function(t){let e,i,s,o,n,l,h=this._hasControlBreaks(),g=j(this.model),u=this,f=this.options,p=this._getDataRenderContext();function _(t,e,i,s,o){return t>=e||(i.attr(C,t),i.attr(I,e),G(i,t,e,s,o),!1)}function v(t,e,i,s){let o=s||0,n=i-e;return h&&(o=e+o,n=i,e=0,i+=t.filter(".a-GV-controlBreak").length),t.slice(e,i).filter(((t,e)=>{let i=a(e);return i.hasClass("a-GV-controlBreak")&&(t<o&&(o+=1),n+=1),i.hasClass(c)&&(n=t),t>=o&&t<n}))}function R(t,e,i){let s=e,a=o.find(`[data-rownum="${e+1}"]`);return(t&&!B(t)||!a.is(S))&&(s=E(a[i?"nextAll":"prevAll"](".a-GV-row[data-rownum]:visible").first().attr(b))||0),s}if(!this.renderInProgress){if(n=u.noData$.parent().children().not(r),(this.noData||this.moreData$.is(S))&&(this.noData$.hide(),this.moreData$.hide(),n.show(),this.resize()),o=u._getDataContainer(),0!==this.pageOffset&&f.pagination.scroll||(this.pageFirstOffset="",this.pageLastOffset=""),f.pagination.scroll||(this.totalRenderedRecords=0),this.controlBreakCollapsed=!!h&&null,h)if(0!==this.pageOffset&&f.pagination.scroll){let t=this.model.getOption("metaField");if(t){let e=this.pageOffset-1;for(;e>0;){let i,s=this.model.recordAt(e);if(s&&(i=this.model.getValue(s,t),!i.agg)){l=!0===i.endControlBreak;break}e-=1}}}else l=!0;if(e=0,i=this.pageSize,f.pagination.scroll){if(u.hasScrollFillers){o.find(d).each((function(){let t=a(this),e=E(t.attr(C)),s=E(t.attr(I));if(u.pageOffset>=e&&u.pageOffset<s)return i=Math.min(i,s+1-u.pageOffset),!1}))}}else this.pageOffset=H(this.pageOffset,i);s=this.pageOffset,this.renderInProgress=!0,this.model.forEachInPage(this.pageOffset,i,(function(r,b,$,w){if(r){let t,i,s=$?this.model.getRecordMetadata($):{},o=s.serverOffset;h&&!s.agg&&(t=!0,l&&(l=!1,i=this._controlBreakLabel(r),this._renderBreakRecord(p,t,i,o)),s.endControlBreak&&(l=!0)),this._renderRecord(p,r,b,$,s),void 0!==o&&(o+=1,""===this.pageFirstOffset&&(this.pageFirstOffset=o),o>this.pageLastOffset&&(this.pageLastOffset=o)),e+=1}e!==i&&r&&!w||function(i){let l,r,h,b,$,w,T,k=u.avgRowHeight;if(u.pageCount=e,u.totalRenderedRecords+=e,u.pageOffset+e>u.highWaterMark&&(u.highWaterMark=u.pageOffset+e),0===u.pageOffset&&0===e)u.noData=!0,n.hide(),u.moreData$.hide(),u.noData$.show(),u._trigger(A,null,{offset:0,count:0}),f.autoAddRecord&&u.model.allowAdd()&&!i&&u._autoAddRecord();else{if(0===e)return u.renderInProgress=!1,void(f.pagination.scroll||(u.pageOffset-=u.pageSize,u.pageOffset<0&&(u.pageOffset=0),u._addPageOfRecords()));if(u.noData=!1,u.noData$.hide(),u.model.getDataOverflow()&&f.moreDataMessage?(u.moreData$.show(),n.hide()):(u.moreData$.hide(),n.show()),u.hasScrollFillers){l=o.find(d),h=u.model.getTotalRecords(!0)-1,$=h,0===l.length&&g?(r=u._getDataRenderContext(),u._renderFillerRecord(r,c),l=u._insertFiller(r,null),l.attr(C,0),l.attr(I,h),l=l.last()):0===l.last().next().length&&($=E(l.last().attr(I))),h!==$&&l.last().attr(I,h),b=u._getRecordsPerRow();let t=-1,i=!1;if(l.each((function(o){let n,l=!1,h=a(this),d=E(h.last().attr(C)),g=E(h.last().attr(I));if(s===d?(l=_(s+e,g,h,b,k),u._insertData(p,s,e,h,y),t=o,i=!0):s+e<g?(_(s+e,g,h,b,k),r=u._getDataRenderContext(),u._renderFillerRecord(r,c),n=u._insertFiller(r,h),_(d,s-1,n,b,k),u._insertData(p,s,e,h,y),t=o+1,i=!0):s<=g&&s+e>g&&(l=_(d,s-1,h,b,k),u._insertData(p,s,e,h,O),t=o+1,i=!0),i)return l&&(t===o&&(t=o+1),h.remove()),!1})),i||(u._insertData(p,s,e),t=l.length),u.totalRenderedRecords>8*u.pageSize){let e,i,s,a,n,g,p,$=0,y=null,O=0,A=0,M=!1;if(f.fixedRowHeight||(w=o.find(`[data-rownum="${u.pageOffset+1}"]`),w[0]&&(T=w.offset().top)),l=o.find(d),p=l.length-1,A>=t)A=-1,n=2*u.pageSize;else{for(y=l.eq(A);y.next().is(d);)y=y.next();n=E(y.attr(I))}if(n>0&&($=Math.abs(u.pageOffset-R(y,n+1,!0))),$>=3*u.pageSize)A>=0?(a=v(y.nextAll(),0,u.pageSize),O=a.not(".a-GV-controlBreak").length,s=a.first().is(S)&&a.last().is(S),g=a.last().next().filter(d),g.length&&s===B(g)?(e=E(y.attr(C)),i=E(g.attr(I)),_(e,i,g,b,k),y.remove()):s===B(y)?(e=E(y.attr(C)),i=E(y.attr(I))+O,_(e,i,y,b,k)):(e=E(y.attr(I))+1,M=!0)):(e=n,i=e+u.pageSize,a=v(o.children(),e,i),O=a.not(".a-GV-controlBreak").length,s=a.first().is(S)&&a.last().is(S),M=!0),M&&(r=u._getDataRenderContext(),u._renderFillerRecord(r,c),y=u._insertFiller(r,a.eq(0)),_(e,e+O-1,y,b,k),K(y,s));else{let f;if($=0,p<t)p=-1,n=-1,f=o.children().not(m).last(),f.attr(P)&&(n=u.model.indexOf(u.model.getRecord(f.attr(P))),n=H(n,u.pageSize)-u.pageSize);else{for(y=l.eq(p);y.prev().is(d);)y=y.prev();n=E(y.attr(C))}n>0&&($=Math.abs(u.pageOffset+u.pageSize-R(y,n-1,!1))),$>=3*u.pageSize&&(p>=0?(a=v(y.prevAll(),0,u.pageSize),O=a.not(".a-GV-controlBreak").length,s=a.first().is(S)&&a.last().is(S),g=a.prev(d),g.length&&s===B(g)?(e=E(g.attr(C)),i=E(y.attr(I)),_(e,i,g,b,k),y.remove()):s===B(y)?(e=E(y.attr(C))-O,i=E(y.attr(I)),_(e,i,y,b,k)):(e=E(y.attr(C))-O,i=e+O-1,M=!0)):(e=h-n,i=e+u.pageSize,a=v(f.prevAll(),0,i,e),O=a.not(".a-GV-controlBreak").length,O>0&&(s=a.first().is(S)&&a.last().is(S),M=!0,i=n-1,e=n-O)),M&&(r=u._getDataRenderContext(),u._renderFillerRecord(r,c),y=u._insertFiller(r,a.eq(0)),_(e,i,y,b,k),K(y,s)))}O>0&&(a.remove(),u.totalRenderedRecords-=O)}if(!f.fixedRowHeight){let t=0;u._updateAvgRowHeight(),z(u._getDataContainer(),b,u.avgRowHeight),w&&w[0]&&(t=w.offset().top-T),0!==t&&u.scrollParent$.scrollTop(u.scrollParent$.scrollTop()+t)}}else u._insertData(p,s,e)}if(u._updateTotalRecords(),u.renderInProgress=!1,!u.noData&&f.pagination.scroll&&(u.controlBreakCollapsed||!g&&o.height()<u.scrollParent$.height())){let e=u.model.getTotalRecords(),i=u.hasScrollFillers?u.pageOffset+u.pageCount:u.highWaterMark;if(e<0||i<e){let e=!0;if(u.pageOffset=i,u.hasScrollFillers&&(e=!1,l=o.find(d),l.each((function(){if(u.pageOffset===E(a(this).attr(C)))return e=!0,!1}))),e)return void u._addPageOfRecords(t)}}t&&t()}(w)}),this)}},_initPageSize:function(){let e,i,s,o,a=this.options,n=this._getRecordsPerRow();this.hasScrollFillers&&(this.recPerRow!==n&&z(this._getDataContainer(),n,this.avgRowHeight),this._scrollPage()),this.recPerRow=n,this._updateAvgRowHeight(),e=this.avgRowHeight,a.hasSize?i=this.scrollParent$[0].offsetHeight:(i=this.scrollParent$.height(),this.footer$.hasClass("js-stickyWidget-toggle")&&(i-=this._footerHeight()),o=this._getStickyTop(),o>0&&(i-=o+this._getHeaderHeight())),i-=t.getScrollbarSize().height,s=Math.floor(i/e),s<1&&(s=1),this.viewportHeight=s*e,a.rowsPerPage||(a.fixedRowHeight||a.pagination.scroll?(s*=n,a.pagination.scroll?(this.pageSize=Math.max(40,2*s),this.pageSize=Math.ceil(this.pageSize/n)*n):this.pageSize=s):this.pageSize=20)},_updateStatus:function(){var t,e=this._selectedCount(),i="";this.options.hideDeletedRows&&(t=this._deletedCount()),e>0&&(i+=s.format(this._selectedStatusMessage(),e)),t>0&&(i&&(i+=", "),i+=N("DELETED_COUNT",t)+" "),this.status$.text(i)},_setModelValue:function(t,e,i,s,o){var a,n,l,r,h;t&&t.removeClass("is-active"),a=e.getValue(),o||(this.ignoreFieldChange=s),h=this.model.getRecordId(i),null!==(n=this.model.getValue(i,s))&&"object"==typeof n&&M(n,"v")&&(a={v:a,d:e.displayValueFor(a)}),"DUP"===this.model.setValue(i,s,a)?(this._setColumnItemValue(e,i,s),apex.message.alert(V("DUP_REC_ID"))):(l=e.getValidity(),r=this.model.getRecordId(i),l.valid?this.model.setValidity("valid",r,s):this.model.setValidity("error",r,s,e.getValidationMessage()),r!==h&&this._identityChanged(h,r)),o||(this.ignoreFieldChange=null)},_initColumnItems:function(t){let e=!0;this.columnItems={},this.columnItemsContainer$=null,this.asyncColumnItems=[];for(let i=0;i<t.length;i++){let s,a=t[i],n=a.elementId,l=null;n&&(x[n]?(l=this.columnItems[a.property]=x[n],s=l.item):(s=o(n),s.node&&(e=!1,x[n]=l=this.columnItems[a.property]={element$:s.element.closest(".a-GV-columnItem"),item:s},s.whenReady&&this.asyncColumnItems.push(s.whenReady()))),l&&!this.columnItemsContainer$&&(this.columnItemsContainer$=l.element$.parent()))}this.columnItemsContainer$?e||this.columnItemsContainer$.find(R).addClass(v).attr("tabindex",-1):this.editable&&i.error(`An editable ${this.widgetName} must have at least one column with a column item.`)},_waitForColumnItems:function(){return a.when(...this.asyncColumnItems)},_activateColumnItem:function(t,e){var i=t.element$;i.find(".js-tabbable").attr("tabindex",0).removeClass(v),e&&(a("label[id='"+e+"']").length||i.find(R).first().attr(_,e))},_deactivateColumnItem:function(t){var e=t.element$,i=e.find(R);i.first().removeAttr(_),this.columnItemsContainer$.append(e),i.addClass(v).attr("tabindex",-1)},_renderFieldDataValue:function(e,i,s,o,a){var n,l,r,h=null,c=this.options;(a&&a.url||i.linkTargetColumn)&&!o.agg&&(h=i.linkTargetColumn?this.model.getValue(s,i.linkTargetColumn)||null:a.url),n=this.model.getValue(s,i.property),(o.agg||o.inserted&&i.readonly)&&this.model.isIdentityField(i.property)&&(n=""),(i.linkText||i.linkAttributes||i.cellTemplate)&&((l=this.atOptions).model=this.model,l.record=s),h&&(e.markup("<a").attr("href",h),i.linkAttributes&&e.markup(L(i.linkAttributes,l)),e.markup(" tabindex='-1'>")),h&&i.linkText?e.markup(L(i.linkText,l)):i.cellTemplate?o.agg?(n=null==n?"":n,e.content(""+n)):(n=L(i.cellTemplate,l),c.highlighter&&(n=c.highlighter(c.highlighterContext,n,i)),e.markup(n)):null!==n&&""!==n||!(c.showNullAs||o.agg||h)?(null===n&&(n=""),"object"==typeof n&&M(n,"d")?n=n.d:(r=this.columnItems[i.property])&&(n=r.item.displayValueFor(n,{readonly:a&&!!a.ck||i.readonly||o.deleted||!1,disabled:a&&a.disabled||!1})),!1!==i.escape&&(n=t.escapeHTML(""+n)),c.highlighter&&(n=c.highlighter(c.highlighterContext,n,i)),e.markup(n)):(n=o.agg||o.inserted||a&&(a.changed||a.error||a.warning)?"":h||c.showNullAs,e.content(n)),h&&e.markup("</a>")},_beginSetColumnItems:function(){this.reinitCallbacks=[]},_setColumnItemValue:function(t,e,i,s){var o,a=null,n=this.model.getValue(e,i);null!==n&&"object"==typeof n&&M(n,"d")&&(a=n.d,n=n.v),this.reinitCallbacks?(o=t.reinit(n,a))&&this.reinitCallbacks.push(o):t.setValue(n,a),s&&(s.fields&&s.fields[i]&&s.fields[i].disabled?t.disable():t.enable())},_endSetColumnItems:function(){var t,e=this.reinitCallbacks;if(e)for(t=0;t<e.length;t++)e[t]();this.reinitCallbacks=null},_autoAddRecord:function(t){var e=this.model.insertNewRecord(null,t);this.model.getRecordMetadata(e).autoInserted=!0},_triggerBeginEditing:function(t,e){this.element.trigger("apexbeginrecordedit",[{model:this.model,record:t,recordId:e}])},_triggerEndEditing:function(t,e){this.element.trigger("apexendrecordedit",[{model:this.model,record:t,recordId:e}])},_updateHighlights:function(){let t=this.options,e=[],i="";for(const[i,s]of D(t.highlights))s.id=i,e.push(s);e.sort(((t,e)=>e.seq-t.seq));for(let t=0;t<e.length;t++){let s=e[t];s.cssClass||(s.cssClass=(s.row?"hlr_":"hlc_")+s.id),(s.color||s.background)&&(s.row?i+="."+s.cssClass+" td":i+="td."+s.cssClass,i+=" { ",s.color&&(i+="color: "+s.color+" !important; "),s.background&&(i+="background-color: "+s.background+" !important; "),i+="}\n")}!this.gridStyles$&&i&&(this.gridStyles$=a("<style></style>"),a("head").append(this.gridStyles$)),this.gridStyles$&&(this.gridStyles$=this.gridStyles$.text(i))},_findStateIcon:function(t){return this.stateIcons$.find(`[data-state='${t}']`)},_setOption:function(t,e){var s=this.options;this._super(t,e),"noDataMessage"===t?this.element.find(".a-GV-altMessage > .a-GV-altMessage-text").text(e):"noDataIcon"===t?this.element.find(".a-GV-altMessage > .a-GV-altMessage-icon span").attr("class","a-Icon "+e):"rowsPerPage"===t?(s.pagination.scroll&&!s.pagination.loadMore&&(i.warn("Ignoring rowsPerPage when scroll pagination."),s.rowsPerPage=null),s.rowsPerPage&&(this.pageSize=s.rowsPerPage)):"hideDeletedRows"===t?(this.element.toggleClass(h,e),!0===e&&this.element.find(g).removeClass(f).removeAttr(u),this._updateStatus()):"scrollParentOverride"===t?s.hasSize?i.warn("Ignoring scrollParentOverride when hasSize is true."):this._updateScrollHandler():"applyTemplateOptions"===t&&(this.atOptions=a.extend(!0,{},s.applyTemplateOptions||{},{extraSubstitutions:{}}))},_updateScrollHandler:function(t){let e=this.options,i=this.scrollParent$,s=e.scrollParentOverride;e.hasSize?(this.scrollParent$=t,this.scrollDelta=0):(this.scrollParent$=a(s||window),this.scrollDelta=this.element.offset().top-this._getStickyTop()),this.totalRenderedRecords=0,e.pagination.scroll&&!e.pagination.loadMore&&(i&&this._scrollHandler?i.off("scroll",this._scrollHandler):this._scrollHandler=()=>{this.element[0].clientWidth>0&&this._scrollPage()},this.scrollParent$.on("scroll",this._scrollHandler))},_removeScrollHandler:function(){this._scrollHandler&&(this.scrollParent$.off("scroll",this._scrollHandler),this._scrollHandler=null)},_scrollPage:function(){var t=this,e=this.scrollParent$.scrollTop();e!==this.lastScrollTop&&(this.lastScrollTop=e,this.scrollPageTimer||(this.scrollPageTimer=setTimeout((function(){let e,i,s,o,n,l,r,h,c=null,g=!1,u=j(t.model),f=t.scrollParent$[0]===window,p=t.avgRowHeight;if(t.scrollPageTimer=null,t.renderInProgress)return t.lastScrollTop=null,void t._scrollPage();if(o=t.scrollParent$.height(),n=0-o/2,o*=2,l=n+o,e=t._getDataContainer(),i=t.scrollParent$.scrollTop(),t.hasScrollFillers&&(c=e.find(d),!c.length&&u&&t._removeScrollHandler(),s=t.pageOffset,h="TBODY"===e[0].nodeName,c.each((function(){var e,r,c=a(this),d=E(this.style.height),u=E(c.attr(C)),m=E(c.attr(I));if(u!==m)return r=f?c.offset().top:c.position().top,(f||h||c.offsetParent().closest(t.scrollParent$).length>0)&&(r-=i),e=r+d,r<=l&&e>=n?(t.pageOffset=d<2*o||r>n?u:H(e<l?m:u+Math.ceil((n+o/2-r)*t._getRecordsPerRow()/p),t.pageSize),t.pageOffset!==s&&t._addPageOfRecords(),g=!0,B(c)||K(c,!0),!1):void 0}))),!(g||u&&t.hasScrollFillers)){let s=e.height();(f||e.offsetParent().closest(t.scrollParent$).length>0)&&(s+=f?e.offset().top:e.position().top),s-=i,s>0&&s<=1.5*o&&(r=t.model.getTotalRecords(),r<0||t.highWaterMark<r?(t.pageOffset=t.highWaterMark,t._addPageOfRecords()):(c&&0===c.length||!c&&r===t.totalRenderedRecords)&&t._removeScrollHandler())}}),300)))},_updateTotalRecords:function(){var t,e,i,s,o,n,l,r,h=null,c=null,d=this.options,g=this.footer$,u=this.pageSelector$,m=d.pagination,_=this.model.getTotalRecords(),v=this.model.getServerTotalRecords();if(_>=0&&(h=Math.ceil(_/this.pageSize),c=Math.floor(this.pageOffset/this.pageSize)),null!==this.lastScrollLeft&&(this.scrollParent$.scrollLeft(this.lastScrollLeft),this.scrollParent$.scrollTop(this.lastScrollTop),this.lastScrollLeft=null,this.lastScrollTop=null),this.onLastPage=!1,0===this.pageCount&&0===this.pageOffset?(s="",this.onLastPage=!0,g.find(k).attr(T,!0)):(g.find(k).attr(T,!1),this.element.find(".js-load").attr(T,!1),0===this.pageOffset&&g.find(".js-pg-prev,.js-pg-first").attr(T,!0),_>0&&c===h-1&&(this.onLastPage=!0,g.find(".js-pg-next,.js-pg-last").attr(T,!0),this.element.find(".js-load").attr(T,!0)),l=j(this.model),s=m.scroll&&m.virtual&&!m.loadMore&&l?N("TOTAL_PAGES",v):l?m.hideSinglePage&&1===h?N("TOTAL_PAGES",v):N("PAGE_RANGE_XYZ",this.pageFirstOffset,this.pageLastOffset,v):N("PAGE_RANGE_XY",this.pageFirstOffset,this.pageLastOffset)),document.activeElement&&document.activeElement.disabled&&a(document.activeElement).hasClass("js-load")&&this.focus(),this.pageRange$&&this.pageRange$.text(s),h>0){if(m.showPageLinks){if(n=`${_}_${this.pageSize}_${c}`,this.pageKey!==n){for(r="<li class='a-GV-pageSelector-item'>&hellip;</li>",this.pageKey=n,o="<ul class='a-GV-pageSelector-list'>",(e=c-Math.floor(m.maxLinks/2))<0&&(e=0),(i=e+m.maxLinks)>=h&&(e=(i=h)-m.maxLinks)<0&&(e=0),e>0&&(o+=r),t=e;t<i;t++)o+=`<li class='a-GV-pageSelector-item' data-page='${t}'><button class='a-GV-pageButton' type='button'>${t+1}</button></li>`;i<h&&(o+=r),o+="</ul>",u.html(o)}u.find(p).removeClass(f),u.find(`[data-page='${c}']`).addClass(f)}else if(m.showPageSelector){if(n=`${_}_${this.pageSize}`,this.pageKey!==n){for(this.pageKey=n,o=`<select class='a-GV-pageSelectlist' size='1' aria-label='${V("PAGE_SELECTION")}'>`,t=0;t<h;t++)o+=`<option value='${t}'>${N("SELECT_PAGE_N",t+1)}</option>`;o+="</select>",u.html(o)}u.children("select").val(c)}}else u.empty(),this.pageKey=null;m.hideSinglePage&&!m.scroll&&(g.find(k).add(u)[1===h?"hide":"show"](),g.find(".js-rangeDisplay")[l?"show":"hide"]()),g[this.noData&&d.hideEmptyFooter?"hide":"show"]()},_updateAvgRowHeight:function(){let t;if(this.options.fixedRowHeight)t=this._getFixedRecordHeight();else{let e,i=this._getRecordsPerRow(),s=Math.ceil(this.totalRenderedRecords/i);s<=0?t=this.avgRowHeight||this._getFixedRecordHeight():(e=this._getDataContainer().height(),this._getDataContainer().find(d).each((function(){e-=a(this).height()})),t=e/s)}t<=0&&(t=43),this.avgRowHeight=t},_getStickyTop:function(){let t=this.options.stickyTop;return"function"==typeof t?t():0},_getHeaderHeight:function(){return 0},_getRecordsPerRow:function(){return 1},_getDataRenderContext:function(){return t.htmlBuilder()},_selectedCount:function(){return 0},_selectedStatusMessage:function(){return s.getMessage(this.options.selectionStatusMessageKey)},_deletedCount:function(){return 0},_hasControlBreaks:function(){return!1},_elementsFromRecordIds:function(){return[]},_renderFillerRecord:function(){},_insertFiller:function(){return a()},_insertData:function(t,e,i){this._trigger(A,null,{offset:e,count:i})},_controlBreakLabel:function(){return{}},_renderBreakRecord:function(t,e,i){t.markup("<h3>").content(i.label).markup("</h3>")},_renderRecord:function(){},_removeRecord:function(){},_insertRecord:function(){return a()},_afterInsert:function(){},_identityChanged:function(){},_replaceRecord:function(){},_updateRecordField:function(){},_removeFocus:function(){},_updateRecordState:function(){}});const W="a-TMV",X="a-TMV--variableHeight",U="a-TMV-w-scroll",q=".a-TMV-w-scroll",Y=".a-TMV-hdr",Q="is-disabled",Z="set",J="unset",tt="toggle",et="range",it="add",st="selectionChange",ot=".u-selector",at="is-focused",nt="aria-selected",lt="aria-multiselectable",rt="tabindex",ht="u-RTL",ct=a.ui.keyCode,dt=/^\s*<[\w]+[^>]*>/,gt=/<([^ <>]*)/,ut="none",ft="selection",pt="focus";function mt(t){t.APEX$ROW_STATE_CLASSES=t.APEX$AGG=t.APEX$AGG_TOTAL=t.APEX$ROW_URL=t.APEX$ROW_ID=t.APEX$ROW_INDEX=t.APEX$VALIDATION_MESSAGE=null}function _t(t){return[ut,pt,ft].includes(t)||(i.warn("Invalid value for itemNavigation ignored"),t="none"),t}a.widget("apex.tableModelView",a.apex.tableModelViewBase,{version:"21.1",widgetEventPrefix:"tableModelView",options:{headerTemplate:"",beforeTemplate:"<ul>",recordTemplate:"",controlBreakTemplate:"",aggregateTemplate:"",afterTemplate:"</ul>",syncHeaderHScroll:!1,collectionClasses:null,iconClassColumn:null,imageURLColumn:null,imageAttributes:null,labelColumn:null,linkTarget:!1,linkTargetColumn:null,linkAttributes:null,tabbableContent:null,useIconList:!1,iconListOptions:{},itemNavigation:ut,itemSelector:null,multiple:!1,constrainNavigation:!0,sortable:!1,selectionChange:null,pageChange:null,rowOrderChanged:null},_create:function(){const e=this.options,s=this.element;i.info(`TableModelView '${s[0].id}' created. Model: ${e.modelName}`),s.addClass(W),e.fixedRowHeight||s.addClass(X),e.itemNavigation=_t(e.itemNavigation),e.itemNavigation===ft&&e.multiple&&s.attr(lt,"true"),this.forwardKey=ct.RIGHT,this.backwardKey=ct.LEFT,"rtl"===s.css("direction")&&(s.addClass(ht),this.forwardKey=ct.LEFT,this.backwardKey=ct.RIGHT),this._enforceOptionConstraints(),this._super(),this.recordHeight=null,this.recPerRow=null,this.lastFocused=null,this.hasSelection=!1,this._initModel(e.modelName),this._on(this._eventHandlers),this._initRecordTemplate(),this._selNotifyDelay=t.debounce(this._selChangeNotify,1),this._selNotifyLongDelay=t.debounce(this._selChangeNotify,350),this.refresh(),e.disabled&&this._setOption("disabled",e.disabled)},_eventHandlers:{keydown:function(t){const e=this.options;let i,s=!1,o=a(t.target),n=null,l=t.which;if(!t.isDefaultPrevented())if(e.useIconList){if(i=this.getIconList().options,!i.navigation&&i.noNavKeyContent&&a(t.target).closest(i.noNavKeyContent).length)return;l!==ct.DOWN&&l!==this.getIconList().forwardKey||!e.pagination.loadMore?(l===ct.UP||l===this.getIconList().backwardKey)&&e.pagination.loadMore&&a(t.target).hasClass("js-load")&&(this.getIconList().trigger("focus"),t.preventDefault()):this.element.find(".js-load").not(":disabled").trigger("focus")[0]&&t.preventDefault(),!e.constrainNavigation||l!==ct.DOWN&&l!==ct.UP&&l!==ct.LEFT&&l!==ct.RIGHT&&l!==ct.PAGE_UP&&l!==ct.PAGE_DOWN||t.preventDefault()}else if(e.itemNavigation!==ut){if(l===ct.HOME)this._navToReportStart(t,!0),s=!0;else if(l===ct.END)this._navToReportEnd(t,!0),s=!0;else if(l===ct.DOWN||l===this.forwardKey){if(l===this.forwardKey&&t.altKey)return;n=this._getItem(a(this.lastFocused)).nextAll(S).first(),n&&n[0]||!e.pagination.loadMore||this.element.find(".js-load").trigger("focus")[0]&&(s=!0),l===ct.DOWN&&e.constrainNavigation&&(s=!0)}else if(l===ct.UP||l===this.backwardKey){if(l===this.forwardKey&&(t.altKey||t.metaKey))return;o.hasClass("js-load")?(this.focus(),s=!0):n=this._getItem(a(this.lastFocused)).prevAll(S).first(),l===ct.UP&&t.stopPropagation()}else if(l===ct.SPACE){if("BUTTON"===t.target.nodeName)return;n=this._getItem(a(this.lastFocused))}n&&n[0]&&(e.itemNavigation===ft?this._select(n,t,!0,!0):a(this._getItemFocusable(n)).trigger("focus"),s=!0),s&&t.preventDefault()}},keyup:function(t){let e=this.options.sortable,i=t.which;!e||91!==i&&17!==i||this.element.trigger("sortUpdate")},mousedown:function(t){const e=this.options;if(e.itemNavigation===ft&&(e.sortable||e.multiple)){let i=this._getItem(a(t.target));if(i&&i.length>0&&(t.preventDefault(),e.sortable)){let e={type:"click",shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,metaKey:t.metaKey};this._select(i,e,!0,!1,!1)}}},resize:function(t){t.target===this.element[0]&&(this.resize(),t.stopPropagation())},click:function(t){const e=this.options;if(e.itemNavigation===ft){let i=a(t.target),s=this._getItem(i);s&&s.length>0&&(i.is(ot)&&(t.ctrlKey=!0,t.shiftKey=!1),this._select(s,t,!0,!1,!1),e.tabbableContent&&i.closest(e.tabbableContent).length?i.trigger("focus"):t.preventDefault())}},sortUpdate:function(t){let e=a(t.target);this.options.rowOrderChanged&&this._trigger("rowOrderChanged"),e.trigger("focus")},focusin:function(t){if(this.options.itemNavigation!==ut){let e=t.target,i=this._getItem(a(e));i&&i.length>0&&(i.addClass(at),this._setFocusable(e))}},focusout:function(t){if(this.options.itemNavigation!==ut){let e=this._getItem(a(t.target));e&&e.length>0&&e.removeClass(at)}}},_destroy:function(){const t=this.element;this._tableModelViewDestroy(),t.removeClass("a-TMV is-disabled u-RTL").removeAttr(lt).empty(),i.info(`TableModelView '${t[0].id}' destroyed. Model: ${this.options.modelName}`),this.data$=null,this._initModel(null)},_setOption:function(t,e){const s=this.element,o=this.options;if(i.info(`TabelModelView '${this.element[0].id}' set option '${t}' to: ${e}`),"iconListOptions"===t)throw new Error(`TabelModelView '${t}' cannot be set. Set options directly on the iconList widget`);if("itemNavigation"===t&&(e=_t(e)),this._super(t,e),this._enforceOptionConstraints(),"disabled"===t){if(this.element.toggleClass(Q,e),o.useIconList)return this.getIconList().option(t,e);this.lastFocused&&(e?this.lastFocused.tabIndex=-1:this._setFocusable(this.lastFocused)),e&&this.resize()}else"modelName"===t?(this._initModel(e),this.refresh(!1)):"highlights"===t?this._updateHighlights():"hideEmptyFooter"===t?this._updateTotalRecords():"multiple"===t||"itemNavigation"===t?(o.itemNavigation===ft&&o.multiple?s.attr(lt,"true"):s.removeAttr(lt),this._initRecordTemplate(),this.refresh()):"fixedRowHeight"===t?(this.element.toggleClass(X,!e),this.refresh()):["beforeTemplate","recordTemplate","afterTemplate","collectionClasses","iconClassColumn","imageURLColumn","imageAttributes","itemSelector","labelColumn","linkTarget","linkTargetColumn","linkAttributes"].includes(t)?(this._initRecordTemplate(),this.refresh()):["footer","useIconList","pagination","rowsPerPage","sortable"].includes(t)&&this.refresh()},_enforceOptionConstraints:function(){const t=this.options;t.useIconList&&t.itemNavigation!==ut&&(i.warn("Forced itemNavigation to none when useIconList is true"),t.itemNavigation=ut),t.itemNavigation!==ft&&t.persistSelection&&(i.warn("Forced persistSelection to false when itemNavigation is not selection"),t.persistSelection=!1)},refresh:function(t){const e=this.options,i=this,s=this.element;let o,n,l=!1;if(!0!==t&&(l=this._paginationHasFocus()),void 0===t&&(t=a(document.activeElement).closest(s).length>0),!this._refreshCheckIfVisible())return;let r=this.modelChanged;this.modelChanged=!1,this.data$&&!e.persistSelection?o=this.getSelectedRecords():e.persistSelection&&(n=this.hasSelection,this.hasSelection=!1),!e.hasSize&&this.data$&&s.css("min-height",s.height()+"px"),this._refreshPagination(s.find(q)),this._initView(),e.sortable&&this.data$.sortable({placeholder:"sortable-placeholder",cursor:"move",cursorAt:{left:2},stop:function(){s.trigger("sortUpdate")}}),this._updateStatus(),this.resize(),this._addPageOfRecords((function(){let h,c=!1;l&&(i._restorePaginationFocus(l),t=!1),e.hasSize||s.css("min-height",""),e.itemNavigation===ut||i.lastFocused||(i.lastFocused=i._getItemFocusable(i.data$.children(e.itemSelector)),i.lastFocused&&e.itemNavigation===ft&&(i.selectAnchor=a(i.lastFocused).closest(e.itemSelector)[0]),i.lastFocused&&!e.disabled&&(h=i.lastFocused,i._setFocusable(i.lastFocused))),o&&o.length>0?(c=i.setSelectedRecords(o,!1,!0)>0,c&&!r||i._selNotifyDelay(!0,null)):e.persistSelection&&(n||r)&&i._selNotifyDelay(!0,null),h&&c&&i._setFocusable(h),t&&i.focus(),e.sortable&&i.data$.sortable("refresh")}))},resize:function(){var t,e,i=this.element,s=this.options,o=i.height(),a=i.children().first(),n=i.find(q);null!==i[0].offsetParent&&(a.length&&!this.pendingRefresh?(t=i.width(),n.width(t),this.recordHeight=null,this.recPerRow=null,s.hasSize&&(e=o-this._footerHeight(),a.height(e),n.height(e-(i.find(Y).height()||0))),s.useIconList&&this.data$.iconList("resize"),this._initPageSize()):this.refresh())},focus:function(){const t=this.getIconList();if(t)return t.focus();this.options.itemNavigation!==ut&&this.lastFocused?this.lastFocused.focus():this.data$.find(":focusable").first().trigger("focus")},getSelection:function(){const t=this.options,e=this.getIconList();return t.useIconList?e?e.getSelection():a():this.data$&&t.itemNavigation===ft?this.data$.find(p):null},setSelection:function(t,e,i){const s=this.getIconList();s?s.setSelection(t,e,i):this.data$&&this.options.itemNavigation===ft&&this._select(t,null,e,!1,i)},getRecords:function(t){let e=this.model,i=[];return t.each((function(){let t,s=a(this).attr(P);s&&(t=e.getRecord(s),t&&i.push(t))})),i},getSelectedRecords:function(){const t=this.options;return this.data$&&(t.useIconList||t.itemNavigation===ft)?this.getRecords(this.getSelection()):null},setSelectedRecords:function(t,e,i){const s=this.options;let o=[],n=0,l=t.length,r=new Set;if(!this.data$||this.renderInProgress||s.itemNavigation!==ft&&!s.useIconList)return-1;!s.multiple&&l>1&&(l=1);for(let e=0;e<l;e++)r.add(this.model.getRecordId(t[e]));if(this.data$.children().each((function(){let t=a(this).attr(P);r.has(t)&&(r.delete(t),o.push(this),n+=1)})),this.setSelection(a(o),e,i),s.persistSelection){for(let t of r){this.model.getRecord(t)&&(this.model.setSelectionState(t,!0),n+=1)}0!==o.length||i||this._selNotifyDelay(!0,null)}return n},getIconList:function(){return this.options.useIconList&&this.data$?this.data$.data("apex-iconList"):null},_getItem:function(t){let e=this.options.itemSelector;return e?t.closest(e):null},_initRecordTemplate:function(){const t=this.options;if(!t.recordTemplate){let e,i,s;if(t.collectionClasses||(t.collectionClasses="a-TMV-defaultIconView"),t.itemSelector||(t.itemSelector=".a-TMV-item"),!t.labelColumn)throw new Error("Option recordTemplate or labelColumn is required");t.beforeTemplate="<ul>",t.afterTemplate="</ul>",e="<li data-id='&APEX$ROW_ID.' data-rownum='&APEX$ROW_INDEX.' class='a-TMV-item &APEX$ROW_STATE_CLASSES.'>",t.linkTarget||t.linkTargetColumn?(s=t.linkTargetColumn?t.linkTargetColumn:"APEX$ROW_URL",e+=`<a href='&${s}.' class='a-IconList-content' ${t.linkAttributes?t.linkAttributes:""}>`,i="</a>"):(e+="<span class='a-IconList-content'>",i="</span>"),(t.iconClassColumn||t.imageURLColumn)&&(e+="<span class='a-IconList-icon'>",t.iconClassColumn?e+=`<span class='&${t.iconClassColumn}.'></span>`:e+=`<img src='&${t.imageURLColumn}.' ${t.imageAttributes?t.imageAttributes:""}/>`,e+="</span>"),e+=`<span class='a-IconList-label'>&${t.labelColumn}.</span>${i}</li>`,t.recordTemplate=e}t.itemNavigation===ut||t.itemSelector||(i.warn("Forced itemNavigation to none because itemSelector not defined"),t.itemNavigation=ut);let e=this.atOptions;e.model=this.model,e.record=null,mt(e.extraSubstitutions),dt.exec(L(t.recordTemplate,e))||(L(t.beforeTemplate,e).toLowerCase().match(/<ul|<ol/)?t.recordTemplate=`<li>${t.recordTemplate}</li>`:t.recordTemplate=`<div>${t.recordTemplate}</div>`)},_initView:function(){var e,i,s,o,a=this,n=this.element,l=this.options,r=0,h=0,c=null,d="scroll.tmvss",g=this._getDataRenderContext(),u=this.atOptions,f=u.extraSubstitutions;function p(){r!==h&&(s[0].scrollLeft=r=h,o[0].scrollLeft=r,i.css("left",r)),c=null}u.model=this.model,u.record=null,mt(f),this.recordElement="div",(e=gt.exec(L(l.recordTemplate,u)))&&e.length>1&&(this.recordElement=e[1].toLowerCase()),g.markup("<div").attr("class","a-TMV-body").markup(">"),this._renderAltDataMessages(g);let m=[];for(const[,t]of D(this.model.getOption("fields")))m.push(t);m.sort(((t,e)=>t.seq-e.seq)),f.APEX$COLUMNS=m,l.headerTemplate&&g.markup(`<div class='a-TMV-hdr'>${L(l.headerTemplate,u)}</div>`),g.markup("<div").attr("class",U).markup(" tabindex='-1'>").markup(L(l.beforeTemplate,u)).markup(`<${this.recordElement} class='js-data-placeholder' style='display:none;'></${this.recordElement}>`).markup(L(l.afterTemplate,u)),this._renderLoadMore(g),g.markup("</div></div>"),this._renderFooter(g),n.html(g.toString()),this.data$=n.find(".js-data-placeholder").parent(),this.data$.empty().addClass(l.collectionClasses||""),this._clearItemCache(),l.useIconList&&(this.data$.iconList(l.iconListOptions),this.data$.on("iconlistselectionchange",(function(t){a._updateStatus(),a._trigger(st,t)}))),o=n.find(q),s=n.find(Y),this._initPagination(s,n.find(q)),l.headerTemplate&&l.syncHeaderHScroll&&(i=this.data$.find(".a-GV-loadMoreButton"),o.on(d,(function(){h=this.scrollLeft,c||(c=t.invokeAfterPaint(p))})),s.on(d,(function(){h=this.scrollLeft,c||(c=t.invokeAfterPaint(p))})))},_setFocusable:function(t){const e=this.options.tabbableContent;let i,s;this.lastFocused&&this.lastFocused!==t&&(e?(s=this._getItem(a(this.lastFocused)),s.add(s.find(e).not(":disabled")).prop("tabIndex",-1)):this.lastFocused.tabIndex=-1),e?(s=this._getItem(a(t)),i=s.find(e).not("disabled").prop("tabIndex",0).length,i||s.prop("tabIndex",0)):t.tabIndex=0,this.lastFocused=t},_getItemFocusable:function(t){const e=this.options.tabbableContent;if(e){let i=t.find(e);if(i.length)return i[0]}return t[0]},_initRecordMetrics:function(){let t,e,i=0,s=this.options;if(mt(this.atOptions.extraSubstitutions),this.atOptions.record=null,this.recPerRow=1,t=this.data$.children().filter(S).first(),!t.length){let i,o="";for(i=0;i<20;i++)o+=L(s.recordTemplate,this.atOptions);e=a(o),t=this.data$.append(e).children().filter(S).first(),s.useIconList&&this.getIconList().refresh()}if(s.useIconList)this.recPerRow=this.getIconList().getColumns();else{let e=t,s=e.length>0?Math.trunc(e.offset().top):0,o=s,a=0;for(;o===s&&e[0];)a+=1,e=e.next(),e[0]&&(o=Math.trunc(e.offset().top));this.recPerRow=a,i=o-s}this.recPerRow<1&&(this.recPerRow=1),0===i&&(i=t.outerHeight(!0),"grid"===this.data$.css("display")&&(i+=E(this.data$.css("grid-row-gap")))),this.recordHeight=i||43,e&&e.remove()},_clearItemCache:function(){this.itemsCache$=null},_itemIndex:function(t){let e;return this.itemsCache$||(this.itemsCache$=this.data$.children()),e=this.itemsCache$,e.index(t)},_navToReportStart(t,e){const i=this.options,s=i.itemNavigation===ft;t.ctrlKey=!1,i.pagination.scroll&&this.firstPage();let o=this.data$.children(i.itemSelector).filter(S).first();o[0]&&(s?this._select(o,t,!0,e):a(this._getItemFocusable(o)).trigger("focus"))},_navToReportEnd:function(t,e){const i=this.options,s=i.itemNavigation===ft,o=()=>{s?this._select(n,{type:"keydown",shiftKey:t.shiftKey},!0,e):a(this._getItemFocusable(n)).trigger("focus")};t.ctrlKey=!1,i.pagination.scroll&&this.lastPage();let n=this.data$.children(S).last();n.hasClass(c)?(n=null,this.element.one("tablemodelviewpagechange",(()=>{n=this.data$.children(i.itemSelector).filter(S).last(),o()}))):(n=n.filter(i.itemSelector).last(),o())},_select:function(e,i,s,o,n){const l=this.options;let r,h,c,g,u,m,_,v=!1,R=null,C=Z;const I=(t,e)=>{const i=t=>{t.each(((t,i)=>{let s=a(i).attr(P);s&&this.model.setSelectionState(s,e,C)}))};l.persistSelection&&!v&&(i(t),C!==tt&&t.length>1&&i(c.first()))};if(i!==J&&(e=e.filter(S)),i&&l.multiple&&("string"==typeof i?C=i:"click"===i.type?i.ctrlKey||i.metaKey?C=tt:i.shiftKey&&(C=et):"keydown"===i.type&&(i.which===ct.SPACE?C=i.ctrlKey?tt:i.shiftKey?et:it:i.ctrlKey?C="none":i.shiftKey&&(C=et)),i.target||(i=null)),l.persistSelection&&(m=this.model.getSelectionState().rangeAnchor),"all"===C?(v=!0,C=Z):C!==et||this.selectAnchor||m||(C=Z),C!==Z&&C!==et||(_=this.data$.find(p),_.removeClass(f).removeAttr(nt).find(ot).removeClass(f),l.persistSelection&&this.model.clearSelection()),l.persistSelection&&v&&this.model.setSelectionState(null,!0,"all"),r=e.hasClass(f),c=e,C===Z||C===it||C===tt&&!r)c.addClass(f).attr(nt,!0),I(c,!0),this.selectAnchor=c[0],R=!0;else if(C===et){let t,i,s,o,n=a(this.selectAnchor),r=e.last();if(t=this._itemIndex(n),l.persistSelection){let e=this.model.getRecordMetadata(m);e&&e.serverOffset&&(o=e.serverOffset+1,o!==E(n.attr(b))&&(t=-1))}if(i=this._itemIndex(r),t<0){let e=o||E(n.attr(b)),i=E(r.attr(b));if(l.pagination.virtual){let s=this.data$.find(d).toArray();if(i>e)for(let t=0;t<s.length&&(n=a(s[t]).next(),!(E(n.attr(b))>e));t++);else for(let t=s.length-1;t>=0&&(n=a(s[t]).prev(),!(E(n.attr(b))<e));t--);t=this._itemIndex(n)}else!l.pagination.scroll&&l.persistSelection&&(n=this.itemsCache$[i>e?"first":"last"](),t=this._itemIndex(n))}l.persistSelection&&I(r,!0),t>i&&(s=i,i=t,t=s),i+=1,g=[],this.itemsCache$.slice(t,i).each((function(t,e){a(e).is(S)&&g.push(e)})),c=a(g),c.addClass(f).attr(nt,!0),R=!0}else(C===tt&&r||C===J)&&(c.removeClass(f).removeAttr(nt),I(c,!1),this.selectAnchor=c[0],R=!1);null!==R&&c.find(ot).toggleClass(f,R),l.multiple&&l.selectAll&&this._updateSelectAll(),e.length>0&&null!==s&&(h=this._getItemFocusable(e.first()),s?a(h).trigger("focus"):this._setFocusable(h)),l.persistSelection&&(this.hasSelection=this.model.getSelectedCount()>0),(C===tt||C===J||C===et&&!r||C===it||C===Z&&!t.arrayEqual(_,c))&&(u=!(n||l.navigation&&i&&"click"===i.type),o?this._selNotifyLongDelay(u,i):this._selNotifyDelay(u,i))},_selChangeNotify:function(t,e){this.element.hasClass(W)&&(this._updateStatus(),t&&this._trigger(st,e))},_getHeaderHeight:function(){return this.element.find(Y).outerHeight()},_getFixedRecordHeight:function(){return this.recordHeight||this._initRecordMetrics(),this.recordHeight},_getRecordsPerRow:function(){return this.recPerRow||this._initRecordMetrics(),this.recPerRow},_getDataContainer:function(){return this.data$},_selectedCount:function(){let t=this.options;return t.useIconList?this.getIconList().getSelection().length:t.itemNavigation===ft?this.getSelectedRecords().length:0},_hasControlBreaks:function(){return null!=this.options.controlBreakTemplate},_elementsFromRecordIds:function(e){let i=[];for(let s=0;s<e.length;s++){let o=this.data$[0].querySelector(`[data-id="${t.escapeCSS(e[s])}"]`);o&&i.push(a(o))}return i},_renderFillerRecord:function(t,e){t.markup(`<${this.recordElement} class='${e}'></${this.recordElement}>`)},_insertFiller:function(t,e){let i=a(t.toString());return e?e.before(i):this.data$.html(i),this._clearItemCache(),i},_initItems:function(t){const e=this.options;e.itemNavigation!==ut&&t.attr(rt,-1).find(e.tabbableContent).attr(rt,-1)},_insertData:function(t,e,i,s,o){const n=this.options;let l=a(t.toString());if(s?s[o](l):this.data$.append(l),this._clearItemCache(),this._initItems(l),n.useIconList){let t=this.element.find(q),e=t.scrollTop();this.getIconList().refresh(),t.scrollTop(e)}this.atOptions.clearItemCache=!0,this._super(t,e,i,s,o)},_controlBreakLabel:function(t){return{record:t}},_renderBreakRecord:function(t,e,i,s){var o,a=this.options,n=this.atOptions,l=n.extraSubstitutions;mt(l),n.model=this.model,n.record=i.record,l.APEX$ROW_INDEX=null!=s?""+(s+1):"",o=L(this.options.controlBreakTemplate,n),a.highlighter&&(o=a.highlighter(a.highlighterContext,o)),t.markup(o),this.atOptions.clearItemCache=!1},_renderRecord:function(t,e,i,s,o){const a=this.options;let n,l,r=a.recordTemplate,h="",c=this.atOptions,d=c.extraSubstitutions;if(mt(d),o.agg){if(!a.aggregateTemplate)return;r=a.aggregateTemplate,d.APEX$AGG=o.agg,d.APEX$AGG_TOTAL=o.grandTotal?"Y":""}else o.url&&(d.APEX$ROW_URL=o.url),o.hidden&&(h+=" u-hidden"),o.sel&&(h+=" is-selected"),o.deleted?h+=" is-deleted":(o.inserted?h+=" is-inserted":o.updated&&(h+=" is-updated"),o.error?h+=" is-error":o.warning&&(h+=" is-warning"),o.highlight&&(n=a.highlights[o.highlight],n&&n.cssClass?h+=" "+n.cssClass:h+=" "+o.highlight),o.message&&(d.APEX$VALIDATION_MESSAGE=o.message)),h&&(d.APEX$ROW_STATE_CLASSES=h);d.APEX$ROW_ID=""+s,d.APEX$ROW_INDEX=""+(i+1),c.model=this.model,c.record=e,l=L(r,c),a.highlighter&&!o.agg&&(l=a.highlighter(a.highlighterContext,l)),t.markup(l),this.atOptions.clearItemCache=!1},_removeRecord:function(t){t.remove(),this._clearItemCache()},_insertRecord:function(e,i,s,o,n){const l=t.htmlBuilder();this._renderRecord(l,i,null,s,o),this.atOptions.clearItemCache=!0;let r=a(l.toString());return n===O&&e?e.after(r):this.data$.prepend(r),this._clearItemCache(),this._initItems(r),this.options.useIconList&&this.getIconList().refresh(),r},_afterInsert:function(){},_identityChanged:function(t,e){var i,s,o=this._elementsFromRecordIds([t])[0];o&&(i=this.model.getRecord(e),s=this.model.getRecordMetadata(e),this._replaceRecord(o,i,t,e,s))},_replaceRecord:function(e,i,s,o,n){const l=t.htmlBuilder();let r,h=e.attr(b)||null;null!==h&&(h=E(h)-1),this._renderRecord(l,i,h,o,n),this.atOptions.clearItemCache=!0,r=a(l.toString()),e.replaceWith(l.toString()),this._clearItemCache(),this._initItems(r),this.options.useIconList&&(this.getIconList().refresh(),this.getIconList().setSelection(a("[data-id="+n.record.id+"]")),this.focus())},_removeFocus:function(){},_checkAllHidden:t.debounce((function(){const t=this.options.pagination;this.data$.children().is(":visible")?!t.scroll||t.loadMore||t.virtual||this.data$.height()<this.scrollParent$.height()&&this._addNextPage():(this.noData$.show(),this.data$.hide(),this.noData=!0)}),10),_updateRecordState:function(t,e,i,s,o){if("hidden"===o)return this.noData&&!s.hidden&&(this.noData$.hide(),this.data$.show(),this.noData=!1),t.toggleClass("u-hidden",s.hidden),void(this.noData||this._checkAllHidden());this._replaceRecord(t,i,e,e,s)}})}(apex.util,apex.model,apex.debug,apex.lang,apex.item,apex.jQuery);
!function(e,t,l,s,i,a,o,n){"use strict";const r="a-GV",h="a-GV--variableHeight",d=".a-GV-altMessage",c=".a-GV-hdr",u=".a-GV-bdy",f=".a-GV-w-hdr",p=".a-GV-w-scroll",m="a-GV-row",g=".a-GV-row",C="tr",v="td,th",_="a-GV-cell",b=".a-GV-cell",w="a-GV-scrollFiller",x="a-GV-header",I=".a-GV-header",H="a-GV-headerGroup",S=".a-GV-headerGroup",y="a-GV-rowHeader",R="u-selector",k=".u-selector",$="a-GV-table--checkbox",G="a-GV-selHeader",D=".a-GV-selHeader",M=".a-GV-header,.a-GV-headerGroup,.a-GV-cell,.a-GV-controlBreakHeader",F=".a-GV-header,.a-GV-headerGroup",V="a-GV-controlBreak",E="a-GV-controlBreakHeader",T=".a-GV-cell,."+E,A="js-tabTrap",W=".js-tabTrap",P="js-autoAdd",N=".js-toggleBreak",L=".a-GV-floatingItem",z="a-GV-floatingItemContent",B="."+z,K="a-GV-expandCollapse",O="."+K,q="is-selected",j="."+q,U="is-focused",X="is-hover",Q=".is-hover",Y="is-disabled",J="is-expanded",Z="is-active",ee="."+Z+b,te="is-readonly",le="is-error",se="is-warning",ie="is-aggregate",ae="aria-selected",oe="aria-multiselectable",ne="aria-readonly",re="aria-label",he="aria-labelledby",de="aria-expanded",ce="aria-checked",ue="u-RTL",fe="a-GV-frozen",pe="a-GV-frozen--start",me="a-GV-frozen--startLast",ge="a-GV-frozen--endLast",Ce=":visible",ve=":tabbable",_e=":disabled,.js-asc,.js-desc",be="click",we="none",xe="sequence",Ie="label",He="true",Se="false",ye="set",Re="unset",ke="toggle",$e="range",Ge="add",De="none",Me="all",Fe="columnReorder",Ve=40,Ee="body",Te="class",Ae="title",We="role",Pe="colspan",Ne="data-idx",Le="data-id",ze="data-rownum",Be="tabIndex",Ke="tabindex",Oe="start",qe="end",je="left",Ue="right",Xe="center",Qe="left",Ye=e.hasOwnProperty,Je=Object.entries,Ze=n.extend,et=Array.isArray,tt=n.ui.keyCode,lt=navigator.appVersion.includes("Mac"),st=e.invokeAfterPaint,it=e=>parseInt(e,10);let at=0;const ot={begin:function(e,t,l){1===l.length&&t.records&&1===t.records.length?this.text="":(this.table=!0,this.text="<table><tbody>")},beginRow:function(){this.table&&(this.text+="<tr>")},cell:function(t,l,s,i){this.table?this.text+=`<td>${e.escapeHTML(i)}</td>`:this.text+=e.escapeHTML(i)},endRow:function(){this.table&&(this.text+="</tr>")},end:function(){this.table&&(this.text+="</tbody></table>")},toString:function(){return this.text}};function nt(e,t){let l="";return e===Oe?l=" u-tS":e===qe?l=" u-tE":e===je?l=" u-tL":e===Ue?l=" u-tR":e!==Xe||t||(l=" u-tC"),l}function rt(e,t,l){let s;return e.highlight&&(s=t.highlights[e.highlight],s&&s.cssClass?l+=" "+s.cssClass:l+=" "+e.highlight),l}function ht(e,t,l,s,i){let a=m;return e.agg?(a+=" is-aggregate",a+=" a-GV-aggregate--"+e.agg,e.grandTotal&&(a+=" is-grandTotal")):(e.hidden&&(a+=" u-hidden"),(e.sel||l)&&(a+=" "+q),e.deleted?a+=" is-deleted":(e.inserted?a+=" is-inserted":e.updated&&(a+=" is-updated"),e.error?a+=" is-error":e.warning&&(a+=" is-warning"),a=rt(e,t,a),s.allowEdit(i)||(a+=" is-readonly"))),a}function dt(e,t,l,s,i,a,o){let n,r=!1,h=_;return h+=nt(e.alignment),e.columnCssClasses&&(h+=" "+e.columnCssClasses),e.cellCssClassesColumn&&(h+=" "+a.getValue(o,e.cellCssClassesColumn)),i&&([q,U,Z,fe,me,ge].forEach((e=>{i.hasClass(e)&&(h+=" "+e)})),n=/(^|\s)a-GV-frozen--(start|end)\d+(\s|$)/.exec(i.attr(Te)),n&&(h+=" "+n[0].trim())),l&&(t.deleted||(l.error?h+=" is-error":l.warning?h+=" is-warning":l.changed?h+=" is-changed":l.stale&&(h+=" is-stale")),h=rt(l,s,h),l.disabled&&(h+=" is-disabled"),r=l.ck),(r||e.readonly)&&(h+=" is-readonly"),e.usedAsRowHeader&&!t.agg&&(h+=" "+y),h}function ct(e){return s.getMessage("APEX.GV."+e)}function ut(e,...t){return s.formatMessage("APEX.GV."+e,...t)}const ft=e.binarySearch;function pt(e,t){return e.offset-t.offset}function mt(e){return e.parent().children().index(e)}function gt(e){let t=n(e.toString());return t.find("a,button,input,select,textarea").prop(Be,-1),t}function Ct(e){return n(e).closest(M)}function vt(e){return n(e).closest(T)}function _t(e){return n(e).closest(b)}function bt(e,t){let l,s,i=e.children();return i.last().hasClass(H)?(s=0,i.each((function(){if(s+=it(n(this).attr(Pe))||1,s>t)return l=n(this),!1}))):l=i.eq(t),l}function wt(e){let t;return e.hasClass(H)?(t=0,e.parent().children().each((function(){if(this===e[0])return!1;t+=it(n(this).attr(Pe))||1}))):t=mt(e),t}const xt="keydown.gridGlobalEscape";function It(e){n(Ee).on(xt,(function(t){t.which===tt.ESCAPE&&(n(Ee).off(xt),e())}))}function Ht(){n(Ee).off(xt)}function St(e){let t=e.groupName||null;return t&&e.useGroupFor&&e.useGroupFor.indexOf("heading")<0&&(t=null),t}function yt(e){return e.closest(C)}n.widget("apex.grid",n.apex.tableModelViewBase,Ze(!0,{version:"21.1",widgetEventPrefix:"grid",options:{columns:null,columnGroups:null,columnSort:!0,columnSortMultiple:!0,resizeColumns:!0,reorderColumns:!0,collapsibleControlBreaks:!0,aggregateLabels:{},aggregateTooltips:{},tabbableCellContent:"a,button,input",allowEditMode:!0,allowDelete:!0,allowInsert:!0,allowCopy:!0,skipReadonlyCells:!1,rowHeader:we,rowHeaderCheckbox:!1,rowHeaderLabelColumn:null,rowHeaderWidth:null,selectCells:!1,multiple:!1,multipleCells:!0,selectAll:!0,allowSelectHidden:!1,tooltip:{tooltipClass:"a-GV-tooltip"},dataTransferFormats:[{format:"text/plain",writer:Object.create({begin:function(){this.text=""},beginRow:function(e){e>0&&(this.text+="\r\n")},cell:function(e,t,l,s){e>0&&(this.text+="\t"),this.text+=s},endRow:function(){},end:function(){},toString:function(){return this.text}})},{format:"text/html",writer:Object.create(ot)}],constrainNavigation:!0,selectionChange:null,activateColumnHeader:null,activateCell:null,expansionChange:null,cancelColumnHeader:null,sortChange:null,columnReorder:null,columnResize:null,modeChange:null,pageChange:null},_create:function(){const t=this,s=this.options,i=this.element;l.info(`Grid '${i[0].id}' created. Model: ${s.modelName}`),i.addClass(r).attr(We,"grid"),s.multiple&&i.attr(oe,He),s.editable||i.attr(ne,He),s.fixedRowHeight||i.addClass(h),this.forwardKey=tt.RIGHT,this.backwardKey=tt.LEFT,"rtl"===i.css("direction")&&(i.addClass(ue),this.forwardKey=tt.LEFT,this.backwardKey=tt.RIGHT),this._enforceOptionConstraints(),this._super(),this.origLabelBy=i.attr(he),at+=1,this.idPrefix=i[0].id||"agv_"+at,this.accContextId=this.idPrefix+"_ctx",this.curRowHeaders="",this.tableHeader$=null,this.tableData$=null,this.lastEditModeCell=null,this.controlBreaks=[],this.editMode=!1,this.columns=null,this.columnsStale=!0,this.columnGroups=null,this.lastFrozenColIndex=-1,this.endFrozenColIndex=-1,this.lastFocused=null,this.lastRow$=null,this.focusInHeader=!1,this.lastHoverCell=null,this.lastHoverRow=null,this.lastColIndex=null,this.columnControls$=null,this.scrollTimerId=null,this.deactivateDelayTimer=null,this.lastFloatingPos={},this.allSelected=!1,this.hasSelection=!1,this.activateContext=null,this.gotoCellPending=null,this._initContextMenu(C,(function(e){return n(e.target).closest("a").length>0||t.editMode}),(function(e){var l;if((l=_t("keydown"===e.type?t.lastFocused:e.target)).length){if(t.options.selectCells){if(!l.hasClass(q))return l}else if(!l.parent().hasClass(q))return l;return!0}return!1}),(function(e){t.options.selectCells?e.selectedRange=t.getSelectedRange():e.selectedRecords=t.getRecords(e.selection)})),this._initModel(s.modelName),this._on(this._eventHandlers),s.allowCopy&&a.addHandler(i[0],(function(e){return!t.editMode&&(t._copy(e),!0)})),this._selNotifyDelay=e.debounce(this._selChangeNotify,1),this._selNotifyLongDelay=e.debounce(this._selChangeNotify,350),this._updateHighlights(),this.refresh(),this._setSelectionMode(),s.disabled&&this._setOption("disabled",s.disabled)},_eventHandlers:{resize:function(e){e.target===this.element[0]&&(this.resize(),e.stopPropagation())},click:function(e){var t,l=this.options,s=n(e.target);if(s.closest("a,button,.a-GV-footer").length)(t=s.closest(F)).length?(this.focusInHeader=!0,this.lastColIndex=null,this._select(t,e,!0,!1)):(t=s.closest(T)).length&&!this.editMode&&(this.focusInHeader=!1,this.lastColIndex=null,this._select(t,De,!1,!1),s.trigger("focus"));else if(!(s.closest(L).length>0)){if((t=s.closest(".a-GV-selHeader.a-GV-header")).length)return this.focusInHeader=!0,this.lastColIndex=null,void(l.rowHeaderCheckbox&&l.multiple&&l.selectAll&&!l.selectCells?(t.find(k).attr(ce)===He?this.setSelection(n()):!l.pagination.scroll&&l.persistSelection&&e.shiftKey?(this.focusInHeader=!1,this._select(this._getAllRows().map((function(){return n(this).children()[0]})),Ge,!1,!1),this.focusInHeader=!0):this.selectAll(),this._select(t,e,!0,!1),this._setFocusable(t[0])):this._select(t,e,!0,!1));if((t=s.closest(S)).length)return this.focusInHeader=!0,this.lastColIndex=null,this._select(t,e,!0,!1),void e.preventDefault();if((t=s.closest(I)).length&&0===s.closest("button").length)return this.focusInHeader=!0,this.lastColIndex=null,this._select(t,e,!0,!1),this._activateColumnHeader(e,t),void e.preventDefault();if((t=s.closest(D)).length)return l.rowHeaderCheckbox&&!l.selectCells&&(e.ctrlKey=!0,e.shiftKey=!1),this.focusInHeader=!1,this.lastColIndex=null,this._select(t,e,!0,!1),void e.preventDefault();(t=s.closest(b)).length&&(this.focusInHeader=!1,this.lastColIndex=null,t.hasClass(Z)||(this._checkInteractWithCellItem(e,s,t),this._select(t,e,!0,!1),e.preventDefault())),(t=s.closest(".a-GV-controlBreakHeader")).length&&(this.focusInHeader=!1,this.lastColIndex=null,this._select(t,e,!0,!1),e.preventDefault())}},dblclick:function(e){var t=this.options,l=n(e.target).closest(b).not(D);l.length&&(t.editable&&t.allowEditMode?this.editMode||this.setEditMode(!0,!0):this._fireActivate(e,l))},mousedown:function(e){var t,l=n(e.target);0!==e.originalEvent.button||l.closest("a,button,.a-GV-footer").length?this.focusInHeader=l.closest(F).length>0:!l.closest(O).length&&this.editMode?(t=l.closest(b),this.editMode&&t.length&&!t.hasClass(Z)&&(this.activateContext=e.clientX-e.target.getClientRects()[0].x,this._checkInteractWithCellItem(null,l,t))):e.preventDefault()},keydown:function(e){var t,l,s,i,a,o,r,h,d,c=this,u=this.options,f=null,p=e.which,m=n(e.target);function g(){s.hasClass(G)?s.find(k).trigger(be):(c._activateColumnHeader(e,s),e.preventDefault())}function C(e,t){var l,s=null;for(l=e+=t;l>=0&&l<c.columns.length;l+=t)if(!c.columns[l].hidden){s=l;break}return s}function v(){e.ctrlKey=!1,u.pagination.scroll&&c.firstPage(),f=c.tableData$.children().first().children().first(),c.focusInHeader=!1}function b(){e.ctrlKey=!1,u.pagination.scroll&&c.lastPage(),(f=c.tableData$.children(Ce).last()).hasClass(w)?(f=null,c.element.one("gridpagechange",(()=>{c._select(c.tableData$.children().last().children().last(),{type:"keydown",shiftKey:e.shiftKey},!0,!1)}))):f=f.children().last(),c.focusInHeader=!1}function I(e,t){c.element.one("gridpagechange",(()=>{setTimeout((()=>{c._select(c.tableData$.children()[e]().children().eq(t),null,!0,!0)}),0)}))}if(!(m.closest(".a-GV-footer").length>0)){if(p!==tt.PAGE_UP&&p!==tt.PAGE_DOWN||(o=this.viewportHeight/this.avgRowHeight),p===tt.HOME)!this.editMode&&this.lastFocused&&(this.lastColIndex=null,e.ctrlKey&&!lt?v():f=this.lastRow$.first(),e.preventDefault());else if(p===tt.END)!this.editMode&&this.lastFocused&&(this.lastColIndex=null,e.ctrlKey&&!lt?b():f=this.lastRow$.last(),e.preventDefault());else if(p===tt.PAGE_DOWN){if((!this.editMode||Ct(this.lastFocused).hasClass(G))&&!e.altKey){if(this.focusInHeader){let e=(s=Ct(this.lastFocused)).closest("thead").children(),t=e.length-e.index(s.parent());s=this._getNextCellDown(Ct(this.lastFocused),t)}else s=vt(this.lastFocused);if(!(f=this._getNextCellDown(s,o)))if(u.pagination.loadMore)this.element.find(".js-load").trigger("focus");else if(!u.pagination.scroll){let e=this.model.getTotalRecords();(e<0||this.pageOffset+this.pageCount<e)&&(I("first",wt(s)),this.nextPage())}e.preventDefault()}}else if(p===tt.PAGE_UP)this.focusInHeader||this.editMode&&!Ct(this.lastFocused).hasClass(G)||e.altKey||(s=vt(this.lastFocused),(f=this._getPrevCellUp(s,o,!0))||!u.pagination.scroll&&this.pageOffset>0&&(I("last",wt(s)),this.previousPage()),e.preventDefault());else if(p===tt.DOWN){if(s=Ct(this.lastFocused),u.columnSort&&e.altKey&&s.hasClass(x))return void c._sortChange(e,s,"desc");(!this.editMode||this.focusInHeader||s.hasClass(G)||s.hasClass(E))&&this.lastFocused&&(e.altKey?lt&&e.altKey&&b():(!(f=this._getNextCellDown(s,1))&&u.pagination.loadMore&&this.element.find(".js-load").trigger("focus")[0]&&e.preventDefault(),(f||u.constrainNavigation)&&e.preventDefault())),m.closest("[data-menu]").length&&e.stopPropagation()}else if(p===tt.UP){if(s=Ct(this.lastFocused),u.columnSort&&e.altKey&&s.hasClass(x))return void c._sortChange(e,s,"asc");(!this.editMode||this.focusInHeader||s.hasClass(G)||s.hasClass(E))&&this.lastFocused&&(e.altKey?lt&&e.altKey&&v():(m.hasClass("js-load")?(this.focus(),e.preventDefault()):f=this._getPrevCellUp(s,1),(f||u.constrainNavigation)&&e.preventDefault()),e.stopPropagation())}else if(p===this.backwardKey){if(e.altKey||e.metaKey)return;if(s=Ct(this.lastFocused),(e.ctrlKey||e.shiftKey)&&(s.hasClass(x)||s.hasClass(H))&&(!s.hasClass(G)||u.rowHeader===xe||u.rowHeader===Ie)&&(a=it(s.attr(Ne)),!isNaN(a)||e.ctrlKey||u.rowHeader===xe||u.rowHeader===Ie))if(a>=0&&(i=this.columns[a]),e.shiftKey&&u.reorderColumns){if(e.preventDefault(),s.hasClass(H))r=mt(s.parent()),a>0&&(this.moveColumnGroup(r,a,a-1),s=n(this.lastFocused).closest(S));else if(null!==(a=C(a,-1)))return void this.moveColumn(i,a)}else if(e.ctrlKey&&u.resizeColumns&&!s.hasClass(H))return void(i?s.outerWidth()>Ve&&((d=s.outerWidth()-10)<Ve&&(d=Ve),this.setColumnWidth(i,d)):c.rowHeaderWidth>Ve&&((d=c.rowHeaderWidth-10)<Ve&&(d=Ve),c.rowHeaderWidth=d,this._calculateColumnWidths(s,!0)));(!this.editMode||this.focusInHeader||s.hasClass(E))&&this.lastFocused&&(this.lastColIndex=null,(l=this.lastRow$.index(s))>0&&(l-=1,f=this.lastRow$.eq(l)),e.preventDefault())}else if(p===this.forwardKey){if(e.altKey)return;if(s=Ct(this.lastFocused),(e.ctrlKey||e.shiftKey)&&(s.hasClass(x)||s.hasClass(H))&&(!s.hasClass(G)||u.rowHeader===xe||u.rowHeader===Ie)&&(a=it(s.attr(Ne)),!isNaN(a)||e.ctrlKey||u.rowHeader===xe||u.rowHeader===Ie))if(a>=0&&(i=this.columns[a]),e.shiftKey&&u.reorderColumns){if(e.preventDefault(),s.hasClass(H))r=mt(s.parent()),a<this.columnGroups[r].length-1&&(this.moveColumnGroup(r,a,a+1),s=n(this.lastFocused).closest(S));else if(null!==(a=C(a,1)))return void this.moveColumn(i,a)}else if(e.ctrlKey&&u.resizeColumns&&!s.hasClass(H))return void(i?this.setColumnWidth(i,s.outerWidth()+10):(c.rowHeaderWidth+=10,this._calculateColumnWidths(s,!0)));(!this.editMode||this.focusInHeader||s.hasClass(E))&&this.lastFocused&&(this.lastColIndex=null,(l=this.lastRow$.index(s))<this.lastRow$.length-1&&(l+=1,f=this.lastRow$.eq(l)),e.preventDefault())}else if(65===p&&e.ctrlKey&&!this.editMode&&u.multiple&&u.selectAll&&!u.selectCells)!u.pagination.scroll&&u.persistSelection&&e.shiftKey?this._select(this._getAllRows().map((function(){return n(this).children()[0]})),Ge,!1,!1):this.selectAll(null),e.preventDefault();else if(p===tt.SPACE){if("BUTTON"===e.target.nodeName)return;if((s=m.filter(D).find(k)).length)return s.trigger(be),void e.preventDefault();if((s=Ct(this.lastFocused)).hasClass(x))g();else if(s.hasClass(_)&&(!this.editMode||s.hasClass(G))){let t=this._checkInteractWithCellItem(e,m,s);this._select(s,e,!0,!0),t||e.preventDefault()}}else if(p===tt.ENTER){if(!m.hasClass(K)&&m.closest("a,button,.js-uses-enter").length>0)return;if((s=m.filter(D).find(k)).length)return void s.trigger(be);s=Ct(this.lastFocused),this.editMode&&(s.hasClass(_)||s.hasClass(E))?(e.shiftKey?(f=this._getPrevCellUp(s,1,!0),e.shiftKey=!1):f=this._getNextCellDown(s,1),this.activateContext=-1):(e.preventDefault(),u.editable&&u.allowEditMode&&s.hasClass(_)&&!s.hasClass(G)?this.setEditMode(!0,!0):s.hasClass(x)?g():u.editable&&u.allowEditMode||!s.hasClass(_)||this._fireActivate(e,s))}else if(113===p)(s=_t(this.lastFocused)).length&&u.editable&&u.allowEditMode&&!this.editMode&&this.setEditMode(!0,!0);else if(p===tt.ESCAPE)u.editable&&u.allowEditMode&&this.editMode&&this._doEscapeKey(e);else if(p===tt.DELETE){if(u.editable&&u.allowDelete&&!this.editMode&&!this.focusInHeader){for(h=this.getSelectedRecords(),t=0;t<h.length;t++)this.model.allowDelete(h[t])||(h.splice(t,1),t-=1);h.length>0&&this.model.deleteRecords(h)}}else 45===p?u.editable&&u.allowInsert&&!this.editMode&&!u.selectCells&&this.model.allowAdd()&&((h=this.getSelectedRecords()).length>0?this.model.insertNewRecord(null,h[h.length-1]):this.model.insertNewRecord()):112===p&&e.altKey?this._doHelpKey():p===tt.TAB&&this.editMode&&(this.activateContext=-1,this.lastKeyTab=!0);f&&(this._select(f,e,!0,!0),e.preventDefault())}},focusin:function(e){var t,l,s=null,i=this,a=n(e.target);if(a.closest(L).length)this._clearDeactivate();else if(0!==(t=a.closest(M)).length)if(t.addClass(U),this.lastEditModeCell!==t[0]){if(this.editMode){let o=this.activateContext;this.focusInHeader=!1,l=n(this.lastEditModeCell),this._clearDeactivate(),l.length&&this._deactivateCell(l),t.hasClass(_)||t.hasClass(E)?!t.hasClass(G)&&!t.hasClass(E)||this.lastKeyTab?(a.closest("a,button").length&&(s=e.target),setTimeout((function(){i.editMode&&!t.hasClass(Z)&&i._activateCell(t,s,o)}),0)):(this._clearTabTraps(),this.lastEditModeCell=null,this._setFocusable(e.target),this._setTabTraps(t)):(this.focusInHeader=!0,this.lastEditModeCell=null,this._setFocusable(e.target))}else this._setFocusable(e.target);this.lastKeyTab=!1,this.activateContext=null}else this._clearDeactivate();else a.hasClass(A)||(this.lastEditModeCell=null)},focusout:function(e){var t=n(e.target).closest(M),l=this._getColumnMetadata(t),s=l&&this.columnItems[l.property];t.removeClass(U),this.editMode&&t.hasClass(_)&&(null===this.lastEditModeCell&&this._clearTabTraps(),s&&s.item.isDisabled()||this._beginDeactivate(t))},mousemove:function(e){var t,l,s,i,a,o=n(e.target),r=this.options,h=o.closest(M);e=e.originalEvent||e,h.length?h[0]!==this.lastHoverCell&&((t=h.parent())[0]!==this.lastHoverRow&&(this._clearHoverStates(),this.lastHoverRow=t[0],!t.hasClass(m)&&!t.hasClass(V)||this.columnReordering||this.columnWidthDragging||this._setRowHoverState(t)),this.lastHoverCell=h[0],this.columnControls$.hide(),this.columnHandle$.hide(),"TH"!==h[0].nodeName||h.hasClass(_)||t.hasClass(V)||(i=this.columns[h.attr(Ne)],!r.columnSort||this.columnReordering||this.columnWidthDragging||h.hasClass(G)||h.hasClass(H)||!i.canSort||(h.append(this.columnControls$.show()),this._updateColumnControls(i)),!r.reorderColumns||0!==e.buttons||this.columnReordering||this.columnWidthDragging||h.hasClass(G)||(this.columnReorderCell$=h,h.append(this.columnHandle$.show().css(Qe,""))),!r.resizeColumns||this.columnReordering||this.columnWidthDragging||h.hasClass(G)&&r.rowHeader!==xe&&r.rowHeader!==Ie||(l=h.closest("div")[0],s=h[0].offsetLeft+l.offsetLeft-l.scrollLeft,this.element.hasClass(ue)||(s+=h.outerWidth()),this.columnWidthHandle$.show().css(Qe,s-this.columnWidthHandle$.width()/2),a=h.attr(Ne),this.columnWidthCell$=a?this._columnFromIndex(a):this.element.find(".a-GV-header.a-GV-selHeader")))):null!==this.lastHoverCell&&(this.lastHoverCell=null,this.lastHoverRow=null,this._clearHoverStates())},mouseleave:function(){null!==this.lastHoverCell&&(this.lastHoverCell=null,this.lastHoverRow=null,this._clearHoverStates())}},_doEscapeKey:function(e){var t=_t(this.lastFocused);t.length&&this._setFocusable(t[0]),t.trigger("focus"),this.setEditMode(!1),t.length&&this._setFocus(this._getCellFocusable(t)),e.stopPropagation()},_doHelpKey:function(){var e,t=Ct(this.lastFocused);t.hasClass(G)||t.hasClass(H)||t.hasClass(E)||(e=this._getColumnMetadata(t))&&e.helpid&&(this.editMode&&t.trigger("focus"),apex.theme.popupFieldHelp(e.helpid,apex.env.APP_SESSION))},_initTooltips:function(t){var s,i=this;n.ui.tooltip?(this.tooltipOptions&&(this.element.find(u).filter(":data('ui-tooltip')").tooltip("destroy"),this.tooltipOptions=null),t&&((s=this.tooltipOptions=Ze(!0,{show:apex.tooltipManager.defaultShowOption(),tooltipClass:"a-GV-tooltip"},t)).items=v,s._originalContent=s.content,s.content=function(t){let l,a,o,r=n(this),h=r.parent(),d=null,c=null,u=i._getColumnMetadata(r);return l=h.attr(Le),l&&(d=i.model.getRecordMetadata(l)),u&&d&&d.fields&&(c=d.fields[u.property]),d&&!d.deleted&&(c&&(c.error||c.warning)?(a=c.error?le:se,o=c.message):(d.error||d.warning)&&r.hasClass(G)?(a=d.error?le:se,o=d.message):d.agg&&u&&(a="",o=i.options.aggregateTooltips[d.agg+"|"+u.property]),o)?`<span class='${a}'>${e.escapeHTML(o)}</span>`:s._originalContent?s._originalContent.call(this,t,i.model,d,c,u):null},s.open=function(e,t){t.tooltip.find(".is-error").length&&t.tooltip.addClass(le),t.tooltip.find(".is-warning").length&&t.tooltip.addClass(se)},this.element.find(".a-GV-bdy,.a-GV-hdr").tooltip(s))):l.warn("tooltip option ignored because missing tooltip widget dependency")},_destroy:function(){var e=this.element;this._tableModelViewDestroy(),e.removeClass("a-GV is-disabled u-RTL").removeAttr(We).removeAttr(oe).removeAttr(ne).attr(he,this.origLabelBy).empty(),a.removeHandler(e[0]),l.info(`Grid '${e[0].id}' destroyed. Model: ${this.options.modelName}`),this.tableData$=null,this._initModel(null),this.gridStyles$&&this.gridStyles$.remove(),this._destroyContextMenu()},_setOption:function(e,t){var s=this.element,i=this.options;if(l.info(`Grid '${s[0].id}' set option '${e}' to:`,t),this._checkContextMenuOptions(e,t),"allowCopy"===e)throw new Error(`Grid ${e} cannot be set`);"editable"===e&&!t&&this.editMode?this.setEditMode(!1):"multiple"===e&&this.setSelection(n()),this._super(e,t),this._enforceOptionConstraints(),"disabled"===e?(s.toggleClass(Y,t),this.lastFocused&&(t?this.lastFocused.tabIndex=-1:this._setFocusable(this.lastFocused)),t&&this.resize()):"selectCells"===e?this._setSelectionMode():"multiple"===e?(t?s.attr(oe,He):s.removeAttr(oe),i.rowHeader!==we&&i.rowHeaderCheckbox&&this.refreshColumns(),this.refresh()):"modelName"===e?(this.editMode&&this.setEditMode(!1),this._initModel(t),this.refresh(!1)):"highlights"===e?this._updateHighlights():"tooltip"===e?this._initTooltips(t):"hideEmptyFooter"===e?this._updateTotalRecords():"fixedRowHeight"===e?(s.toggleClass(h,!t),this._refreshGrid()):["rowHeader","rowHeaderCheckbox","rowHeaderLabelColumn","columnSort","resizeColumns","reorderColumns","editable","selectAll","autoAddRecord","footer","pagination","rowsPerPage"].includes(e)&&("editable"===e&&(t?s.removeAttr(ne):s.attr(ne,He)),this._refreshGrid())},_enforceOptionConstraints:function(){var e=this.options;e.rowHeaderCheckbox&&e.rowHeader===we&&(l.warn("Option rowHeaderCheckbox cannot be true when rowHeader is 'none'."),e.rowHeaderCheckbox=!1),!e.multiple||e.rowHeader!==we&&e.rowHeaderCheckbox||!apex.userHasTouched()||(e.rowHeader===we&&(e.rowHeader="plain"),e.rowHeaderCheckbox=!0),e.editable&&e.allowEditMode||(e.autoAddRecord=!1),e.rowHeader!==we&&(e.rowHeaderWidth?this.rowHeaderWidth=e.rowHeaderWidth:(e.rowHeaderCheckbox?this.rowHeaderWidth=34:this.rowHeaderWidth=16,e.rowHeader!==xe&&e.rowHeader!==Ie||(this.rowHeaderWidth+=38)))},refresh:function(e){let t,s,i,a,o,r,h,d,f,m,_=!1,w=null,x=null,I=null,H=this,S=this.options,y=this.element;if(l.info("Grid '"+y[0].id+"' refreshed. Model: "+S.modelName),!0!==e&&(_=this._paginationHasFocus()),void 0===e&&(e=n(document.activeElement).closest(y[0]).length>0),!this._refreshCheckIfVisible())return;w=y.find(ee),w.length&&this._deactivateCell(w),w=n(this.lastFocused).closest(v),a=mt(w),o=w.parent().attr(Le),this.focusInHeader?this.columnsStale&&this.columns&&(I=mt(n(this.lastFocused).closest(C)),t=n(this.lastFocused).closest("th").attr(Ne),t&&(t=this.columns[t].property),this.lastFocused=null):this.lastFocused=null;let R=this.modelChanged;if(this.modelChanged=!1,!this.tableData$||S.persistSelection&&!S.selectCells)S.persistSelection&&(m=this.hasSelection,this.hasSelection=!1);else if(S.selectCells)s=this.getSelection(),s.length>0&&(w=s[0].first(),i=mt(w),x={rowIndex:mt(w.parent()),colIndex:i});else{s=this.getSelection(),x=[];for(let e=0;e<s.length;e++)h=s[e].first().attr(Le),void 0!==h&&x.push(h);0===x.length&&(x=null)}!S.hasSize&&this.tableData$&&y.css("min-height",y.height()+"px"),this._refreshPagination(y.find(p)),this.columnsStale||!this.columns?this._initGrid():(this.tableData$.empty(),this._clearChildrenRowCache(),this._updateScrollHandler(y.find(p))),this.controlBreaks=[],this._updateStatus(),this.noData||this.resize(),d=y.find(c),null!==I&&t&&(f=S.columns[0][t],f&&(t=f.seq-1,d.find("thead").each((function(){if(w=n(this).children().eq(I).find("th[data-idx='"+t+"']"),w.length)return!1}))),w&&w.length||(w=d.find("thead").first().find(C).eq(I).children().first()),w&&w.length&&(H._select(w,null,e,!1,!0),e=!1)),this.allSelected=!1,this._addPageOfRecords((function(){let t,l,h,c=!1;if(_&&(H._restorePaginationFocus(_),e=!1),y.find(".a-GV-header .u-selector").attr("aria-disabled",H.noData?He:Se).toggleClass(Y,H.noData),H._updateAccLabel(),S.hasSize?H._calculateColumnWidths(null,!0,!0):y.css("min-height",""),H.lastHoverCell=null,H.lastHoverRow=null,!H.lastFocused||!n(H.lastFocused).is(Ce)){let e=y.find("[data-id='"+o+"']");e[0]||(e=y.children(u).find("tbody .a-GV-row").first()),H.lastRow$=null,H.lastFocused=H._getCellFocusable(e.children().eq(a>=0?a:0)),H.lastFocused?(H.selectAnchor=n(H.lastFocused).closest(b)[0],!S.selectCells&&H.selectAnchor&&(H.selectAnchor=H.selectAnchor.parentNode),H.focusInHeader=!1):(H.lastFocused=H._getCellFocusable(d.find("thead").first().find(C).last().children().first()),H.focusInHeader=!0),H.lastFocused&&!S.disabled&&(h=H.lastFocused,H._setFocusable(H.lastFocused),H._setCurrentRow(H.lastFocused))}if(x){if(S.selectCells)H.tableData$.find(g).length>x.rowIndex&&(i=x.colIndex,r=H.tableData$,t=r.find(g).eq(x.rowIndex).children(),i>=t.length&&(i=t.length-1),H.setSelection([t.eq(i)]),c=!0);else{s=[];for(let e=0;e<x.length;e++)l=H.model.getRecord(x[e]),l&&s.push(l);s.length>0&&(c=0!==H.setSelectedRecords(s,!1,!0))}c&&!R||H._selNotifyDelay(!0,null)}else S.persistSelection&&(m||R)&&H._selNotifyDelay(!0,null);h&&c&&(H._setFocusable(h),H._setCurrentRow(h)),e&&H.focus()}))},focus:function(){this.lastFocused&&this.lastFocused.focus()},gotoCell:function(e,t){var s,i,a,o,n=this.options,r=!1,h=null,d=null,c=this.element.find("[data-id='"+e+"']");if(this.gotoCellPending=null,this.tableData$){if(t&&((h=n.columns[0][t])?h.hidden&&h.canHide&&(h.hidden=!1,r=!0,this.refreshColumns(),this.gotoCellPending={record:e,column:t}):l.warn("Warning column not found "+t)),!c.length){if(!(s=this.model.getRecord(e)))return void l.warn("Warning record not found "+e);i=this.model.indexOf(s),this.gotoCellPending={record:e,column:t},n.pagination.scroll?(a=this.scrollParent$,o=Math.floor(i/this.viewportHeight/this.avgRowHeight)*this.viewportHeight,a.scrollTop(o)):(this.pageOffset=Math.floor(i/this.pageSize)*this.pageSize,r=!0)}r&&this.refresh(!1),this.gotoCellPending||(t&&h&&(d=this._cellFromColumn(c,t)),d||(d=c.children().first()),this._select(d,null,!0,!1))}},getActiveCellFromColumnItem:function(e){var t,l=null;if(this.activeRecordId){t=this.element.find("[data-id='"+this.activeRecordId+"']");for(const[s,i]of Object.entries(this.columnItems))e===i.item.node&&(l=this._cellFromColumn(t,s))}return l},inEditMode:function(){return this.editMode},setEditMode:function(e,t=!1){let s,i,a=!1,o=this;const n=()=>{this.columnItemsContainer$.off("change.gridedit"),this.activeRecord=null,this.activeRecordId=null},r=()=>{e=!!e,this.lastFloatingPos={},s=e!==this.editMode,this.editMode=e,this.element.toggleClass("a-GV--editMode",e),i=_t(this.lastFocused),i.length&&(e?this._activateCell(i,null,t?-1:null):(this.lastEditModeCell=null,this._clearDeactivate(),this._deactivateCell(i),this.activeRecord&&(this._deactivateRow(n),a=!0))),s&&(e?this.columnItemsContainer$.on("change.gridedit",(function(e){let t,l,s;if(o.activeRecord)for(t=0;t<o.columns.length;t++)if(l=o.columns[t],l.elementId===e.target.id){s=l.property,o.setActiveRecordValue(s);break}})):a||n(),this._trigger("modeChange",null,{editMode:e}))};this.tableData$&&(this.options.editable?r():e&&l.warn("Grid is not editable."))},getSelection:function(){let e=[];return this.tableData$&&(this.options.selectCells?this.tableData$.find(j).parent(C).each(((t,l)=>{e.push(n(l).find(j).filter(v))})):this.tableData$.find(j).filter(C).each(((t,l)=>{e.push(n(l))}))),e},setSelection:function(e,t,l){let s,i=null,a=this.options.multiple,o=[];if(this.tableData$){if(this.options.selectCells)et(e)||(e=[e]),s=e[0].first()[0],o.push(e[e.length-1].last()[0]),s!==o[0]&&(this._select(n(s),null,null,!1,!1),i={type:"click",shiftKey:!0});else if(et(e)){let t=e.length;!a&&t>1&&(t=1);for(let l=0;l<t;l++)s=e[l].children(v)[0],s&&o.push(s)}else e.each((function(){if(s="TR"===this.nodeName?n(this).children(v)[0]:n(this).closest(v)[0],s&&(o.push(s),!a))return!1}));this._setSelection(o,i,t,l)}},_setSelection:function(e,t,l,s){let i=this.lastFocused,a=this.focusInHeader;this.focusInHeader=!1,this._select(n(e),t,l,!1,s),l||(this.focusInHeader=a,a&&(this._setFocusable(i),this._setCurrentRow(i)))},selectAll:function(e,t){var l=[],s=this.options,i=this.tableData$;i&&s.multiple&&s.selectAll&&!s.selectCells&&(i.children(g).each((function(){l.push(n(this).children()[0])})),this._setSelection(l,Me,e,t))},getRecords:function(e){var t,l,s,i=[];for(t=0;t<e.length;t++)void 0!==(l=e[t].attr(Le))&&(s=this.model.getRecord(l))&&i.push(s);return i},getSelectedRange:function(){var e,t,l,s,i,a,o,n=null;if(this.options.selectCells)for(n={columns:[],recordIds:[],values:[]},e=this.getSelection(),t=0;t<e.length;t++){if(i=e[t],0===t)for(l=0;l<i.length;l++)o=this._getColumnMetadata(i.eq(l)),n.columns.push(o?o.property:null);for(a=i.first().parent().attr(Le),n.recordIds.push(void 0!==a?a:null),s=[],l=0;l<i.length;l++)s.push(i.eq(l).text());n.values.push(s)}return n},getSelectedRecords:function(){var e=this.options;return e.selectCells?[]:e.persistSelection?this.model.getSelectedRecords():this.getRecords(this.getSelection())},setSelectedRecords:function(e,t,l){let s=0,i=e.length,a=[],o=new Set,r=this.tableData$;if(!r||this.options.selectCells||this.renderInProgress)return-1;!this.options.multiple&&i>1&&(i=1);for(let t=0;t<i;t++)o.add(this.model.getRecordId(e[t]));if(r.children(g).each((function(){var e=n(this),t=e.attr(Le);o.has(t)&&(o.delete(t),a.push(e.children()[0]),s+=1)})),this._setSelection(a,null,t,l),this.options.persistSelection){for(let e of o){this.model.getRecord(e)&&(this.model.setSelectionState(e,!0),s+=1)}0!==a.length||l||this._selNotifyDelay(!0,null)}return s},activateRow:function(e,t){var l=!1,s=n(this.lastEditModeCell),i=e.parent().attr(Le);this.editMode&&i===this.activeRecordId||(this.element.one("apexbeginrecordedit",(function(){t()})),l=!0),this.editMode?(s.length&&(s.removeClass(U),this._deactivateCell(s)),e.addClass(U),this._activateCell(e)):(this.lastFocused=e[0],this.setEditMode(!0)),l||t()},activateCell:function(e){var t=n(this.lastEditModeCell);return!!this.editMode&&(t.length&&(t.removeClass(U),this._deactivateCell(t)),e.addClass(U),this._activateCell(e))},copyDownSelection:function(e,t){return this._setSelectionValues(1,e,t)},fillSelection:function(e,t,l){return this._setSelectionValues(0,t,l,e)},_setSelectionValues:function(e,t,l,s){var i,a,o,r=this,h=this.editMode,d=this.lastFocused,c=0,u=this.options;function f(){for(var e,t,s;;){if(c>=i.length||!a.length){(s=n(r.lastEditModeCell)).removeClass(U),h?s.length&&r._deactivateCell(s):r.setEditMode(!1),r.setSelection(i),n(d).trigger("focus"),l&&l();break}if(c>0&&(o=u.selectCells?i[c]:i[c].children()),c+=1,e=o.first().parent().attr(Le),r.model.allowEdit(r.model.getRecord(e))){t=o.first(),!u.selectCells&&u.rowHeader!==we&&o.length>=2&&(t=o.eq(1)),r.activateRow(t,(function(){setTimeout(p,0)}));break}}}function p(){var e;function t(){var e,t,l,s=[];for(e=0;e<a.length;e++)t=a[e],r.activateCell(o.eq(t.index))&&(l=t.item.reinit(t.value,t.displayValue))&&s.push(l);if(s.length>0)for(let e=0;e<s.length;e++)s[e]();setTimeout(f,0)}r.activeLockCount>0?(e=r.activeUnlockCallback,r.activeUnlockCallback=function(){e&&e(),t()}):t()}return!((i=this.getSelection()).length<=e)&&(t||(t=[],u.selectCells?this.getSelectedRange().columns.forEach((function(e){e&&t.push(e)})):this.columns.forEach((function(e){var l=e.property;!l||e.hidden||e.virtual||e.noCopy||r.model.isIdentityField(l)||!e.elementId||e.readonly||t.push(l)}))),o=u.selectCells?i[c]:i[c].children(),this.activateRow(o.first(),(function(){a=[],o.each((function(l){var i,o,h,d=n(this),c=r._getColumnMetadata(d);c&&t.indexOf(c.property)>=0&&c.elementId&&(o={index:l,item:i=r.columnItems[c.property].item},1===e?(o.value=i.getValue(),h=i.displayValueFor(o.value),o.value!==h&&(o.displayValue=h)):s.v&&s.d?(o.value=s.v,o.displayValue=s.d):o.value=s,a.push(o))})),f()})),!0)},resize:function(){var e,t,l,s=this.element,i=this.options,a=s.height(),o=s.width(),n=s.children(c),r=s.children(u);null!==s[0].offsetParent&&(r.length&&!this.pendingRefresh?(l=this.tableData$.prev().height(),s.find(".a-GV-bdy .a-GV-table").css("margin-top",-(l+it(this.tableHeader$.find("th").first().css("border-bottom-width")))),e=o,s.find(".a-GV-w-scroll,.a-GV-w-hdr").width(e),i.hasSize&&(t=a-n.height()-this._footerHeight(),r.children(p).addBack().height(t)),this._calculateColumnWidths(null,!0,i.hasSize||this.tableData$.parent().width()>e),this._initPageSize()):this.refresh())},expandControlBreak:function(e){this._expandCollapseControlBreak(e,!0)},collapseControlBreak:function(e){this._expandCollapseControlBreak(e,!1)},getColumns:function(){return this.columns},refreshColumns:function(){this.columnsStale=!0},setColumnWidth:function(e,t){var l=this._updateColumnWidth(e,t,!0);this._trigger("columnResize",null,{header$:l[1],column:l[0],width:t})},hideColumn:function(e){var t=this._columnName(e);this.options.columns[0][t].hidden=!0,this._refreshGrid()},showColumn:function(e){var t=this._columnName(e);this.options.columns[0][t].hidden=!1,this._refreshGrid()},freezeColumn:function(e){var t,l,s=this.columns,i=this._columnName(e);for(t=0;t<s.length&&(l=s[t],t<s.length-1&&(l.frozen=!0),l.property!==i);t++);this._refreshGrid()},unfreezeColumn:function(e){var t,l,s=this._columnName(e);for(t=this.columns.length-1;t>=0&&((l=this.columns[t]).frozen=!1,l.property!==s);t--);this._refreshGrid()},moveColumn:function(e,t){var l=this._moveColumn(e,t);this._refreshGrid(),l.header$=this._columnFromIndex(t),this._trigger(Fe,null,l)},moveColumnGroup:function(e,t,l){var s,i,a,o,n,r,h,d=[];if(!(a=this.columnGroups[e]))throw new Error("Invalid column group level: "+e);for(o=-1,s=0;s<a.length;s++)i=a[s],s===t&&(o=i.start,n=i.end),s===l&&(r=-1===o?i.start:i.end);if(l>t)for(s=o;s<=n;s++)(h=this._moveColumn(this.columns[o],r)).newPosition=r-(n-s),h.oldPosition=s,d.push(h),this._updateColumns();else for(s=n;s>=o;s--)(h=this._moveColumn(this.columns[n],r)).newPosition=r+(s-o),h.oldPosition=s,d.push(h),this._updateColumns();for(this._refreshGrid(),s=0;s<d.length;s++)(h=d[s]).header$=this._columnFromIndex(h.newPosition),this._trigger(Fe,null,h)},_refreshGrid:function(){var e;(e=this.element.find(ee)).length&&this._deactivateCell(e),this.refreshColumns(),this.refresh()},_cellFromColumn:function(e,t){var s,i,a=this.columns,o=this.options,n=null,r=0;if(!o.columns[0][t])return l.warn("Warning column not found "+t),null;for(o.rowHeader!==we&&(r=1),s=0;s<a.length;s++)if(!(i=a[s]).hidden){if(i.property===t){n=e.children().eq(r);break}r+=1}return s>=a.length&&l.warn("Warning column is hidden "+t),n},_columnFromIndex:function(e){return this.element.find(".a-GV-header[data-idx='"+e+"']")},_columnName:function(e){var t;if(t="object"==typeof e?e.property:e,!this.options.columns[0][t])throw new Error("Unknown column: "+t);return t},_moveColumn:function(e,t){var l,s,i,a,o=this.columns,n=this._columnName(e);for(i=-1,l=0;l<o.length;l++)if((s=o[l]).property===n){i=l;break}if(a=o[t].seq,i!==t){if(i<t)for(l=t;l>i;l--)o[l].seq=o[l-1].seq;else for(l=t;l<i;l++)o[l].seq=o[l+1].seq;return o[i].frozen=t<=this.lastFrozenColIndex,o[i].seq=a,{column:s,newPosition:t,oldPosition:i}}},_updateColumns:function(){let e,t,l,s,i,a,o,n,r,h,d,c,u,f={},p=this.options,m=p.columns[0];this.columns=[],this.columnsStale=!1,this.columnGroups=[],this.breakColumns=[],this.fieldToColumnIndex={};for(const[e,t]of Je(m))t.property=e,t.domId=t.elementId?t.elementId+"_HDR":this.idPrefix+"_h_"+t.property,t.seq=t.seq||"0",this.columns.push(t);for(this.columns.sort((function(e,t){return e.seq-t.seq})),this.lastFrozenColIndex=-1,u=p.rowHeader!==we?1:0,e=0;e<this.columns.length;e++)if(l=this.columns[e],!l.hidden){if(!l.frozen)break;u<20&&(u+=1,this.lastFrozenColIndex=e)}for(this.endFrozenColIndex=-1,e=this.columns.length-1;e>0;e--)if(l=this.columns[e],!l.hidden){l.frozen&&(this.endFrozenColIndex=e);break}for(h=p.rowHeader!==we?1:0,e=0;e<this.columns.length;e++)l=this.columns[e],l.controlBreakIndex>0&&this.breakColumns.push(l),l.hidden||(this.fieldToColumnIndex[l.property]=h,h+=1);for(this.breakColumns.sort((function(e,t){return e.controlBreakIndex-t.controlBreakIndex})),i=null,o=null,n=null,d=!0,h=0,a=0,t=0,c=[],e=0;e<this.columns.length;e++)if(l=this.columns[e],!l.hidden){if(null===i&&(i=[],this.columnGroups.push(i)),r=St(l),r!==o||e===this.lastFrozenColIndex+1){if(o=r,n&&(n.span=h-a,n.end=t,n.children=c,c=[]),a=h,r){if(n=Ze({},p.columnGroups[r]),!n)throw new Error("Unknown column group name: "+r);n.heading&&(d=!1,f[r]||(n.domId=this.idPrefix+"_g_"+r)),n.property=r,i.push(n)}else n={},i.push(n);n.start=e,e<=this.lastFrozenColIndex&&(n.frozen=!0,f[r]=1)}c.push(l),h+=1,t=e,null===n&&(n={start:e},this.lastFrozenColIndex>=0&&(n.frozen=!0),i.push(n))}for(n&&(n.span=h-a,n.end=t,n.children=c),d&&(this.columnGroups=[],i=null);i;){for(s=i,i=null,o=null,n=null,d=!0,h=0,c=[],e=0;e<s.length;e++){if(l=s[e],r=l.parentGroupName||null,r!==o||l.frozen!==(!!n&&n.frozen)){if(o=r,null===i&&(i=[],this.columnGroups.unshift(i),h>0&&(n={},l.frozen&&(n.frozen=!0),i.push(n))),n&&(n.span=h-a,n.children=c,c=[]),a=h,r){if(n=Ze({},p.columnGroups[r]),!n)throw new Error("Unknown column group name: "+r);n.heading&&(d=!1,f[r]||(n.domId=this.idPrefix+"_g_"+r)),n.property=r,i.push(n)}else n={},i.push(n);n.start=l.start,l.frozen&&(n.frozen=!0,f[r]=1)}c.push(l),n.end=l.end,h+=l.span}n&&(n.span=h-a,n.end=l.end,n.children=c),d&&(this.columnGroups.shift(),i=null)}},_initGrid:function(){var t,s,i,a,r,h,d,m,g,C,v,_=0,b=0,w=null,x=this,H="scroll.gvss",S=this.options,y=this.element;function R(){_!==b&&(t[0].scrollLeft=_=b,s[0].scrollLeft=_,C.css(Qe,_)),w=null}function k(){var e=x.element.find(ee);x.floatingItem$.hasClass(J)?x._collapseFloatingItem(e):x._expandFloatingItem(e)}l.info("Grid render and initialize."),this._updateColumns(),this.columnItems||this._initColumnItems(this.columns),this._renderGrid(),y.find(".a-GV-hdr :tabbable").prop(Be,-1),S.tooltip&&this._initTooltips(S.tooltip),S.rowHeader!==we&&S.rowHeaderCheckbox&&(this.tableHeader$.parent().addClass($),this.tableData$.parent().addClass($)),t=y.find(f),s=y.find(p),m=(i=y.children(u)).find("col"),g=i.find("thead").find(".a-GV-header"),v=this.tableData$.parent().width()-e.getScrollbarSize().width,t.add(s).width(v),m.each((function(e){var t=n(this),l=x.columns[t.attr(Ne)];l&&(l.width?l.curWidth=l.width:l.curWidth=l.defWidth=g.eq(e).width(),l.curWidth<Ve&&(l.curWidth=Ve))})),C=this.tableData$.parent().parent().find(".a-GV-loadMoreButton"),s.on(H,(function(){b=this.scrollLeft,w||(w=st(R))})),t.on(H,(function(){b=this.scrollLeft,w||(w=st(R))})),r=this.element.find(W),this.tabTraps$=r,2===r.length?h=0:(3===r.length&&(h=1,d=0),r.eq(d).on("focus",(function(){n(this).hasClass(P)&&x._autoAddRecord(x.activeRecord)}))),r.eq(h).on("focus",(function(){var e,t,l=n(x.lastEditModeCell).closest("tbody").find(ve).add(x.lastEditModeCell),s=l.index(x.lastEditModeCell);s>0?(x.activateContext=-1,l.first().trigger("focus")):(e=n(ve),t=x.element.find(ve).first(),s=e.index(t),e.eq(s-1).trigger("focus"))})),r.eq(h+1).on("focus",(function(){var e,t,l=n(x.lastEditModeCell).closest("tbody").find(ve).add(x.lastEditModeCell),s=l.index(x.lastEditModeCell);n(this).hasClass(P)?x._autoAddRecord(x.activeRecord):s<l.length-1?(x.activateContext=-1,l.last().trigger("focus")):(e=n(ve),t=x.tableData$.find(ve).last(),s=e.index(t),e.eq(s+1).trigger("focus"))})),r.prop(Be,-1),S.reorderColumns&&this._initColumnReorder(),this.columnWidthHandle$=n(),S.resizeColumns&&this._initColumnResize(),this.columnControls$.on("click","button",(function(e){var t=n(e.target);x._sortChange(e,t.closest(I),t.closest("button").hasClass("js-asc")?"asc":"desc")})),this.floatingItem$.draggable({handle:".a-GV-cellMoveHandle",containment:"body",stop:function(e,t){var l=x._getColumnMetadata(x.element.find(ee)).property;x.lastFloatingPos[l]={left:t.position.left,top:t.position.top}}}).on("keydown",(function(e){var t=e.which;if(e.ctrlKey&&117===t)return k(),!1;112===t&&e.altKey?x._doHelpKey():t===tt.ESCAPE&&x._doEscapeKey(e)})).on("mousedown",(function(e){n(e.target).hasClass("a-GV-cellMoveHandle")&&x._clearDeactivate()})).on("focusin",(function(){x._clearDeactivate()})).on("focusout",(function(){x.lastEditModeCell&&x._beginDeactivate(n(x.lastEditModeCell))})).children(O).on(be,k),o.TouchProxy.addTouchListeners(this.floatingItem$[0]),this._initPagination(y.find(c),s),this.breakColumns.length>0&&S.collapsibleControlBreaks&&y.find(u).on("click",N,(function(){a=n(this).closest("."+V),x._expandCollapseControlBreak([a],!a.hasClass(J))}))},_initColumnReorder:function(){var e,t,l,s,i,a,r,h,d,u,p,m,g,C,v=this.element.hasClass(ue),_=this.element.find(c),b=this;_.append(this.columnMoveMarker$),C=it(b.columnHandle$.css("margin-left")),v&&(C=-C),b.columnHandle$.draggable({appendTo:this.element,containment:_,cursor:"move",cursorAt:v?{right:-2*C}:{left:0},axis:"x",helper:function(){var e=n("<div class='a-GV-header-dragHelper'></div>"),t=b.columnReorderCell$;return e.append(t.find(".a-GV-headerLabel,.a-GV-columnHandle").clone()).width(t.outerWidth()).height(t.outerHeight()),"fixed"===_.css("position")&&e.css("position","fixed"),e},start:function(o,c){let C=b.columnReorderCell$.outerHeight();b.columnControls$.hide(),b._trigger("cancelColumnHeader",o,{}),e=b.columnReorderCell$.parent().offset().top-b.element.offset().top,t=e+b.element[0].offsetTop,a=_.css("position"),h="absolute",r=102,d=-_.offset().left,"relative"!==a&&("fixed"===a&&(d=0,e=t=b.columnReorderCell$.parent()[0].offsetTop+_[0].offsetTop,h="fixed"),r=it(_.css("z-index"))+1),u=-b.columnMoveMarker$.width()/2,c.helper.css({top:t+"px",position:h,transform:"translateY("+C+"px)","z-index":r}),m=c.helper.outerWidth(),b.columnMoveMarker$.show().css({top:e+"px",left:b.columnReorderCell$.offset().left+d+(v?b.columnReorderCell$.width():0)+"px",position:h,height:C+"px","z-index":r}),b.columnReorderCell$.find(".a-GV-headerLabel,.a-GV-header-sort").hide(),b.columnHandle$.hide(),b.columnWidthHandle$.hide(),It((function(){b.columnReorderCancel=!0})),p=it(b.columnReorderCell$.attr(Ne)),b.hdrScrollParent=b.element.find(f)[0],g=b.hdrScrollParent.scrollLeft,l=[],i=null,(s=yt(b.columnReorderCell$)).children().each((function(){var e=n(this),t=!0,s=e.offset().left+d;e.parent().parent().parent().parent()[0]===b.hdrScrollParent&&(s+=g,t=!1),l.push({colIdx:it(e.attr(Ne)),start:s,end:s+e.outerWidth(),frozen:t})})),b.columnReordering=!0,b.columnReorderCancel=!1},drag:function(e){var t=b.hdrScrollParent.scrollLeft,s=it(b.columnMoveMarker$.css(Qe));function a(){var a,o,n,r=!1,h=e.pageX-C+d+b.hdrScrollParent.scrollLeft;for(a=0;a<l.length;a++)if(h>=(o=l[a]).start&&h<o.end){a!==i&&(i=a,n=v?(o.colIdx<p?o.end:o.start)+u:(o.colIdx<p?o.start:o.end)+u,o.frozen||(n-=b.hdrScrollParent.scrollLeft),s=n,t=b.hdrScrollParent.scrollLeft,b.columnMoveMarker$.css(Qe,n+"px"),r=!0);break}r||t===b.hdrScrollParent.scrollLeft||(n=s-(b.hdrScrollParent.scrollLeft-t),b.columnMoveMarker$.css(Qe,n+"px"))}b.columnReorderCancel?e.preventDefault():(a(),b._headerScrollCheck(e.pageX-C,m)?b.scrollTimerId||b._headerScrollStart(e.pageX-C,m,a):b.scrollTimerId&&b._headerScrollStop())},stop:function(){var e=null;null!==i&&(e=l[i].colIdx),isNaN(e)&&i+1<l.length&&(e=l[i+1].colIdx),isNaN(e)||(b.columnReordering=!1,b.columnReorderCell$.find(".a-GV-headerLabel,.a-GV-header-sort").show(),e===p&&(b.columnHandle$.show(),b.columnWidthHandle$.show(),b.columnControls$.show()),b.columnMoveMarker$.hide(),b.lastHoverCell=null,Ht(),b.scrollTimerId&&b._headerScrollStop(),b.columnReorderCancel||null===e||e===p||(b.columnReorderCell$.hasClass(H)?b.moveColumnGroup(mt(s),p,e):b.moveColumn(b.columns[p],e),b.focus()))}}),o.TouchProxy.addTouchListeners(b.columnHandle$[0])},_initColumnResize:function(){var e,t,l,s=this,i=this.element.hasClass(ue)?-1:1,a=this.element.find(c),r=a.find(C).last();this.columnWidthHandle$=n("<div class='a-GV-columnWidthHandle'></div>").appendTo(a).css("top",r[0].offsetTop).height(r.height()),this.columnWidthHandle$.draggable({axis:"x",containment:a,start:function(i,a){s.columnWidthDragging=!0,s.columnWidthCancel=!1,s.columnWidthStartPos=a.position.left,s.columnWidthStartWidth=s.columnWidthCell$.first().outerWidth(),e=a.helper.outerWidth(),s.hdrScrollParent=s.element.find(f)[0],l=s.columnWidthCell$.parent().parent().parent().parent()[0]!==s.hdrScrollParent,t=s.hdrScrollParent.scrollLeft,It((function(){s.columnWidthCancel=!0}))},drag:function(a,o){function n(e){var a,n,r=s.columnWidthStartWidth+i*(o.position.left-s.columnWidthStartPos);a=s.hdrScrollParent.scrollWidth,l||(r+=s.hdrScrollParent.scrollLeft-t),r>Ve&&(s.columnWidthCell$.hasClass(G)?(s.rowHeaderWidth=r,s._calculateColumnWidths()):s._updateColumnWidth(s._getColumnMetadata(s.columnWidthCell$.first()),r)),(n=s.hdrScrollParent.scrollWidth-a)<0&&!e&&s.hdrScrollParent.scrollLeft!==t&&(s.hdrScrollParent.scrollLeft+=n,t+=n)}s.columnWidthCancel?a.preventDefault():(n(),s._headerScrollCheck(o.offset.left,e)?s.scrollTimerId||s._headerScrollStart(o.offset.left,e,(function(){n(!0)})):s.scrollTimerId&&s._headerScrollStop())},stop:function(e,a){var o=s.columnWidthStartWidth+i*(a.position.left-s.columnWidthStartPos);l||(o+=s.hdrScrollParent.scrollLeft-t),s.columnWidthDragging=!1,Ht(),s.scrollTimerId&&s._headerScrollStop(),s.columnWidthCancel&&(o=s.columnWidthStartWidth),o<Ve&&(o=Ve),s.columnWidthCell$.hasClass(G)?(s.rowHeaderWidth=o,s._calculateColumnWidths(null,!0)):s.setColumnWidth(s._getColumnMetadata(s.columnWidthCell$.first()),o)}}),o.TouchProxy.addTouchListeners(this.columnWidthHandle$[0])},_updateColumnWidth:function(e,t,l){var s,i,a,o=this._columnName(e);return(s=this.options.columns[0][o]).width=t,s.curWidth=t,a=this.columns.indexOf(s),i=this._columnFromIndex(a),this._calculateColumnWidths(i,l),[s,i]},_calculateColumnWidths:function(t,l,s){var i,a,o,r,h,d,c,f,m,g=this.options.hasSize,C=this.element,v=this;function _(e){var t,l;for(t=e+1;t<v.columns.length;t++)if(!(l=v.columns[t]).hidden&&!l.noStretch&&t!==m)return!1;return!0}function b(e,t){var l=0,s=0,i=t.parent().find("col");return e.parent().find("col").each((function(e){var t,a,o=n(this),r=o.attr(Ne);t=r?(a=v.columns[r]).curWidth:v.rowHeaderWidth,(0===e&&!a||a.frozen)&&e<20&&(C.css("--a-gv-frozen-offset-"+(e+1),s+"px"),s+=t),o[0].width=t,i[e].width=t,l+=t})),C.css("--a-gv-scroll-pad-start",s+"px"),t.parent().width(l),e.parent().width(l),l}if(s)for(i=0;i<this.columns.length;i++)(a=this.columns[i]).curWidth=a.width||a.defWidth,a.curWidth<Ve&&(a.curWidth=Ve);if(t&&(h=t.parent().parent()[0],m=it(t.attr(Ne))),o=h&&h!==this.tableHeader$[0]?this.tableData$.parent().width():b(this.tableData$,this.tableHeader$),l&&(r=C.find(p)[0].clientWidth,g&&0===this.tableData$.children().length&&(r-=e.getScrollbarSize().width),o<r)){if((r=r-o-1)>10)for(f=r,i=0;i<this.columns.length;i++)(a=this.columns[i]).hidden||a.frozen||a.noStretch||i===m||(_(i)?a.curWidth+=f:(c=Math.floor(r*(a.curWidth/o)),a.curWidth+=c,f-=c));else for(i=this.columns.length-1;i>0;i--)if(!((a=this.columns[i]).hidden||a.frozen||a.noStretch||i===m)){a.curWidth=a.curWidth+r;break}b(this.tableData$,this.tableHeader$)}g&&(d=C.children(u),this._adjustSizeForScrollBars(d.height(),d.find(p).width()))},_addFrozenClasses:function(e,t,l,s){if(l.frozen){let i=l.span||1;void 0===s&&(s=l.end),s===this.endFrozenColIndex?e+=" "+fe+" a-GV-frozen--end1"+ge:s<=this.lastFrozenColIndex&&(e+=" "+fe+" "+pe+t,s===this.lastFrozenColIndex&&(e+=" "+me),t+=i)}return[e,t]},_renderGrid:function(){let t,l,s,i,a=this,o=this.element,r=this.options,h=r.hasSize||r.stickyTop;const d=e.htmlBuilder(),c="<table role='presentation' class='a-GV-table'>",u="<thead role='rowgroup'>",f="<span class='js-tabTrap u-vh is-focusable' aria-hidden='true' tabindex='-1'></span>";function p(e){var t,l;for(r.rowHeader!==we&&e.markup("<col").optionalAttr("width",a.rowHeaderWidth).markup("/>"),t=0;t<a.columns.length;t++)(l=a.columns[t]).hidden||e.markup("<col").optionalAttr("width",l.width).attr(Ne,t).markup("/>")}function m(e,t){var l,o,n,h,d,c,u,f,p,m,g,C=a.columns;for(o=0;o<a.columnGroups.length;o++){for(f=a.columnGroups[o],g=1,e.markup("<tr class='a-GV-row' role='row'>"),r.rowHeader!==we&&(h="a-GV-headerGroup a-GV-selHeader "+fe+" "+pe+"1",a.lastFrozenColIndex<0&&(h+=" "+me),g+=1,e.markup(`<th role='columnheader' class='${h}'`),t&&e.markup(" style='visibility: hidden;'"),e.markup(">")),l=0;l<f.length;l++)n=f[l],h=H,h+=nt(n.headingAlignment||Xe,!0),[h,g]=a._addFrozenClasses(h,g,n),m=t?null:n.domId,e.markup("<th role='columnheader' ").attr(Te,h).attr(Pe,n.span).attr(Ne,l),t&&e.markup(" style='visibility: hidden;'"),e.markup(" tabindex='-1'><span class='a-GV-headerLabel'").optionalAttr("id",m).markup(">"+(n.heading||"")).markup("</span></th>");e.markup("</tr>")}for(e.markup("<tr class='a-GV-row' role='row'>"),g=1,r.rowHeader!==we&&(p=null,t&&(p="visibility: hidden;"),h="a-GV-header a-GV-selHeader "+fe+" "+pe+"1",a.lastFrozenColIndex<0&&(h+=" "+me),g+=1,e.markup(`<th role='columnheader' class='${h}'`).optionalAttr("style",p).markup("><span class='u-vh a-GV-headerLabel'").optionalAttr("id",t?null:a.idPrefix+"_shh").markup(">").content(ct("ROW_HEADER")).markup("</span>"),r.rowHeaderCheckbox&&r.multiple&&r.selectAll&&e.markup("<span class='u-selector' role='checkbox' aria-checked='false'").attr(Ae,ct("SELECT_ALL")).markup("></span>"),r.rowHeader===xe?e.markup("<span class='a-GV-rownum' aria-hidden='true'></span>"):r.rowHeader===Ie&&e.markup("<span class='a-GV-rowLabel'></span>"),e.markup("</th>")),l=0;l<C.length;l++)(n=C[l]).hidden||(h=x,h+=nt(n.headingAlignment||Xe,!0),n.isRequired&&(h+=" is-required"),n.elementId&&!n.readonly||(h+=" is-readonly"),n.headingCssClasses&&(h+=" "+n.headingCssClasses),[h,g]=a._addFrozenClasses(h,g,n,l),c=null,1===n.sortIndex&&("asc"===n.sortDirection?c="ascending":"desc"===n.sortDirection&&(c="descending")),p=null,t?(p="visibility: hidden;",m=null):m=n.domId,n.sortDirection&&(d=ut("asc"===n.sortDirection?"SORTED_ASCENDING":"SORTED_DESCENDING",s?n.sortIndex:"")),u=r.activateColumnHeader&&!n.noHeaderActivate,e.markup("<th role='columnheader' ").attr(Te,h).attr(Ne,l).optionalAttr("style",p).optionalAttr("aria-sort",i?c:null).optionalAttr("abbr",s?n.heading:null).markup(" tabindex='-1'><span class='a-GV-headerLabel'").optionalAttr("id",m).optionalAttr(We,u?"link":null).optionalAttr("aria-haspopup",u?"dialog":null).markup(`>${n.heading}</span>`),n.sortDirection&&(e.markup("<span class='a-GV-header-sort'").optionalAttr("aria-hidden",i).optionalAttr(We,s?"img":null).optionalAttr(re,s?d:null).markup("><span aria-hidden='true'").attr(Te,"a-Icon "+("asc"===n.sortDirection?"icon-irr-sort-asc":"icon-irr-sort-desc")).attr(Ae,d).markup("></span>"),s&&e.markup("<span aria-hidden='true'>").content(n.sortIndex).markup("</span>"),e.markup("</span>")),e.markup("</th>"));e.markup("</tr>")}for(l=0,t=0;t<this.columns.length;t++)this.columns[t].sortDirection&&(l+=1);i=1===l,s=l>1,d.markup(`<div class='a-GV-hdr${h?" a-GV-hdr--fixed":""}'><div class='a-GV-w-hdr'>${c}`),p(d),d.markup(u),m(d,!1),d.markup("</thead></table></div></div><div class='a-GV-bdy'>"),this._renderAltDataMessages(d,this.idPrefix),d.markup("<div class='u-vh'").attr("id",this.accContextId).markup("></div>"),d.markup(`<div class='a-GV-w-scroll' tabindex='-1'>${c}`),p(d),d.markup(u),m(d,!0),d.markup("</thead><tbody></tbody></table>"),this._renderLoadMore(d),d.markup("</div>"),r.autoAddRecord&&d.markup(f),d.markup("</div>"),r.editable&&d.markup(`<div class='a-GV-floatingItem' tabindex='-1' style='display: none;'><div class='a-GV-cellMoveHandle'></div><button type='button' class='a-GV-expandCollapse' tabindex='-1'><span aria-hidden='true' class='a-Icon'></span></button>${f}<div class='${z}'></div>${f}</div>`),this._renderFooter(d,this.idPrefix),r.columnSort&&(d.markup("<div class='a-GV-columnControls' style='display:none'>"),this._renderButton(d,"a-Button js-asc","icon-up-chevron",ct("SORT_ASCENDING")),this._renderButton(d,"a-Button js-desc","icon-down-chevron",ct("SORT_DESCENDING")),d.markup("</div>")),r.reorderColumns&&d.markup("<div class='a-GV-columnHandle' style='display:none'></div><div class='a-GV-colMoveMarker' style='display:none'><span class='a-GV-colMoveMarker-x'></span></div>"),this.floatingItem$&&this.floatingItem$.remove(),o.html(d.toString()),this._updateAccLabel(),this.pageKey=null,this.tableHeader$=o.find(".a-GV-hdr .a-GV-table>thead"),this.tableData$=o.find(".a-GV-table>tbody"),this._clearChildrenRowCache(),this.accContext$=n("#"+this.accContextId),this.columnControls$=o.find(".a-GV-columnControls"),this.columnControls$.find("button").attr(Ke,-1),this.columnHandle$=o.find(".a-GV-columnHandle"),this.columnMoveMarker$=o.find(".a-GV-colMoveMarker"),this.floatingItem$=o.find(L)},_updateAccLabel:function(){var e=this.origLabelBy;this.noData?e+=" "+this.idPrefix+"_msg":this.options.footer&&(e+=" "+this.idPrefix+"_pageRange "+this.idPrefix+"_status"),this.element.attr(he,e)},_calcSpanAllColumns:function(e){let t,l,s=this.lastFrozenColIndex>=0||this.options.rowHeader!==we,i=0;null!=e&&s?e?(t=0,l=this.lastFrozenColIndex+1,this.options.rowHeader!==we&&(i+=1)):(t=this.lastFrozenColIndex+1,l=this.columns.length):(t=0,l=this.columns.length);for(let e=t;e<l;e++)this.columns[e].hidden||(i+=1);return i},_getHeaderHeight:function(){return this.element.find(c).outerHeight()},_selectedCount:function(){var e=this.options;if(this.tableData$)return e.selectCells?this.tableData$.find(j).filter(v).length:e.persistSelection?this.model.getSelectedCount():this.tableData$.find("tr.is-selected").length},_selectedStatusMessage:function(){var e=this.options;return s.getMessage(e.selectCells?"APEX.GV.SELECTION_CELL_COUNT":e.selectionStatusMessageKey)},_deletedCount:function(){return this.tableData$.find("tr.is-deleted").length},_hasControlBreaks:function(){return this.breakColumns.length>0},_getFixedRecordHeight:function(){let e,t=this.tableData$.find(C).filter(Ce).first();return t.length?e=t.outerHeight():(t=n("<tr class='a-GV-row'><td class='a-GV-cell' style='visibility: hidden;'>T</td></tr>"),this.tableData$.append(t),e=t.outerHeight(),t.remove()),e},_getDataContainer:function(){return this.tableData$},_insertFiller:function(e,t){let l=n(e.toString());return t?t.last().before(l):this.tableData$.html(l),this._clearChildrenRowCache(),l},_insertData:function(e,t,l,s,i){var a,o,r,h,d=this.options,c=this;o=gt(e),s?s.last()[i](o):this.tableData$.append(o),this._clearChildrenRowCache(),this.allSelected&&(d.pagination.scroll&&!d.persistSelection?(r=o.map((function(e,t){return n(t).children()[0]})),h=this.focusInHeader,this.focusInHeader=!1,this._select(r,Ge,null,!1),this.focusInHeader=h):this._updateStatus()),!d.pagination.scroll&&d.persistSelection&&this._updateSelectAll(),d.hasSize&&(a=this.element.children(u),this._adjustSizeForScrollBars(a.height(),a.find(p).width())),this.gotoCellPending&&setTimeout((function(){c.gotoCell(c.gotoCellPending.record,c.gotoCellPending.column)}),0),this._super(e,t,l,s,i)},_controlBreakLabel:function(t){var l,s,i,a,o=this.options,n="",r=[];for(l=0;l<this.breakColumns.length;l++)s=this.breakColumns[l],l>0&&(n+=", "),i=this.model.getValue(t,s.property),r[l]=i,null===i&&(i=""),"object"==typeof i&&Ye(i,"d")?i=i.d:(a=this.columnItems[s.property])&&(i=a.item.displayValueFor(i)),""===i&&o.showNullAs&&(i=o.showNullAs),!1!==s.escape&&(i=e.escapeHTML(i)),(s.label||s.heading)&&(n+=`<span class='a-GV-breakLabel'>${s.label?e.escapeHTML(s.label):s.heading}:</span> `),n+=`<span class='a-GV-breakValue'> ${i}</span>`;return{label:n,values:r}},_renderBreakRecord:function(e,t,l,s){let i=l.label,a=this._getControlBreak(s+1,!0);a?t=a.expanded:(this.controlBreaks.push({offset:s+1,label:i,expanded:t,values:l.values}),this.controlBreaks.sort(pt)),this._renderBreakRow(e,t,i,s),this.controlBreakCollapsed=!t},_renderFillerRecord:function(e,t){e.markup(`<tr class='${t}'><td `).attr(Pe,this._calcSpanAllColumns()).markup("></td></tr>")},_renderRecord:function(e,t,l,s,i){this._renderRow(e,t,l,s,i)},_insertRecord:function(t,l,s,i,a){var o,r=e.htmlBuilder(),h=[];return!t&&this._hasControlBreaks()&&((t=n(this.lastFocused).closest("."+V)).length||(t=this.tableData$.find("."+V).first()),t&&this._expandCollapseControlBreak([t],!0),a="after"),this._renderRow(r,l,null,s,i),o=gt(r),h.push(o[0]),"after"===a&&t?t.after(o):this.tableData$.prepend(o),this._clearChildrenRowCache(),n(h)},_afterInsert:function(e,t){var l,s,i=!!this.element.find("."+U).length||n(document.activeElement).hasClass(P),a=e[0].find(".a-GV-cell").first();for(l=0;l<this.columns.length;l++)if(!(s=this.columns[l]).hidden&&!s.readonly&&this.columnItems[s.property]){a=bt(e[0],this.fieldToColumnIndex[s.property]);break}if(this._hasControlBreaks()&&!t&&e[0]){let t,i,a,o=e[0].prev().attr(ze);if(null!=o)for(t=this._getControlBreak(it(o)),i=this.model.getRecord(e[0].attr(Le)),a=t.values,l=0;l<this.breakColumns.length;l++)(s=this.breakColumns[l]).readonly||this.model.setValue(i,s.property,a[l])}setTimeout((()=>{this.focusInHeader=!1,this._select(a,null,i,!1,!1),i&&this.options.editable&&!this.editMode&&this.setEditMode(!0)}),0)},_updateRecordField:function(t,l,s,i){var a,o,n,r,h=this.fieldToColumnIndex[s],d=e.htmlBuilder();void 0!==h&&(a=bt(t,h),!this.editMode||l!==this.activeRecord||this.ignoreItemChange||i.agg||(o=this.columnItems[s])&&this._setColumnItemValue(o.item,l,s),a.hasClass(Z)||(n=this.options.columns[0][s],r=null,i.fields&&(r=i.fields[n.property]),d=e.htmlBuilder(),this._renderFieldDataValue(d,n,l,i,r),a.html(d.toString())))},_checkAllHidden:e.debounce((function(){const e=this.options.pagination;this.tableData$.children(g).is(":visible")?!e.scroll||e.loadMore||e.virtual||this.tableData$.height()<this.scrollParent$.height()&&this._addNextPage():(this.noData$.show(),this.noData$.parent().children().not(d).hide(),this.noData=!0)}),10),_updateRecordState:function(e,t,l,s,i){const a=this.options,o=!this.tooltipOptions;let n=ht(s,a,e.hasClass(q),this.model,l);if(e.attr(Te,n),"hidden"===i)return this.noData&&!s.hidden&&(this.noData$.hide(),this.noData$.parent().children().not(d).show(),this.noData=!1),void(this.noData||this._checkAllHidden());if(o&&(s.message?e.first().find(D).attr(Ae,s.message):e.first().find(D).removeAttr(Ae)),s.fields)for(const[t,i]of Je(s.fields)){let r,h=this.fieldToColumnIndex[t];void 0!==h&&(r=bt(e,h),n=dt(a.columns[0][t],s,i,a,r,this.model,l),r.attr(Te,n),o&&(i.message&&!s.deleted?r.attr(Ae,i.message):r.removeAttr(Ae)))}},_removeRecord:function(e){e.remove()},_identityChanged:function(e,t){this._elementsFromRecordIds([e])[0].attr(Le,t),this.activeRecordId===e&&(this.activeRecordId=t)},_replaceRecord:function(t,l,s,i,a){var o,r,h,d,c,u,f,p,m=null,g=null,C=[],v=t.children().first().find(".a-GV-rownum").text()||null,_=e.htmlBuilder();v&&(v=it(v)-1),this.activeRecordId===s&&(this.activeRecord=this.activeRecordId=null),r=t.hasClass(q),(h=t.find(this.lastFocused).length)&&(c=Ct(p=this.lastFocused).hasClass(U)),(d=t.find(this.lastEditModeCell).length&&n(this.lastEditModeCell).hasClass(U))&&(p=this.lastEditModeCell),p&&(m=0,g=mt(vt(p))),this._renderRow(_,l,v,i,a),o=gt(_),C.push(o[0]),t.last().replaceWith(o),this._clearChildrenRowCache(),o=n(C),r&&o.add(o.find(".a-GV-selHeader .u-selector")).addClass(q).attr(ae,!0),d?this._activateCell(bt(o.eq(m),g)):h&&(f=bt(o.eq(m),g),u=this._getCellFocusable(f),this._setFocusable(u),this._setCurrentRow(f[0]),c&&this._setFocus(u))},_removeFocus:function(e){var t,l,s;((t=n(this.lastFocused).closest(C))[0]===e[0]||e.length>1&&t[0]===e[1])&&(l=_t(this.lastFocused),(s=this._getNextCellDown(l,1))||(s=this._getPrevCellUp(l,1)),s&&this._select(s,null,!0,!1))},_elementsFromRecordIds:function(t){let l=[];for(let s=0;s<t.length;s++){let i=this.tableData$[0].querySelector(`[data-id="${e.escapeCSS(t[s])}"]`);i&&l.push(n(i))}return l},_renderBreakRow:function(e,t,l,s){let i=this.lastFrozenColIndex>=0||this.options.rowHeader!==we,a=E;if(i&&(a+=" "+fe+" "+pe+"1"),e.markup(`<tr role='row' class='a-GV-controlBreak${t?" is-expanded":""}'`).optionalAttr(ze,null!=s?s+1:null).markup(`><th role='rowheader' class='${a}'`).attr(Pe,this._calcSpanAllColumns(!0)).markup(">"),this.options.collapsibleControlBreaks){let l,s;t?(l="icon-down-arrow",s=ct("BREAK_COLLAPSE")):(l="icon-right-arrow",s=ct("BREAK_EXPAND")),this._renderButton(e,"a-Button js-toggleBreak",l,s,t)}e.markup("<span class='a-GV-controlBreakLabel'>").markup(l).markup("</span></th>"),i&&e.markup(`<th role='rowheader' class=${E} colspan=${this._calcSpanAllColumns(!1)}></th>`),e.markup("</tr>")},_getControlBreak:function(e,t){let l,s=null;return this.breakColumns.length>0&&(l=ft(this.controlBreaks,{offset:e},pt),s=this.controlBreaks[l],t||s&&s.offset===e||(s=this.controlBreaks[l-1])),s},_renderRow:function(e,t,l,s,i){var a,o,n,r,h,d,c,u,f=1,p=null,m=null,g=null,C=this.options,v=this.columns,_=!this.tooltipOptions;for(n=ht(i,C,null,this.model,t),i.agg?p=i.grandTotal?C.aggregateLabels[i.agg].overallLabel:C.aggregateLabels[i.agg].label:!i.deleted&&i.message&&_&&(m=i.message),d=void 0!==i.serverOffset?i.serverOffset+1:"",null===this.controlBreakCollapsed&&this._hasControlBreaks()&&(this.controlBreakCollapsed=!1,(u=this._getControlBreak(d))&&(u.expanded||this._controlBreakLabel(t).label!==u.label||(this.controlBreakCollapsed=!0))),e.markup("<tr role='row'").attr(Le,s).optionalAttr(ze,d).attr(Te,n).optionalAttr(Ae,p).optionalAttr(ae,i.sel?He:null).optionalAttr("style",this.controlBreakCollapsed&&!i.agg?"display:none;":null).markup(">"),C.rowHeader!==we&&(c=i.agg||C.rowHeader===Ie,n="a-GV-cell a-GV-selHeader "+fe+" "+pe+"1",c&&(n+=" "+y),this.lastFrozenColIndex<0&&(n+=" "+me),f+=1,e.markup("<th role='rowheader'").attr(Te,n).optionalAttr(Ae,m).markup(">"),i.agg||(C.rowHeaderCheckbox&&(r=C.multiple?R:"u-selector u-selector--single",i.sel&&(r+=" "+q),e.markup(`<span class='${r}'`).attr(Ae,ct("SELECT_ROW")).markup("></span>")),C.rowHeader===xe&&e.markup("<span class='a-GV-rownum' aria-hidden='true'>").content(d).markup("</span>")),c&&(e.markup("<span class='a-GV-rowLabel'>"),i.agg?e.content(C.aggregateLabels[i.agg][i.grandTotal?"overallLabel":"label"]):C.rowHeaderLabelColumn&&e.markup(this.model.getValue(t,C.rowHeaderLabelColumn)),e.markup("</span>")),e.markup("</th>")),a=0;a<v.length;a++)o=v[a],h=null,i.fields&&(h=i.fields[o.property]),o.hidden||(n=dt(o,i,h,C,null,this.model,t),g=null,_&&(h&&h.message?g=h.message:i.agg&&(g=C.aggregateTooltips[i.agg+"|"+o.property])),[n,f]=this._addFrozenClasses(n,f,o,a),e.markup("<td role='gridcell' tabindex='-1'").attr(Te,n).optionalAttr(Ae,g).markup(">"),this._renderFieldDataValue(e,o,t,i,h),e.markup("</td>"));e.markup("</tr>")},_getColumnMetadata:function(e){var t,l;if(e.hasClass(_))t=mt(e),l=this.tableHeader$.children().last().children().eq(t);else{if(!e.hasClass(x))return null;l=e}return t=it(l.attr(Ne)),isNaN(t)?null:this.columns[t]},_activateColumnHeader:function(e,t){var l=this._getColumnMetadata(t);l.noHeaderActivate||this._trigger("activateColumnHeader",e,{header$:t,column:l})},_activateRow:function(e){var t,l,s,i,a,o,n,r=e.parent(),h=r.attr(Le),d=this;for(i=this.model.getRecord(h),a=this.model.getRecordId(i),n=this.model.allowEdit(i),o=this.model.getRecordMetadata(a),r.addClass(Z),this._beginSetColumnItems(),t=0;t<this.columns.length;t++)s=this.columns[t].property,(l=this.columnItems[s])&&this._setColumnItemValue(l.item,i,s,n?o:null);this.activeRecord=i,this.activeRecordId=a,this._endSetColumnItems(),setTimeout((function(){d._triggerBeginEditing(d.activeRecord,d.activeRecordId)}),0)},_deactivateRow:function(t){var l,s,i,a,o,n,r=this.element.find(".a-GV-row.is-active");if(this.activeLockCount>0)this.activeUnlockCallback=t;else{if(r.removeClass(Z),(a=this.model.getRecordMetadata(this.activeRecordId))&&!a.deleted&&this.model.allowEdit(this.activeRecord))for(l=0;l<this.columns.length;l++){let t=this.columns[l];i=t.property,(s=this.columnItems[i])&&((n=s.item.isDisabled())?this.model.setValidity("valid",this.activeRecordId,i):s.item.getValidity().valid||this.model.setValidity("error",this.activeRecordId,i,s.item.getValidationMessage(e.escapeHTML(t.label||t.heading))),((o=a.fields?a.fields[i]:null)&&o.disabled||n)&&(o||(a.fields||(a.fields={}),o={},a.fields[i]=o),o.disabled=n))}this._triggerEndEditing(this.activeRecord,this.activeRecordId),this.activeRecord=null,this.activeRecordId=null,t()}},_beginDeactivate:function(e,t){var l=this;this.deactivateDelayTimer||(this.deactivateDelayTimer=setTimeout((function(){l.lastEditModeCell=null,l._deactivateCell(e),t&&(l.dontFocusEditableItem=!0,e.trigger("focus")),l.deactivateDelayTimer=null}),10))},_clearDeactivate:function(){this.deactivateDelayTimer&&(clearTimeout(this.deactivateDelayTimer),this.deactivateDelayTimer=null)},_setTabTraps:function(e){let t,l,s,i=this.options.autoAddRecord,a=i&&this.model.allowAdd(),o=this.tabTraps$;e.attr(Ke,-1),t=this._nextCellWithWrap(e).attr(Ke,0),this._prevCellWithWrap(e).attr(Ke,0),s=null,i?(s=0,l=2):l=1,null!==s&&(i&&this.onLastPage&&0===t.length&&a?o.eq(s).prop(Be,0).addClass(P):o.eq(s).prop(Be,t.length?0:-1).removeClass(P)),i&&this.onLastPage&&0===t.length&&a?o.eq(l).prop(Be,0).toggleClass("js-last",!t.length).addClass(P):o.eq(l).prop(Be,0).toggleClass("js-last",!t.length).removeClass(P)},_clearTabTraps:function(){this.element.find(".a-GV-cell[tabindex='0'],.a-GV-controlBreakHeader[tabindex='0']").attr(Ke,-1),this.tabTraps$.prop(Be,-1)},_activateCell:function(t,l,s){var i,a,o=this,r=!1,h=null,d=null,c=t.hasClass(E);function u(e){(l=l||o._getCellFocusable(e))!==e[0]&&l.focus()}function f(){let l=t.outerHeight();if((i=o._getColumnMetadata(t))&&(h=o.columnItems[i.property]),h&&o.model.allowEdit(o.activeRecord)&&!i.readonly&&!t.hasClass(te)){if(t.addClass(Z),(a=h.item.getPopupSelector())&&n(document.body).on("focusin.gridpopup",(function(e){n(e.target).closest(a).length&&o._clearDeactivate()})).on("focusout.gridpopup",(function(e){var t;n(e.target).closest(a).length&&(t=n(o.lastEditModeCell),o._beginDeactivate(t,!0))})),d=h.element$.height(),h.element$=h.element$.detach(),t.css("height",l+"px").empty(),d>l?(o.floatingItem$.children(B).append(h.element$),o._expandFloatingItem(t)):t.append(h.element$),o._activateColumnItem(h,i.domId),!o.dontFocusEditableItem&&!h.item.isDisabled()){h.item.setFocus();let l=document.activeElement;if("INPUT"===l.nodeName&&["text","search","password","tel","email","url"].includes(l.type.toLowerCase())){let i=n(l),a=l.value,r=o.element.hasClass(ue),h=t.css("text-align"),d=0;if(h===je?h=Oe:h===Ue&&(h=qe),s<0||0===a.length)l.setSelectionRange(0,a.length,r?"forward":"backward");else{if(null!=s){let l,r,c=n(`<span class="a-GV-cell" style="position:absolute;top:0;white-space:nowrap;">${e.escapeHTML(a)}</span>`);o.element.append(c),l=c.width(),r=l/a.length,(s-=h===qe?Math.max(0,t.outerWidth()-it(i.css("paddingRight"))-l):h===Xe?Math.max(0,(t.outerWidth()-it(i.css("paddingRight"))-l)/2):it(i.css("paddingLeft")))<0&&(s=0),d=Math.round(s/r),c.remove()}l.setSelectionRange(d,d)}}}o.dontFocusEditableItem=!1,r=!0,o._savedActivationtarget&&(o._interactWithCellItem(n.Event("activate",{target:o._savedActivationtarget}),t,i,h.item),o._savedActivationtarget=null)}else u(t)}if(this.lastEditModeCell=t[0],t.parent().hasClass(q)?this.lastRow$&&this.lastRow$.index(t)>=0||this._setCurrentRow(t[0]):this._select(t,null,!1,!1),this._setFocusable(t[0]),this._setTabTraps(t),!this.activeRecord||this.activeRecordId!==t.parent().attr(Le)){if(this.activeRecord)return void this._deactivateRow((function(){c?u(t):(o._activateRow(t),f())}));c?u(t):this._activateRow(t)}return c?u(t):f(),r},_checkInteractWithCellItem:function(e,t,l){var s,i=!1,a=this._getColumnMetadata(l),o=a&&this.columnItems[a.property];return o&&(o=o.item)&&o.getInteractionSelector&&(s=o.getInteractionSelector(),t.closest(s).length&&(e?(this._interactWithCellItem(e,l,a,o),i=!0):this._savedActivationtarget=t[0])),i},_interactWithCellItem:function(e,t,l,s){var i=t.parent().attr(Le),a=this.model.getRecord(i);"activate"===e.type?s.onInteraction(e):!this.model.allowEdit(a)||l.readonly||t.hasClass(te)||s.onInteraction(e,this.model,a,l.property)},_expandFloatingItem:function(e){var t,l,s,i=this.element.hasClass(ue)?"right top":"left top",a=e.outerWidth(),o=this._getColumnMetadata(e).property;this.floatingItem$.css("position","").css("min-width",a+"px").appendTo(Ee).show().addClass(J).draggable("enable").attr("data-owning-region",this.element[0].id).find(".a-GV-expandCollapse span").removeClass("icon-ig-expand").addClass("icon-ig-restore"),this.floatingItem$.children(B).show().css({width:"",height:""}),(s=this.lastFloatingPos[o])?this.floatingItem$.css({left:s.left,top:s.top}):this.floatingItem$.position({my:i,at:i,of:e,collision:"fit fit"}),this.floatingItem$.find(W).not(".js-last").attr(Ke,0),(t=this._getColumnMetadata(e))&&((l=this.columnItems[t.property]).item.isDisabled()||l.item.setFocus())},_collapseFloatingItem:function(e){var t=e.innerWidth(),l=e.innerHeight();this.floatingItem$.css({position:"relative",left:"",top:""}).appendTo(e).draggable("disable").removeClass("is-expanded ui-state-disabled").removeAttr("data-owning-region").find(".a-GV-expandCollapse span").removeClass("icon-ig-restore").addClass("icon-ig-expand"),this.floatingItem$.children(B).hide().width(t).height(l),this.floatingItem$.find(O).trigger("focus"),this.floatingItem$.find(W).not(".js-last").attr(Ke,-1)},_deactivateCell:function(t){var l,s,i,a,o=null;t.length<=0||(this._clearTabTraps(),this._setFocusable(t[0]),(l=this._getColumnMetadata(t))&&(o=this.columnItems[l.property]),o&&t.hasClass(Z)&&(n(document.body).off(".gridpopup"),this._setModelValue(t,o.item,this.activeRecord,l.property),a=null,(i=this.model.getRecordMetadata(this.activeRecordId)).fields&&(a=i.fields[l.property]),this.debugDontDeactivateCell?t.addClass(U+" "+Z):(this.floatingItem$.appendTo(Ee),this._deactivateColumnItem(o),this.floatingItem$.hide(),s=e.htmlBuilder(),this._renderFieldDataValue(s,l,this.activeRecord,i,a),t.html(s.toString()).css("height","")),this._updateRecordState(this.lastRow$.parent(),this.activeRecordId,this.activeRecord,i)))},_finishEditing:function(e){var t,l=n(this.lastEditModeCell);l.length&&(t=l.hasClass(U),this._clearDeactivate(),this._deactivateCell(l),t&&this._activateCell(l)),e.resolve()},_setFocus:function(e){e.tabIndex=0,e.focus()},_setFocusable:function(t){var l,s,i,a,o,r,h,d,c,u,f,p,m,g=this,_=this.options.tabbableCellContent,b=Ct(t);function w(e){var t,l,s,i;for(t=0;t<g.columnGroups.length;t++)for(s=g.columnGroups[t],l=0;l<s.length;l++)if((i=s[l]).property===e)return i;return null}if(this.lastFocused&&(n(this.lastFocused).removeAttr(he).closest(v).removeAttr("id"),s=Ct(this.lastFocused),b[0]!==s[0]&&s.add(s.find(_).not(_e)).prop(Be,-1)),d=(p=b.closest(C)).attr(ze),c=null,(b.hasClass(E)||b.hasClass(H))&&(c=this.lastColIndex),null===c&&(c=wt(b)),c+=1,p.hasClass(V)?(d+="b",u=ct("BREAK_CONTEXT")):p.hasClass(ie)?u=ct("AGG_CONTEXT"):b.hasClass(x)?u=ct("HEADER_CONTEXT"):b.hasClass(H)?u=ct("GROUP_CONTEXT"):(d!==this.curRowNum&&c!==this.curColNum?u=ut("ROW_COLUMN_CONTEXT",d,c):d!==this.curRowNum?u=ut("ROW_CONTEXT",d):c!==this.curColNum&&(u=ut("COLUMN_CONTEXT",c)),(m=this._getControlBreak(it(d)))&&m.offset!==this.curControlBreak&&(u=ct("BREAK_CONTEXT")+" "+e.stripHTML(m.label)+"."+u)),u&&this.accContext$.text(u+" "),i=0,b.children(".a-GV-columnItem")[0]||(i=b.find(_).not(_e).prop(Be,0).length),i||b.prop(Be,0),this.lastFocused=t,a="",d!==this.curRowNum&&(this.curRowHeaders&&n(this.curRowHeaders).removeAttr("id"),this.curRowHeaders="",(p=yt(b)).find("."+y).not(b).each((function(e){var t=g.idPrefix+"_rh_"+e;n(this).attr("id",t),a+=t+" ",g.curRowHeaders&&(g.curRowHeaders+=","),g.curRowHeaders+="#"+t}))),c!==this.curColNum&&!this.focusInHeader)if((l=this._getColumnMetadata(b))&&l.domId){for(o="",r=St(l);r;)(h=w(r))&&h.domId&&(o=h.domId+" "+o),r=h.parentGroupName;o+=l.domId,a+=o+" "}else b.hasClass(G)&&(a+=this.idPrefix+"_shh ");f=this.idPrefix+"_cur",a+=f,a=this.accContextId+" "+a,n(t).attr(he,a).closest(v).attr("id",f),this.curRowNum=d,this.curColNum=c,this.curControlBreak=m?m.offset:null},_getCellFocusable:function(e){var t=e.find(this.options.tabbableCellContent).not(_e);return t.length?t[0]:e[0]},_getPrevCellUp:function(e,t,l){var s,i=null,a=null;return(e.hasClass(E)||e.hasClass(H))&&(a=this.lastColIndex),null===a&&(a=wt(e),this.lastColIndex=a),e.closest(C).prevAll(Ce).each((function(e){let i=n(this);return i.hasClass(w)?(l=!0,!1):(s=i,e<t-1)})),this.focusInHeader||l||s||(this.focusInHeader=!0,s=this.tableHeader$.children().last()),s&&(i=s.hasClass(V)?e.hasClass(fe)?s.children().first():s.children().last():bt(s,a)),i},_getNextCellDown:function(e,t){var l,s,i=null,a=null;return(e.hasClass(E)||e.hasClass(H))&&(a=this.lastColIndex),null===a&&(a=wt(e),this.lastColIndex=a),s=0,e.closest(C).nextAll(Ce).each((function(e){let i=n(this);return s+=1,!i.hasClass(w)&&(l=i,e<t-1)})),this.focusInHeader&&(!l||s<t)&&(this.focusInHeader=!1,l=this.tableData$.children().first()),l&&(i=l.hasClass(V)?e.hasClass(fe)?l.children().first():l.children().last():bt(l,a)),i},_copy:function(e){const t=this.model,l=this.options,s=l.dataTransferFormats,i=(e,t,l)=>{let s=l,i=!!e&&e.copyValueToClipboard;return"function"==typeof i?s=i(e,t,l):!0===i&&(s=t,s.d&&(s=s.d)),""+s};if(l.selectCells){let e=[],a=this.getSelectedRange();if(!a||!a.values.length)return;e=a.columns.map((function(e){return e?l.columns[0][e]:null})),s.forEach((l=>{l.writer.begin(t,a,e)}));for(let l=0;l<a.values.length;l++){let o,n,r=a.recordIds[l],h=null!==r?t.getRecord(r):null;s.forEach((e=>{e.writer.beginRow(l,h,r)})),o=a.values[l];for(let l=0;l<o.length;l++)n=h&&e[l]?t.getValue(h,e[l].property):"",s.forEach((t=>{t.writer.cell(l,e[l],n,i(e[l],n,o[l]))}));s.forEach((e=>{e.writer.endRow()}))}}else{let e=this.getSelection();if(!e.length)return;{let a=[];l.rowHeader!==we&&a.push(null),this.getColumns().forEach((function(e){e.hidden||a.push(e)})),s.forEach((l=>{l.writer.begin(t,e,a)}));for(let l=0;l<e.length;l++){let o,n,r=e[l],h=r.first().attr(Le),d=null!==h?t.getRecord(h):null;s.forEach((function(e){e.writer.beginRow(l,d,h)})),o=r.children();for(let e=0;e<o.length;e++)n=d&&a[e]?t.getValue(d,a[e].property):"",s.forEach((t=>{t.writer.cell(e,a[e],n,i(a[e],n,o.eq(e).text()))}));s.forEach((e=>{e.writer.endRow()}))}s.forEach((e=>{e.writer.end()}))}}s.forEach((t=>{t.writer.end(),e.setData(t.format,t.writer.toString())}))},_setSelectionMode:function(){var e=this.options,t=this.element.children(u).find(j);this.element.toggleClass("a-GV--selectCells",e.selectCells),t.removeClass(q).removeAttr(ae),e.persistSelection&&this.model.clearSelection(),this.allSelected=!1,this.lastFocused&&t[0]&&this._select(n(this.lastFocused),null,!1)},_select:function(t,l,s,i,a){let o,r,h,d,c,f,p,v,_,b,w,x,I,H,S=!1,y=null,R=this.options,$=ye;const G=(e,t)=>{const l=e=>{e.each(((e,l)=>{let s=n(l).attr(Le);s&&this.model.setSelectionState(s,t,$)}))};R.persistSelection&&!S&&(l(e),$!==ke&&e.length>1&&l(_.first()))};if(l===Re||R.allowSelectHidden||(t=t.filter(Ce)),v=t.parent(C),w=this.lastRow$&&this.lastRow$.index(t.first())>=0,l&&(R.selectCells&&R.multipleCells||!R.selectCells&&R.multiple)&&("string"==typeof l?$=l:"click"===l.type?l.ctrlKey||l.metaKey?$=ke:l.shiftKey&&($=$e):"keydown"===l.type&&(l.which===tt.SPACE?$=l.ctrlKey?ke:l.shiftKey?$e:Ge:l.ctrlKey?$=De:l.shiftKey&&($=$e)),R.selectCells&&$!==$e&&($=ye),l.target||(l=null)),R.persistSelection&&(H=this.model.getSelectionState().rangeAnchor),$===Me?(S=!0,$=ye):$!==$e||(this.selectAnchor||H)&&!this.focusInHeader||($=ye),!this.focusInHeader)if($!==ye&&$!==$e||(x=this.element.children(u).find(R.selectCells?"td.is-selected,th.is-selected":"tr.is-selected"),R.rowHeaderCheckbox&&x.find(k).removeClass(q),x.removeClass(q).removeAttr(ae),R.persistSelection&&this.model.clearSelection()),R.selectCells)if($===$e){let e,l,s=n(this.selectAnchor);r=mt(s.parent()),h=mt(t.last().parent()),r>h&&(f=h,h=r,r=f),d=mt(s),c=mt(t.last()),d>c&&(f=c,c=d,d=f),e=d,l=c+1,this.tableData$.children().each(((t,s)=>{var i=n(s);if(t>h)return!1;t>=r&&i.hasClass(m)&&!i.hasClass(ie)&&(R.allowSelectHidden||i.is(Ce))&&i.children().slice(e,l).addClass(q).attr(ae,!0)}))}else t.addClass(q).attr(ae,!0),this.selectAnchor=t[0];else{if(R.persistSelection&&S&&this.model.setSelectionState(null,!0,Me),o=v.hasClass(q),_=v.filter(g).not(".is-aggregate"),$===ye||$===Ge||$===ke&&!o)_.addClass(q).attr(ae,!0),G(_,!0),this.selectAnchor=_[0],y=!0;else if($===$e){let e,t=n(this.selectAnchor),l=v.last();if(r=this._rowIndex(t),R.persistSelection){let l=this.model.getRecordMetadata(H);l&&l.serverOffset&&(e=l.serverOffset+1,e!==it(t.attr(ze))&&(r=-1))}if(h=this._rowIndex(l),r<0){let s=e||it(t.attr(ze)),i=it(l.attr(ze));if(R.pagination.virtual){let e=this.tableData$.find(".a-GV-scrollFiller").toArray();if(i>s)for(let l=0;l<e.length&&(t=n(e[l]).next(),!(it(t.attr(ze))>s));l++);else for(let l=e.length-1;l>=0&&(t=n(e[l]).prev(),!(it(t.attr(ze))<s));l--);r=this._rowIndex(t)}else!R.pagination.scroll&&R.persistSelection&&(t=this.tableDataChildren$[i>s?"first":"last"](),r=this._rowIndex(t))}R.persistSelection&&(l.hasClass(V)&&(l=l[r>h?"next":"prev"]()),G(l,!0)),r>h&&(f=h,h=r,r=f),h+=1,b=[],this.tableDataChildren$.slice(r,h).each((function(e,t){let l=n(t);l.hasClass(m)&&!l.hasClass(ie)&&(R.allowSelectHidden||l.is(Ce))&&b.push(t)})),_=n(b),_.addClass(q).attr(ae,!0),y=!0}else($===ke&&o||$===Re)&&(_.removeClass(q).removeAttr(ae),G(_,!1),this.selectAnchor=_[0],y=!1);null!==y&&R.rowHeaderCheckbox&&_.find(k).toggleClass(q,y),R.multiple&&R.selectAll&&this._updateSelectAll()}t.length>0&&null!==s&&(p=this._getCellFocusable(t.first()),s?this._setFocus(p):this._setFocusable(p),w||this._setCurrentRow(t[0])),R.persistSelection&&(this.hasSelection=this.model.getSelectedCount()>0),this.focusInHeader||$!==ke&&$!==Re&&($!==$e||!R.selectCells&&o)&&$!==Ge&&($!==ye||!R.selectCells&&e.arrayEqual(x,_))||(I=!(a||R.navigation&&l&&"click"===l.type),i?this._selNotifyLongDelay(I,l):this._selNotifyDelay(I,l))},_selChangeNotify:function(e,t){this.element.hasClass(r)&&(this._updateStatus(),e&&this._trigger("selectionChange",t))},_getAllRows:function(){let e=this.tableData$.children(g).not(".is-aggregate");return this.options.allowSelectHidden||(e=e.filter(Ce)),e},_updateSelectAll:function(){let e,t=this.options;if(t.persistSelection){let t=this.model.getSelectionState();e=t.selectAll&&0===t.except.length}else{let t=this._getAllRows();e=t.length>0&&t.length===t.filter(j).length}this.allSelected=e,t.rowHeaderCheckbox&&this.tableHeader$.find(k).first().toggleClass(q,e).attr(ce,e?He:Se).closest(D).toggleClass(q,e)},_clearChildrenRowCache:function(){this.tableDataChildren$=null},_rowIndex:function(e){return e.parents(u).length?(this.tableDataChildren$||(this.tableDataChildren$=this.tableData$.children()),this.tableDataChildren$.index(e)):mt(e)},_setCurrentRow:function(e){this.lastRow$=yt(n(e)).children()},_fireActivate:function(e,t){var l=yt(t);this._trigger("activateCell",e,{cell$:t,row$:l})},_nextCellWithWrap:function(e){let t,l=this.options.skipReadonlyCells;function s(e){let t,s=e.next();return s.length||(t=e.closest(C),t=t.next(),s=function(e){for(;l&&e.hasClass(ie)||e.not(Ce).length;)e=e.next();return e.children().first()}(t)),s}if(t=s(e),l)for(;t.hasClass(te);)t=s(t);return t},_prevCellWithWrap:function(e){let t,l=this.options.skipReadonlyCells;function s(e){let t,s=e.prev();return s.length||(t=e.closest(C),t=t.prev(),s=function(e){for(;l&&e.hasClass(ie)||e.not(Ce).length;)e=e.prev();return e.children().last()}(t)),s}if(t=s(e),l)for(;t.hasClass(te);)t=s(t);return t},_clearHoverStates:function(){this.element.find(Q).removeClass(X),this.columnControls$.hide(),this.columnHandle$.hide()},_setRowHoverState:function(e){this.element.find(Q).removeClass(X),(e=yt(e.children().eq(0))).addClass(X)},_sortChange:function(e,t,l){var s,i="set",a=this._getColumnMetadata(t);a.canSort&&(s=l===a.sortDirection,this.options.columnSortMultiple&&e.shiftKey?(i="add",i=s?"remove":a.sortDirection?"change":"add"):s&&(i="clear"),this._trigger("sortChange",e,{header$:t,column:a,direction:l,action:i}))},_updateColumnControls:function(e){var t,l,s=!1,i=!1;"asc"===e.sortDirection?(t=ct("SORT_OFF"),l=ct("SORT_DESCENDING"),s=!0):"desc"===e.sortDirection?(t=ct("SORT_ASCENDING"),l=ct("SORT_OFF"),i=!0):(t=ct("SORT_ASCENDING"),l=ct("SORT_DESCENDING")),this.columnControls$.find(".js-asc").attr(Ae,t).attr(re,t).toggleClass(Z,s),this.columnControls$.find(".js-desc").attr(Ae,l).attr(re,l).toggleClass(Z,i)},_adjustSizeForScrollBars:function(t,l,s){var i=this.element.children().filter(c).children(f),a=function(e,t){let l=e.parent()[0],s={h:!1,v:!1};return e.outerHeight()+(t||it(e.css("margin-top")))>l.clientHeight&&(s.v=!0),e.outerWidth()>l.clientWidth&&(s.h=!0),s}(this.tableData$.parent(),s);a.h&&e.getScrollbarSize().height,a.v&&(l-=e.getScrollbarSize().width),i.width(l)},_headerScrollCheck:function(e,t,l){var s,i,a,o=0,r=this.hdrScrollParent;return r&&(a=n(this.hdrScrollParent).offset().left,this.element.hasClass(ue)?(e-t-a<10?o=-10:a+r.offsetWidth-e<10&&a+r.offsetWidth-e>0&&(o=10),l&&o&&((s=r.scrollLeft+o)>0?(r.scrollLeft=0,o=0):s>r.scrollWidth-r.clientWidth?(r.scrollLeft=r.scrollWidth-r.clientWidth,o=0):r.scrollLeft=s)):(a+r.offsetWidth-(e+t)<10?o=10:e-a<10&&e-a>0&&(o=-10),l&&o&&((s=r.scrollLeft+o)<0?(r.scrollLeft=0,o=0):s>r.scrollWidth-r.clientWidth?(r.scrollLeft=r.scrollWidth-r.clientWidth,o=0):r.scrollLeft=s)),i=!!o),i},_headerScrollStart:function(e,t,l){var s=this,i=0,a=[151,134,119,106,95,86,79,74,71];this.scrollTimerId&&this._headerScrollStop(),function o(){s.scrollTimerId=setTimeout((function(){s._headerScrollCheck(e,t,!0)?(l(),o()):s._headerScrollStop()}),a[i]),i<a.length-1&&(i+=1)}()},_headerScrollStop:function(){clearTimeout(this.scrollTimerId),this.scrollTimerId=null},_expandCollapseControlBreak:function(e,t){let l,s,i,a=[],o=[],r=this.options,h=!r.allowSelectHidden;function d(e,l){let o=n(l);if(o.hasClass(m)&&!o.hasClass(ie))!t&&h&&o.hasClass(q)&&a.push(o.children(v)[0]),o[t?"show":"hide"]();else{if(o.hasClass(V))return s=!0,!1;if(o.hasClass(w)){if(i=it(o.attr("data-start")),!t||"collapse"!==o.css("visibility"))return!1;o.css("visibility","").removeClass("is-hidden")}}}et(e)||(e=[e]);for(let l=0;l<e.length;l++){let a,n,h=e[l];h.hasClass(V)&&(o.push(h),s=!1,h.nextAll().each(d),n=this._getControlBreak(it(h.attr(ze)),!0),n&&(n.expanded=t),t?(a=ct("BREAK_COLLAPSE"),h.addClass(J).find(N).attr(de,He).attr(Ae,a).attr(re,a).children(".a-Icon").removeClass("icon-right-arrow").addClass("icon-down-arrow")):(a=ct("BREAK_EXPAND"),h.removeClass(J).find(N).attr(de,Se).attr(Ae,a).attr(re,a).children(".a-Icon").removeClass("icon-down-arrow").addClass("icon-right-arrow"),l===e.length-1&&r.pagination.scroll&&!r.pagination.loadMore&&(s?r.pagination.virtual?(this.lastScrollTop=null,this._scrollPage()):this.tableData$.height()<this.scrollParent$.height()&&this._addNextPage():r.pagination.virtual?i>=0&&(this.pageOffset=i,this._addPageOfRecords()):this._addNextPage())))}a.length&&(l=this.focusInHeader,this.focusInHeader=!1,this._select(n(a),Re,n(document.activeElement).closest(this.element[0]).length>0,null),this.focusInHeader=l),this._trigger("expansionChange",null,{type:"break",expand:t,rows$:o})},debugCellEdit:function(e){this.debugDontDeactivateCell=!!e}},apex.widget.contextMenuMixin)),n.ui.dialog&&n.widget("ui.dialog",n.ui.dialog,{_allowInteraction:function(e){return n(e.target).closest(L).length>0||this._super(e)}})}(apex.util,apex.model,apex.debug,apex.lang,apex.item,apex.clipboard,apex.widget.util,apex.jQuery);
!function(e,t,i,o,l,r,s){"use strict";const d="a-RV",n="a-RV--excludeHidden",a="a-RV--excludeNull",c="u-Form",u="u-Form-groupHeading",h="u-Form-fieldContainer",f="."+h,p=f+".is-active",m="u-Form-label",g="u-Form-inputContainer",v=".a-Form-error",R=".a-Alert",b="a-RV-field--hidden",E="is-focused",C="is-disabled",_="is-active",y="is-readonly",x="is-error",I="is-warning",V="is-error is-warning is-readonly",w=":tabbable",O="data-itemhelp",M=":visible",T="option",F="show",P="hide",A="record",S="table",D="tree",k="delete-record",N="duplicate-record",L="next-record",X="previous-record",$="exclude-null-values",H="exclude-hidden",z="insert-record",K="refresh-record",B="revert-record",U=Object.entries,W=s.extend,G=s.ui.keyCode;const q=[{align:"start",controls:[{type:"MENU",labelKey:"APEX.RV.SETTINGS_MENU",iconOnly:!0,icon:"icon-gear",menu:{items:[{type:"toggle",action:$},{type:"toggle",action:H}]}}]},{align:"end",controls:[{type:"STATIC",id:"status",label:""},{type:"BUTTON",iconOnly:!0,action:X},{type:"STATIC",id:"recordNumber",label:""},{type:"BUTTON",iconOnly:!0,action:L}]}];function j(e){var t=e.groupName||null;return t&&e.useGroupFor&&e.useGroupFor.indexOf("srv")<0&&(t=null),t}s.widget("apex.recordView",s.apex.tableModelViewBase,{version:"21.1",widgetEventPrefix:"recordview",options:{idPrefix:null,actionsContext:null,recordOffset:0,recordParent:null,showNullAs:"-",fields:null,fieldGroups:null,alwaysEdit:!1,skipDeletedRecords:!1,toolbar:q,showExcludeNullValues:!0,showExcludeHiddenFields:!0,formCssClasses:null,labelAlignment:"end",tabbableFieldContent:"a,button,input",modeChange:null,recordChange:null},_create:function(){var e=this,t=this.options,i=this.element;i.addClass(d),this._super(),delete this.firstPage,delete this.previousPage,delete this.nextPage,delete this.lastPage,delete this.loadMore,delete this.gotoPage,this.editMode=!1,this.fields=null,this.excludeNullValues=!1,this.excludeHiddenFields=!1,this.lastFocused=null,this.lastField=null,this.toolbar$=null,this.currentRecord=null,this.currentRecordId=null,t.actionsContext?this.actions=t.actionsContext:this.actions=r.createContext("recordView",i[0]),this.actions.remove([$,H,L,X,z,K,B,k,N]),this.actions.add([{name:$,labelKey:"APEX.RV.EXCLUDE_NULL",get:function(){return e.excludeNullValues},set:function(o){t.showExcludeNullValues&&(e.excludeNullValues=o,i.toggleClass(a,o))}},{name:H,labelKey:"APEX.RV.EXCLUDE_HIDDEN",get:function(){return e.excludeHiddenFields},set:function(o){t.showExcludeHiddenFields&&(e.excludeHiddenFields=o,i.toggleClass(n,o))}},{name:L,labelKey:"APEX.RV.NEXT_RECORD",shortcut:"Alt+Page Down",icon:"icon-next",action:function(){var i,o;if(e.modelShape===D){if(!(o=e._nextTreeRecord()))return;t.recordParent=o.parent,t.recordOffset=o.offset}else{if(!((i=e.model.getTotalRecords())<0||t.recordOffset+1<i))return;t.recordOffset+=1}e.direction=1,e.refresh(!1)}},{name:X,labelKey:"APEX.RV.PREV_RECORD",shortcut:"Alt+Page Up",icon:"icon-prev",action:function(){var i;if(e.modelShape===D){if(!(i=e._previousTreeRecord()))return;t.recordParent=i.parent,t.recordOffset=i.offset}else{if(!(t.recordOffset>0))return;t.recordOffset-=1}e.direction=-1,e.refresh(!1)}},{name:z,labelKey:"APEX.RV.INSERT",action:function(){if(t.editable)return e.model.insertNewRecord(e.modelShape===D?t.recordParent:null,e.getRecord()),e.actions.invoke(L),e.editMode||e.setEditMode(!0),e.focus(),!0}},{name:K,labelKey:"APEX.RV.REFRESH",action:function(){e.model.fetchRecords([e.getRecord()])}},{name:B,labelKey:"APEX.RV.REVERT",action:function(){t.editable&&e.model.revertRecords([e.getRecord()])}},{name:k,labelKey:"APEX.RV.DELETE",action:function(){t.editable&&e.model.deleteRecords([e.getRecord()])}},{name:N,labelKey:"APEX.RV.DUPLICATE",action:function(){if(t.editable){var i=e.getRecord();return e.model.copyRecords([i],null,i),e.actions.invoke(L),e.editMode||e.setEditMode(!0),e.focus(),!0}}}]),this._updateMenuActions(),this._initModel(t.modelName),this._on(this._eventHandlers),this.direction=1,this.refresh(),t.disabled&&this._setOption("disabled",t.disabled)},_eventHandlers:{resize:function(e){e.target===this.element[0]&&(this.resize(),e.stopPropagation())},dblclick:function(e){var t=this.options;s(e.target).closest(f).length&&!t.alwaysEdit&&t.editable&&!this.editMode&&(e.preventDefault(),this.setEditMode(!0))},click:function(e){var t=s(e.target).closest(".u-Form-label");t.length&&t.closest(f).find(w).first().trigger("focus")},keydown:function(e){var t,i,o=this.options,l=e.which;if(l===G.ENTER){if(s(e.target).closest("a,button").length>0)return;s(e.target).closest(f).length&&!o.alwaysEdit&&o.editable&&!this.editMode&&(e.preventDefault(),this.setEditMode(!0))}else if(113===l)s(e.target).closest(f).length&&!o.alwaysEdit&&o.editable&&!this.editMode&&(e.preventDefault(),this.setEditMode(!0));else if(l===G.ESCAPE)!o.alwaysEdit&&o.editable&&this.editMode&&(this.setEditMode(!1),e.stopPropagation());else if(112===l&&e.altKey&&(t=s(e.target).closest(f).find(".js-itemHelp")).length&&(i=t.attr(O)))return apex.theme.popupFieldHelp(i,apex.env.APP_SESSION),!1},focusin:function(e){var t,i,o=this;function l(){o.deactivateDelayTimer&&(clearTimeout(o.deactivateDelayTimer),o.deactivateDelayTimer=null)}0!==(i=s(e.target).closest(f)).length?(i.addClass(E),this.lastFocused=i[0],i[0]!==this.lastField?(this.lastField=i[0],this.editMode&&(l(),(t=this.element.find(".is-active")).length&&this._deactivateField(t),this._activateField(i))):l()):this.lastField=null},focusout:function(e){var t=this,i=s(e.target).closest(f);0!==i.length&&(i.removeClass(E),this.editMode&&(this.deactivateDelayTimer=setTimeout((function(){t.lastField=null,t._deactivateField(i),t.deactivateDelayTimer=null}),10)))}},_destroy:function(){this.element.removeClass("a-RV is-disabled u-RTL a-RV--excludeHidden a-RV--excludeNull").empty(),this._initModel(null)},_setOption:function(e,t){"editable"===e&&!t&&this.editMode&&this.setEditMode(!1),this._super(e,t),"disabled"===e?(this.element.toggleClass(C,t),t&&this.resize()):"showExcludeNullValues"===e||"showExcludeHiddenFields"===e?this._updateMenuActions():"recordOffset"===e||"recordParent"===e?this.refresh():"modelName"===e?(this.editMode&&this.setEditMode(!1),this._initModel(t),this.refresh()):"editable"!==e&&"alwaysEdit"!==e&&"toolbar"!==e&&"formCssClasses"!==e&&"labelAlignment"!==e||this._refreshView()},getActions:function(){return this.actions},getToolbar:function(){return this.toolbar$},refresh:function(e){var t,i=this,o=this.options,l=this.element;this._refreshCheckIfVisible()&&((t=l.find(p)).length&&this._deactivateField(t),this.fields||this._initView(),!this.editMode&&o.alwaysEdit&&this.setEditMode(!0),this._updateRecord(null,null,(function(){e&&i.focus()})))},focus:function(){this.lastField=null,this.body$.find(w).first().trigger("focus")},gotoField:function(e,t){var o,l,r,s,d,n=this.options,a=null;if(l=this.model.getRecord(e)){if(e!==this.currentRecordId&&(n.recordOffset=this.model.indexOf(l),this.refresh()),t)if(s=n.fields[0][t]){for(s.hidden&&s.canHide&&this.excludeHiddenFields&&this.actions.set(H,!1),null!==(d=this.model.getValue(l,t))&&""!==d||!this.excludeNullValues||this.actions.set($,!1),o=0;o<this.fields.length;o++)if(!((r=this.fields[o]).virtual||!r.canHide&&r.hidden)&&r.property===t){a=this.element.find("[data-idx='"+o+"']");break}o>=this.fields.length&&i.warn("Warning field is hidden "+t)}else i.warn("Warning field not found "+t);a?(this.lastField=null,a.find(w).first().trigger("focus")):this.focus()}else i.warn("Warning record not found "+e)},getFields:function(){return this.fields},refreshFields:function(){this.fields=null},fieldElement:function(e){return this.mapFieldToLabelId&&this.mapFieldToLabelId[e]?s("#"+this.mapFieldToLabelId[e]).closest(f):s()},inEditMode:function(){return this.editMode},setEditMode:function(e){var t,o,l=this.element,r=this,d="change.rvedit";this.scrollWrap$&&(this.options.editable?(e=!!e,o=this.editMode,e!==o&&((t=s(this.lastFocused)).length&&!e&&r._deactivateField(t),this._updateRecord(e,o,(function(){r.editMode=e,l.toggleClass("a-RV--editMode",e),e&&!t.length&&(r.focus(),t=s(r.lastFocused)),t.length&&(t.find(w).first().trigger("focus"),r.deactivateDelayTimer&&(clearTimeout(r.deactivateDelayTimer),r.deactivateDelayTimer=null),e&&r._activateField(t)),e?r.body$.on(d,(function(e){var t,i,o;if(r.activeRecord&&!s(e.target).closest(p).length)for(t=0;t<r.fields.length;t++)if((i=r.fields[t]).elementId===e.target.id){o=i.property,r.setActiveRecordValue(o);break}})):(r._forEachField(!0,(function(e,t){void 0!==r.columnItems[t.property]&&r._deactivateColumnItem(r.columnItems[t.property])})),r.body$.off(d),r.activeRecord=null,r.activeRecordId=null),r._trigger("modeChange",null,{editMode:e})})))):e&&i.warn("View is not editable."))},getRecord:function(){return this.currentRecord},resize:function(){var e,t=this.element,i=t.height();null!==t[0].offsetParent&&(this.scrollWrap$&&!this.pendingRefresh||(this.refresh(),this.fields))&&this.options.hasSize&&(e=i-(this.toolbar$?this.toolbar$.outerHeight():0),this.scrollWrap$.height(e))},expandGroup:function(){},collapseGroup:function(){},_initModel:function(t){var i,o=this.options,l=this;this._super(t,(function(t,r){var s,d,n,a,c,u,h,f;function p(e,s){var d,n;for(d=0;d<e.length;d++)(n=e[d])===l.currentRecordId&&("delete"===t?i&&o.skipDeletedRecords?(l.currentRecord=null,l.currentRecordId=null,l.activeRecord=null,l.activeRecordId=null,l.actions.invoke(L),null===l.currentRecord&&l.actions.invoke(X)):l._updateRecord():"clearChanges"===t&&s?l.actions.invoke(L):"refreshRecords"===t?(n=r.newIds[n]||n,l._updateRecord()):"revert"===t?l._updateRecord():l._updateRecordState())}l.pendingRefresh||("refresh"===t?(l.modelShape===D?(l.recordOffset=-1,l.recordParent=null):l.modelShape===S&&l.currentRecordId?(h=l.model.getRecord(l.currentRecordId),f=l.model.indexOf(h),o.recordOffset=f>-1?f:0):o.recordOffset=0,l.refresh(!0)):"insert"===t||"copy"===t?l.noData&&l.refresh():"refreshRecords"===t?p(r.recordIds):"clearChanges"===t?(p(r.deletedIds,!0),p(r.changedIds)):r.recordIds?p(r.recordIds):"set"===t?null!==l.ignoreFieldChange&&l.ignoreFieldChange===r.field||(r.oldIdentity&&l._identityChanged(r.oldIdentity,l.model.getRecordId(r.record)),l.model.getRecordId(r.record)===l.currentRecordId&&(s=l.columnItems[r.field],l.editMode&&s?l.ignoreItemChange||l._setColumnItemValue(s.item,r.record,r.field):(a=l.fieldElement(r.field)).length&&(n=l._getFieldMetadata(a),u=null,(c=l.model.getRecordMetadata(l.currentRecordId)).fields&&(u=c.fields[n.property]),d=e.htmlBuilder(),l._renderFieldDataValue(d,n,r.record,c,u),a.find(".a-RV-fieldValue").html(d.toString())),l._updateRecordState())):"metaChange"===t&&(null!==l.ignoreFieldChange&&l.ignoreFieldChange===r.field||r.recordId!==l.currentRecordId||l._updateRecordState()))})),t&&(i=this.model.getOption("onlyMarkForDelete"),this.modelShape=this.model.getOption("shape"),this.modelShape===A&&(this.actions.hide(L),this.actions.hide(X),this.actions.hide(z),this.actions.hide(N),this.actions.hide(k)))},_updateMenuActions:function(){var e=this.options;this.actions[e.showExcludeNullValues?F:P]($),this.actions[e.showExcludeHiddenFields?F:P](H)},_updateFields:function(){let e={},t=this.options.fields[0];this.fields=[];for(const[i,o]of U(t)){o.property=i,this.fields.push(o);let t=j(o);t&&(!e[t]||o.seq<e[t])&&(e[t]=o.seq)}this.fields.sort((function(t,i){return j(t)===j(i)?t.seq-i.seq:j(t)?j(i)?(e[j(t)]||0)-(e[j(i)]||0):-1:1}))},_initView:function(){var e=this.options,t=this.editMode;this._updateFields(),this.columnItems||this._initColumnItems(this.fields),this.toolbar$=null,t&&this.setEditMode(!1),this._renderView(),(t||e.alwaysEdit)&&this.setEditMode(!0),e.toolbar&&(this.toolbar$=this.element.children(".a-RV-toolbar").toolbar({idPrefix:this._getIdPrefix()+"tb",actionsContext:this.actions,data:e.toolbar,small:!0}),this.modelShape===A&&this.toolbar$.toolbar("hideControl","recordNumber")),this.resize()},_refreshView:function(){this.refreshFields(),this.refresh()},_forEachField:function(e,t){var i,o,l,r,s,d=this.fields;for(e&&(r=this.element.find(".a-RV-fieldValue")),l=0,i=0;i<d.length;i++)(o=d[i]).virtual||!o.canHide&&o.hidden||(s=null,e&&(s=r.eq(l)),t.call(this,i,o,s),l+=1)},_getIdPrefix:function(){return(this.options.idPrefix||this.element[0].id||"rv")+"_"},_renderView:function(){var t,i,l,r=this.options,d=this.element,n=e.htmlBuilder();function a(){n.markup("<div").attr("class",c+(r.formCssClasses?" "+r.formCssClasses:"")).markup(">"),i=!0}r.toolbar&&n.markup("<div class='a-RV-toolbar'></div>"),this._renderAltDataMessages(n),n.markup("<div class='a-RV-w-scroll'>").markup("<div class='a-RV-body'>"),this.mapFieldToLabelId={},t=null,i=!1,this._forEachField(!1,(function(e,s){var d,c,f,p,v,R,E,C=this._getIdPrefix()+e,_=this.columnItems[s.property];if(this.mapFieldToLabelId[s.property]=C,l=j(s),t!==l){if(l){if(!(c=r.fieldGroups[l]))throw new Error("Unknown field group name: "+l);f=c.label||c.heading}else f=o.getMessage("APEX.RV.NOT_GROUPED_LABEL");i&&n.markup("</div>"),n.markup("<h3 class='"+u+"'><button type='button'>").content(f).markup("</button></h3>"),a(),t=l}i||a(),d=h,s.hidden&&(d+=" "+b),s.fieldCssClasses&&(d+=" "+s.fieldCssClasses),s.isRequired&&(d+=" is-required"),p=s.label||s.heading,v=null,s.fieldColSpan&&((v=parseInt(s.fieldColSpan,10))>0&&v<13?n.markup("<div class='apex-col apex-col-"+v+"'>"):v=null),n.markup("<div").optionalAttr("id",s.elementId?s.elementId+"_CONTAINER":null).attr("data-idx",e).attr("class",d).markup("><div").attr("id",C).attr("class","u-Form-labelContainer "+function(e,t){var i="";return"start"===e?i=" u-tS":"end"===e?i=" u-tE":"left"===e?i=" u-tL":"right"===e?i=" u-tR":"center"!==e||t||(i=" u-tC"),i}(r.labelAlignment)).markup(">"),E=null,_&&_.item.setLabel||((E=s.elementId?s.elementId+"_LABEL":null)?n.markup("<label").attr("id",E).attr("for",s.elementId).attr("class",m).markup(">").content(p).markup("</label>"):n.markup("<span").attr("class",m).markup(">").content(p).markup("</span>")),n.markup("</div><div class='"+g+"'><div class='"+"a-RV-fieldValue'></div>"),s.helpid&&(R=o.formatMessage("APEX.ITEM.HELP_TEXT",p),n.markup("<button class='a-Button a-Button--noUI a-Button--helpButton js-itemHelp' tabindex='-1' type='button'").attr(O,s.helpid).attr("aria-label",R).attr("title",R).markup("><span class='a-Icon icon-help' aria-hidden='true'></span></button>")),n.markup("</div></div>"),v&&n.markup("</div>")})),i&&n.markup("</div>"),n.markup("</div></div>"),d.html(n.toString()).find("."+u).each((function(){var e=s(this);e.collapsible({heading:"."+u,controllingElement:"button",universalTheme:!0,collapsed:!1,content:e.next()})})),this.scrollWrap$=d.find(".a-RV-w-scroll"),this.body$=d.find(".a-RV-body"),this.noData$=d.find(".a-GV-noDataMsg")},_updateRecord:function(e,t,i){var o,l=this,r=this.currentRecordId,s=this.options;function d(){var e,t,i,o,r,s;for(o=l.model.getRecordMetadata(l.currentRecordId),e=0;e<l.fields.length;e++)t=l.fields[e].property,(i=l.columnItems[t])&&(s=i.item.isDisabled(),i.element$.is(M)&&!s?i.item.getValidity().valid||l.model.setValidity("error",l.currentRecordId,t,i.item.getValidationMessage()):l.model.setValidity("valid",l.currentRecordId,t),o&&((r=o.fields?o.fields[t]:null)&&r.disabled||s)&&(r||(o.fields||(o.fields={}),r={},o.fields[t]=r),r.disabled=s));l._triggerEndEditing(l.currentRecord,l.currentRecordId),l.activeRecord=null,l.activeRecordId=null}function n(o,n,a){var c,u,h,f=l.body$;if(o){if(c=l.model.getRecordMetadata(a)||{},l.scrollWrap$.show(),l.noData$.hide(),c.agg||c.deleted&&s.skipDeletedRecords)return l.modelShape===D?(u=l[l.direction>0?"_nextTreeRecord":"_previousTreeRecord"]())&&(s.recordParent=u.parent,s.recordOffset=u.offset):(s.recordOffset+=l.direction,h=l.model.getTotalRecords(),s.recordOffset<0?(s.recordOffset=0,l.direction=-l.direction):h>=0&&s.recordOffset>=h&&(s.recordOffset=h-1,l.direction=-l.direction)),l._updateRecord(e,t,i),void l._updateRecord();s.editable&&l.currentRecord&&(e&&!1!==t||!0===t)&&d(),s.recordOffset=n,l.currentRecordId=a,l.currentRecord=null,l.activeRecord=null,l._renderRecordFields(e,o,n,a,c),l.currentRecord=o,e&&(l.activeRecord=o,l.activeRecordId=a),f.children(R).remove(),f.find(v).remove(),l._updateRecordState(),l._updateRecordNumber(),s.editable&&e&&l._triggerBeginEditing(l.currentRecord,l.currentRecordId),null!==r&&r===l.currentRecordId||setTimeout((function(){l._trigger("recordChange",null,{recordOffset:s.recordOffset,recordId:l.currentRecordId})}),1)}else s.editable&&l.currentRecord&&(e&&!1!==t||!0===t)&&d(),l.currentRecordId=null,l.currentRecord=null,l._renderRecordFields(e,null,-1,null,{}),l.scrollWrap$.hide(),l.noData$.show(),l._updateActions(),l._updateRecordNumber()}if(null==e&&(e=this.editMode),this.activeLockCount>0)this.activeUnlockCallback=function(){l._updateRecord(e,t,i)};else{switch(this.modelShape){case A:if(!(o=this.model.getRecord())&&this.model.getOption("ajaxIdentifier")){let e=this.model.fetch();if(e)return void e.then((()=>{n(o=this.model.getRecord(),0,o?this.model.getRecordId(o):null)}));n(o,0,o?this.model.getRecordId(o):null)}n(o,0,o?this.model.getRecordId(o):null);break;case S:this.model.forEachInPage(s.recordOffset,1,(function(e,t,i){n(e,t,i)}),this);break;case D:null===s.recordParent?(o=this.model.root(),s.recordOffset=-1,n(o,s.recordOffset,o?this.model.getRecordId(o):null)):n(o=this.model.child(s.recordParent,s.recordOffset),s.recordOffset,o?this.model.getRecordId(o):null)}i&&i()}},_renderRecordFields:function(t,i,o,l,r){var s=null,d=this.options.tabbableFieldContent,n=!1,a=e.htmlBuilder(),c=this.columnItemsContainer$?this.columnItemsContainer$[0]:null;t&&i&&(n=this.model.allowEdit(i)),this._forEachField(!0,(function(e,t,o){var l,u,f,p,m=null,g=!1;l=h,i&&(null!==(u=this.model.getValue(i,t.property))&&""!==u||(l+=" a-RV-field--null"),t.hidden&&(l+=" "+b),t.fieldCssClasses&&(l+=" "+t.fieldCssClasses),t.isRequired&&(l+=" is-required"),r.fields&&(s=r.fields[t.property]),s&&(s.disabled&&(l+=" is-disabled"),g=s.ck),(g||t.readonly)&&(l+=" is-readonly",g=!0)),(f=this.columnItems[t.property])&&f.item.setLabel||(m=t.elementId+"_LABEL"),n&&f&&!g&&!t.volatile?f.element$.parent()[0]===c&&(o.empty().append(f.element$),this._activateColumnItem(f,m),m||f.item.setLabel(t.label||t.heading)):(f&&f.element$.closest(this.element).length&&(this._deactivateColumnItem(f),m||f.item.setLabel(null)),i?(a.clear(),m||((s=W(!0,{},s)).ck="X"),this._renderFieldDataValue(a,t,i,r,s),m||a.markup("<span class='u-Form-label'>").content(t.label||t.heading).markup("</span>"),o.html(a.toString()),(p=o.find(d)).length&&(o.attr("aria-labelledby",m).attr("role","group"),p.filter("[tabindex]").attr("tabindex",0))):o.empty()),o.parent().parent().attr("class",l)})),n&&i&&(this._beginSetColumnItems(),this._forEachField(!0,(function(e,t,o){var l=this.columnItems[t.property];!l||o.hasClass(y)||t.volatile||this._setColumnItemValue(l.item,i,t.property,n?r:null)})),this._endSetColumnItems())},_updateRecordState:function(){let e,t,i="",l=this.body$;if(e=this.model.getRecordMetadata(this.currentRecordId)||{},l.removeClass("is-deleted is-inserted is-updated "+V),e.deleted?(l.addClass("is-deleted"),i=o.getMessage("APEX.GV.ROW_DELETED")):e.inserted?(l.addClass("is-inserted"),i=o.getMessage("APEX.GV.ROW_ADDED")):e.updated&&(l.addClass("is-updated"),i=o.getMessage("APEX.GV.ROW_CHANGED")),this.model.allowEdit(this.currentRecord)||l.addClass(y),e.error||e.warning?(t=l.children(R),t.length||(t=s("<div class='a-Alert'></div>"),l.prepend(t)),t.text(e.message),l.addClass(e.error?x:I)):l.children(R).remove(),e.fields)for(const[i,o]of U(e.fields)){let e=this.fieldElement(i);e.removeClass("is-changed is-stale "+V),o.error||o.warning?(t=e.find(v),t.length||(t=s("<span class='a-Form-error'></span>"),e.find(".u-Form-inputContainer").append(t)),t.text(o.message),e.addClass(o.error?x:I)):(e.find(v).remove(),o.changed?e.addClass("is-changed"):o.stale&&e.addClass("is-stale")),o.ck&&e.addClass(y)}this._updateActions(),this.toolbar$&&this.toolbar$.toolbar("findElement","status").text(i)},_hasPrevious:function(){var e=this.options;switch(this.modelShape){case A:return!1;case S:return e.recordOffset>0;case D:return null!==this._previousTreeRecord()}},_hasNext:function(){var e,t=this.options;switch(this.modelShape){case A:return!1;case S:return(e=this.model.getTotalRecords())<0||t.recordOffset+1<e;case D:return null!==this._nextTreeRecord()}},_nextTreeRecord:function(){var e,t,i=this.options,o=i.recordOffset,l=i.recordParent;if(t=null===l?this.model.root():this.model.child(l,o),this.model.childCount(t)>0)return{parent:t,offset:0};for(;l;){if((e=this.model.childCount(l))>0&&o+1<e)return{parent:l,offset:o+1};o=this.model.indexOf(l),l=this.model.parent(l)}return null},_previousTreeRecord:function(){var e=this,t=this.options,i=t.recordOffset,o=t.recordParent;return null===o?null:o&&i>0?function t(i){var o=e.model.childCount(i);return o>0?t(e.model.child(i,o-1)):{parent:e.model.parent(i),offset:e.model.indexOf(i)}}(this.model.child(o,i-1)):{parent:this.model.parent(o),offset:this.model.indexOf(o)}},_updateActions:function(){var e=this.options,t=this.actions,i=this.currentRecord,o=e.editable,l=this.model,r=this.modelShape===D?e.recordParent:null,s=o&&l.allowAdd(r,"new"),d=o&&i&&l.allowAdd(r,"copy"),n=o&&i;function a(e,i){t[e?"enable":"disable"](i)}a(n&&l.canRevertRecord(i),B),a(n&&l.allowDelete(i),k),a(s,z),a(d,N),a(i&&this._hasNext(),L),a(i&&this._hasPrevious(),X)},_getFieldMetadata:function(e){var t=parseInt(e.attr("data-idx"),10);return isNaN(t)?null:this.fields[t]},_activateField:function(e){var t,i;e.length<=0||null===this.currentRecord||((t=this._getFieldMetadata(e))&&(i=this.columnItems[t.property]),i&&this.model.allowEdit(this.currentRecord)&&!e.hasClass(y)&&e.addClass(_))},_deactivateField:function(e){var t,i=null;e.length<=0||null===this.currentRecord||((t=this._getFieldMetadata(e))&&(i=this.columnItems[t.property]),i&&!e.hasClass(y)&&e.hasClass(_)&&(this._setModelValue(e,i.item,this.currentRecord,t.property),this._updateRecordState()))},_updateRecordNumber:function(){var e,t,i="",l=this.options;this.toolbar$&&(this.currentRecord&&(this.modelShape===D?(t=this.model.parent(this.currentRecord))&&(e=this.model.childCount(t)):e=this.model.getTotalRecords(),i=e>0?o.formatMessage("APEX.RV.REC_XY",l.recordOffset+1,e):o.formatMessage("APEX.RV.REC_X",l.recordOffset+1)),this.toolbar$.toolbar("findElement","recordNumber").text(i))},_identityChanged:function(e,t){e===this.currentRecordId&&(this.currentRecordId=t,this.activeRecordId&&(this.activeRecordId=t))}}),s.apex.recordView.copyDefaultToolbar=function(){var e,t=[];for(e=0;e<q.length;e++)t.push(W(!0,{},q[e]));return t},s.apex.recordView.createModelEditDialog=function(i,l){var d,n,a,c,u,h,f,p,m,g,v,R,b,E,C,_,y,x=s,I=[],V=x("#"+i),w=l.modelOptions.shape||S,O=l.okLabelKey?o.getMessage(l.okLabelKey):null,L=e.htmlBuilder(),X=l.classPrefix||"a-IG-dialog";function $(e){E&&(h&&E.expand(E.getSelection().first()),y&&clearTimeout(y),y=setTimeout((function(){E[h?"setSelectedNodes":"setSelectedRecords"]([e]),y=null}),1))}l.appendToTop&&(x=e.getTopApex().jQuery),R=x("body").context,V.length||(V=x("<div id='"+i+"'></div>"),x(l.appendTo||"body").append(V)),w===D?n=s.apex.treeView.makeModelNodeAdapter(l.modelName,l.modelOptions,null):(w===A&&(I=null),n=t.create(l.modelName,l.modelOptions,I,0,!1)),m=n.getOption("shape"),g=n.getOption("fields"),v=n.getOption("editable"),b=v&&n.getOption("sequenceField"),L.markup("<form novalidate><section class='"+X+"-region "+X+"-body'>"),m!==A&&L.markup("<aside class='"+X+"-side resize'><div class='nav resize'></div><div class='tb'></div></aside>"),L.markup("<main class='"+X+"-main resize'><div class='rv resize'></div></main></section></form>"),(d=W({closeText:o.getMessage("APEX.DIALOG.CLOSE"),noDataMessage:null},l,{autoOpen:!1,modal:!0,create:function(){var e,t,o,d,p=r.createContext("ModelEditDialog",V[0]);if(x(this).closest(".ui-dialog").css("position","fixed"),(u=s("#"+i,R).find(".rv")).recordView({modelName:l.modelName,noDataMessage:l.noDataMessage,idPrefix:l.idPrefix||l.modelName,fields:[g],actionsContext:p,toolbar:null,editable:!0,alwaysEdit:!0,hasSize:!0,skipDeletedRecords:!0,formCssClasses:l.formCssClasses,labelAlignment:l.labelAlignment,recordChange:function(){var t;"nav"!==e&&(t=u.recordView("getRecord"))&&(e="rv",$(t),e=null)}}),m!==A&&(f=s("#"+i,R).find(".tb"),p.add([{name:"move-up",labelKey:"APEX.RV.MOVE_UP",hide:!0,action:function(){var e,t=null,i=a.grid("getSelection"),o=a.grid("getSelectedRecords");i[0].prev().length&&((e=i[0].prev().prev()).length&&(t=a.grid("getRecords",[e])[0]),n.moveRecords(o,null,t),a.grid("setSelectedRecords",o))}},{name:"move-down",labelKey:"APEX.RV.MOVE_DOWN",hide:!0,action:function(){var e,t=null,i=a.grid("getSelection"),o=a.grid("getSelectedRecords");(e=i[i.length-1].next()).length&&(t=a.grid("getRecords",[e])[0],n.moveRecords(o,null,t),a.grid("setSelectedRecords",o))}}]),t=[{type:"BUTTON",iconOnly:!0,icon:"icon-plus",action:z},{type:"BUTTON",iconOnly:!0,icon:"icon-copy",action:N},{type:"BUTTON",iconOnly:!0,icon:"icon-minus",action:k},{type:"BUTTON",iconOnly:!0,icon:"icon-up-chevron",action:"move-up"},{type:"BUTTON",iconOnly:!0,icon:"icon-down-chevron",action:"move-down"}],p[v?F:P](k),p[v?F:P](z),p[v&&l.includeCopy?F:P](N),p[b?F:P]("move-up"),p[b?F:P]("move-down"),f.toolbar({actionsContext:p,data:[{align:"start",controls:t}]})),m===S)if(l.useList){if(c=s("#"+i,R).find(".nav"),!(d=l.recordTemplate)){if(!l.labelColumn)throw new Error("Option recordTemplate or labelColumn is required");d="<li data-id='&APEX$ROW_ID.' class='&APEX$ROW_STATE_CLASSES.'>",l.iconClassColumn&&(d+="<span class='a-IconList-icon'><span class='&"+l.iconClassColumn+".'></span></span>"),l.enabledCheckbox&&(d+="<span class='ro-checkbox &\"enabledClass\".'></span><span class='u-vh'>&\"enabledText\".</span>"),d+="<span class='a-IconList-label'>&"+l.labelColumn+".</span></li>"}c.tableModelView({modelName:l.modelName,columns:[g],hasSize:!0,footer:!1,pagination:{scroll:!0},useIconList:!0,recordTemplate:d,collectionClasses:l.collectionClasses||"a-RVDialog-list",selectionChange:function(){var t,i;"rv"!==e&&(i=c.tableModelView("getSelectedRecords")[0])&&(e="nav",t=n.indexOf(i),u.recordView(T,"recordOffset",t),e=null)}}),E=c.data("apex-tableModelView")}else(a=s("#"+i,R).find(".nav")).grid({modelName:l.modelName,noDataMessage:l.noDataMessage,columns:[g],editable:!1,hasSize:!0,footer:!1,pagination:{scroll:!0},reorderColumns:!1,columnSort:!1,hideDeletedRows:!0,selectionChange:function(){var t,i;"rv"!==e&&(i=a.grid("getSelectedRecords")[0])&&(e="nav",t=n.indexOf(i),u.recordView(T,"recordOffset",t),e=null)}}),E=a.data("apex-grid");else m===D&&(s("#"+i,R).find(".nav").addClass("a-RVDialog-scroll").html("<div class='a-RVDialog-tree'></div>"),o={showRoot:!0,collapsibleRoot:!0,expandRoot:!0,getNodeAdapter:function(){return n},selectionChange:function(){var t,i,o;"rv"!==e&&(i=h.treeView("getSelectedNodes")[0])&&(o=n.parent(i),e="nav",o!==u.recordView(T,"recordParent")&&u.recordView(T,"recordParent",o),t=n.indexOf(i),u.recordView(T,"recordOffset",t),e=null)}},(h=s("#"+i,R).find(".a-RVDialog-tree")).treeView(o),s.apex.treeView.treeModelListener(l.modelName,h),E=h.data("apex-treeView"));this.initDone=!1},open:function(){var e,t=null;f&&f.toolbar("refresh"),a&&a.grid("refreshColumns"),d.resize(),l.init&&!this.initDone&&l.init.call(this,n,a||c||h||null,u,f),this.initDone=!0,l.load&&(t=l.load.call(this,n)),m!==A&&(e=t?n.getRecord(t):u.recordView("getRecord"))&&setTimeout((function(){$(e)}),10),setTimeout((function(){u.recordView("focus")}),100)},close:function(){m===S?n.setData([],0):n.setData(null)},resize:function(){var t=V.width(),i=V.height();p?V.find("section").height(i).width(t).resize():(V.find("section,main,aside").height(i),t-=V.find("aside").outerWidth()||0,V.find("main").width(t),u.width(t),u.height(i).recordView("resize"),t=V.find("aside").width(),i-=V.find(".tb").outerHeight(),a?a.width(t).height(i).grid("resize"):h&&h.width(t).height(i),e.setOuterWidth(V.find(".tb"),t))}})).buttons=v?[{text:o.getMessage("APEX.DIALOG.CANCEL"),click:function(){u.recordView("setEditMode",!1),x(this).dialog("close")}},{text:O||o.getMessage("APEX.DIALOG.SAVE"),class:"ui-button--hot",click:function(){var e="",t=!0;u.recordView("setEditMode",!1),l.validate&&"string"==typeof(t=l.validate.call(this,n,(function(e,t){n.setValidity("valid",e,t)}),(function(e,t,i){n.setValidity("error",e,t,i)})))&&(e=t+"\n\n",t=!1),t&&!n.hasErrors()?(l.store&&l.store.call(this,n),x(this).dialog("close")):(u.recordView("refresh"),e+=apex.lang.getMessage("APEX.CORRECT_ERRORS"),apex.message.alert(e,(function(){let e,t,i=n.getErrors()[0];if(i){for([e,t]of U(i.fields))if(t.error)break;setTimeout((function(){u.recordView("gotoField",n.getRecordId(i.record),e)}),1)}})))}}]:[{text:O||o.getMessage("APEX.DIALOG.OK"),class:"ui-button--hot",click:function(){x(this).dialog("close")}}],d.dialogHelp&&d.buttons.unshift({text:o.getMessage("APEX.DIALOG.HELP"),class:"ui-button-help",click:function(){var e=d.dialogHelp;o.loadMessagesIfNeeded([e.titleKey,e.helpTextKey],(function(){var t={title:e.title,helpText:e.helpText};e.titleKey&&(t.title=o.getMessage(e.titleKey)),e.helpTextKey&&(t.helpText=o.getMessage(e.helpTextKey)),apex.theme.popupFieldHelp(t)}))}}),d.titleKey&&(d.title=o.getMessage(d.titleKey),delete d.titleKey),V.html(L.toString()).dialog(d).on("dialogopen",(function(){apex.navigation.beginFreezeScroll()})).on("dialogresize",(function(){x(this).closest(".ui-dialog").css("position","fixed")})).on("dialogclose",(function(){apex.navigation.endFreezeScroll()})),V.on("keydown",(function(e){var t;e.which===G.ENTER&&"INPUT"===e.target.nodeName&&(l.defaultButton&&(t=V.parent().find(".ui-button--hot").eq(0).trigger("focus"),setTimeout((function(){t.trigger("click")}),50)),e.preventDefault())})),l.useSplitter&&m!==A&&s.apex.splitter&&(C=l.splitterPosition||200,l.persistSplitter&&(_=apex.storage.getScopedSessionStorage({prefix:"ORA_WWV_apex.MED_"+l.persistSplitter,useAppId:!0}),C=parseInt(_.getItem("splitterPosition")||C,10)),p=V.find("."+X+"-body").splitter({position:C,collapsed:!1,minSize:120,orientation:"horizontal",positionedFrom:"begin",noCollapse:!0,change:function(e,t){_&&_.setItem("splitterPosition",t.lastPosition-t.lastPosition%1+"")}}),V.on("resize",(function(t){var i,o,l,r,d=s(t.target);i=d.height(),o=d.width(),(l=d.children(".resize").filter(M)).length>0&&(d.children(":not(.resize)").filter(M).each((function(){"fixed"!==(r=s(this).css("position"))&&"absolute"!==r&&(i-=s(this).outerHeight(!0))})),i=Math.floor(i/l.length),l.each((function(){var t=s(this);e.setOuterHeight(t,i),e.setOuterWidth(t,o),t.filter(M).trigger("resize")}))),t.stopPropagation()})));var H=V.data("ui-dialog"),K=H._destroy;return H._destroy=function(){K.call(H),t.destroy(l.modelName)},V}}(apex.util,apex.model,apex.debug,apex.lang,apex.item,apex.actions,apex.jQuery);
!function(e,t,i,n,o,a,l,r,s,d,c,u,h,g,p){"use strict";const m="a-IG",f="a-IG-header",_=".a-IG-header",C="a-IG-body",I="a-IG-contentContainer",v="a-IG-dialog",b="a-IG-dialog-iconList",E="a-IG-controls",w="a-IG-controls-cell",A="a-IG-controlsCheckbox",R="a-IG-controlsLabel",S="a-IG-reportSummary",T="a-IRR-sortWidget",N="a-IRR-sortWidget-actions",y="apex-item-text",L="a-Combobox",O="hasDatepicker",V="a-Button",D="a-Icon",k="a-MediaBlock-content",M="is-active",x="is-checked",H="js-colCheckbox",G=".js-colCheckbox",F="u-VisuallyHidden",P="has-button",U="aria-expanded",B="aria-hidden",q="aria-label",X="aria-labelledby",$="aria-describedby",W="aria-controls",K="aria-level",Y="<option></option>",z="left",j="right",Z="text",Q="select",J="colorpicker",ee="textarea",te="checkbox",ie="iconList",ne="row",oe="column",ae="complex",le="start",re="center",se="destroy",de="refresh",ce="resize",ue="show",he="hide",ge="expanded",pe="collapsed",me="required",fe="disabled",_e="checked",Ce="option",Ie="grid",ve="icon",be="chart",Ee="inactiveSettings",we="invalidSettings",Ae="primary",Re="alternative",Se="private",Te="public",Ne="columns",ye="filter",Le="highlight",Oe="flashback",Ve="sort",De="aggregate",ke="controlBreak",Me="editReport",xe="saveAsReport",He="download",Ge="asc",Fe="first",Pe="last",Ue="none",Be="scroll",qe="set",Xe="i",$e="d",We="region",Ke="page",Ye="~",ze="Y",je="N",Ze="_meta",Qe="plain",Je="label",et="error",tt="class",it="role",nt="value",ot="action",at="toggle",lt="radioGroup",rt={type:"separator"},st="BUTTON",dt="MENU",ct="all",ut="past",ht="future",gt="EQ",pt="NEQ",mt="LT",ft="LTE",_t="GT",Ct="GTE",It="N",vt="NN",bt="C",Et="NC",wt="IN",At="NIN",Rt=";",St="BETWEEN",Tt="NBETWEEN",Nt="LAST",yt="NLAST",Lt="NEXT",Ot="NNEXT",Vt="REGEXP",Dt="S",kt="NS",Mt="VARCHAR2",xt="NUMBER",Ht="DATE",Gt="CLOB",Ft="TIMESTAMP",Pt="TIMESTAMP_TZ",Ut="TIMESTAMP_LTZ",Bt="area",qt="bar",Xt="bubble",$t="donut",Wt="funnel",Kt="line",Yt="lineWithArea",zt="pie",jt="polar",Zt="radar",Qt="range",Jt="scatter",ei="stock",ti="vertical",ii="on",ni="off",oi="auto",ai="cartesian",li="VALUE_REQUIRED",ri="INVALID_VALUE",si="INVALID_NUMBER_FORMAT",di="SELECT",ci="EDIT_GRID_MODE",ui="VIEW_GRID_MODE",hi="YYYYMMDDHH24MISS",gi={EQ:"EQUALS",NEQ:"NOT_EQUALS",LT:"LESS_THAN",LTE:"LESS_THAN_OR_EQUALS",GT:"GREATER_THAN",GTE:"GREATER_THAN_OR_EQUALS",LIKE:"LIKE",NLIKE:"NOT_LIKE",N:"IS_NULL",NN:"IS_NOT_NULL",C:"CONTAINS",NC:"DOES_NOT_CONTAIN",IN:"IN",NIN:"NOT_IN",BETWEEN:"BETWEEN",NBETWEEN:"NOT_BETWEEN",LAST:"IN_THE_LAST",NLAST:"NOT_IN_THE_LAST",NEXT:"IN_THE_NEXT",NNEXT:"NOT_IN_THE_NEXT",REGEXP:"MATCHES_REGULAR_EXPRESSION",S:"STARTS_WITH",NS:"DOES_NOT_START_WITH",OTEXT:"ORACLE_TEXT"},pi={SUM:"SUM",AVG:"AVG",CNT:"COUNT",CNT_DIST:"COUNT_DISTINCT",APPR_CNT_DIST:"APPROX_COUNT_DISTINCT",MIN:"MIN",MAX:"MAX",MEDIAN:"MEDIAN",LISTAGG:"LISTAGG"},mi=t.hasOwnProperty,fi=Array.isArray;function _i(e){return o.getMessage(e)}function Ci(e){return o.getMessage("APEX.IG."+e)}function Ii(e,t){return void 0!==e?e:t}var vi={filter:Ci("FILTER"),chart:Ci("CHART"),groupby:Ci("GROUP_BY"),controlBreak:Ci("CONTROL_BREAK"),highlight:Ci("HIGHLIGHT"),aggregate:Ci("AGGREGATE"),flashback:Ci("FLASHBACK")},bi={MI:"MINUTE",H:"HOUR",D:"DAY",W:"WEEK",M:"MONTH",Y:"YEAR"},Ei="LABEL",wi="VALUE",Ai="X",Ri="Y",Si="Z",Ti="TARGET",Ni="HIGH",yi="LOW",Li=[{value:"$1,002.54",label:{style:"currency",currency:"USD",currencyDisplay:"symbol"}},{value:"1,002.54",label:{style:"decimal",maximumFractionDigits:2}},{value:"1,002.5400",label:{style:"decimal",maximumFractionDigits:4}},{value:"1,002",label:{style:"decimal",maximumFractionDigits:0}},{value:"1,002.54-",label:{style:"decimal",maximumFractionDigits:2}},{value:"-1,002.54",label:{style:"decimal",maximumFractionDigits:2}},{value:"<1,002.54>",label:{style:"decimal",maximumFractionDigits:2}}],Oi=[{value:"DD-MON-RR",label:{pattern:"dd-MMM-yy"}},{value:"DD-MON-YYYY",label:{pattern:"dd-MMM-yyyy"}},{value:"DD-MON",label:{pattern:"dd-MMM"}},{value:"RR-MON-DD",label:{pattern:"yy-MMM-dd"}},{value:"YYYY-MM-DD",label:{pattern:"yyyy-MMM-dd"}},{value:"fmDay, fmDD fmMonth, YYYY",label:{formatType:"date",dateFormat:"full"}},{value:"DD-MON-YYYY HH24:MI",label:{pattern:"dd-MMM-yyyy HH:mm"}},{value:"DD-MON-YYYY HH24:MI:SS",label:{pattern:"dd-MMM-yyyy HH:mm:ss"}},{value:"DD-MON-YYYY HH:MIPM",label:{pattern:"dd-MMM-yyyy hh:mm a"}},{value:"Month",label:{month:"long"}},{value:"DD-MON-YYYY HH24.MI.SSXFF",label:{pattern:"dd-MMM-yyyy HH:mm:ss"}},{value:"DD-MON-YYYY HH:MI:SSXFF PM",label:{pattern:"dd-MMM-yyyy hh:mm:ss a"}},{value:"DD-MON-YYYY HH24:MI TZR",label:{pattern:"dd-MMM-yyyy HH:mm"}},{value:"DD-MON-YYYY HH24.MI.SSXFF TZR",label:{pattern:"dd-MMM-yyyy HH:mm:ss"}},{value:"DD-MON-YYYY HH.MI.SSXFF PM TZR",label:{pattern:"dd-MMM-yyyy hh:mm:ss a"}}],Vi="viewChange",Di="save",ki="change",Mi=[{id:"search",groupTogether:!0,customCSS:"a-Toolbar-group--search",controls:[{type:dt,id:"column_filter_button",labelKey:"APEX.IG.SELECT_COLUMNS_TO_SEARCH",icon:"icon-search",iconOnly:!0,menu:{items:[{type:at,action:"search-case-sensitive"},rt,{type:lt,action:"filter-column"}]}},{type:"TEXT",id:"search_field",enterAction:"search"},{type:st,action:"search"}]},{id:"reports",controls:[{type:"SELECT",action:"change-report"}]},{id:"views",controls:[{type:"RADIO_GROUP",labelKey:"APEX.IG.VIEW",action:"change-view"}]},{id:"actions1",controls:[{type:dt,id:"actions_button",labelKey:"APEX.IG.ACTIONS",menu:{items:[{type:ot,action:"show-columns-dialog"},rt,{type:ot,action:"show-filter-dialog"},{type:"subMenu",id:"data_submenu",labelKey:"APEX.IG.DATA",icon:"icon-ig-data",menu:{items:[{type:ot,action:"show-sort-dialog"},{type:ot,action:"show-aggregate-dialog"},{type:ot,action:"refresh"},{type:ot,action:"show-flashback-dialog"}]}},{type:"subMenu",id:"format_submenu",labelKey:"APEX.IG.FORMAT",icon:"icon-ig-format",menu:{items:[{type:ot,action:"show-control-break-dialog"},{type:ot,action:"show-highlight-dialog"},{type:at,action:"stretch-columns"},{type:"subMenu",labelKey:"APEX.IG.ROWS_PER_PAGE",hide:!0,id:"rows",icon:"icon-ig-rows",menu:{items:[{type:lt,action:"change-rows-per-page"}]}}]}},{type:"subMenu",id:"selection_submenu",labelKey:"APEX.IG.SELECTION",icon:"icon-ig-selection",menu:{items:[{type:at,action:"selection-mode"},rt,{type:ot,action:"selection-copy",accelerator:"Ctrl+C"},rt]}},rt,{type:ot,action:"chart-view"},rt,{type:"subMenu",id:"save_report_submenu",labelKey:"APEX.IG.REPORT",icon:"icon-irr-saved-report",menu:{items:[{type:ot,action:"save-report"},{type:ot,action:"show-save-report-as-dialog"},{type:ot,action:"show-edit-report-dialog"},rt,{type:ot,action:"delete-report"},rt,{type:ot,action:"reset-report"}]}},rt,{type:ot,action:"show-download-dialog"},rt,{type:ot,action:"show-help-dialog"}]}}]},{id:"actions2",controls:[{type:"TOGGLE",action:"edit"},{type:st,hot:!0,action:"save"}]},{id:"actions3",controls:[{type:st,action:"selection-add-row"}]},{id:"actions4",align:"end",controls:[{type:st,action:"reset-report",labelKey:"APEX.IG.RESET",iconBeforeLabel:!0}]}];function xi(){var t,i=[];for(t=0;t<Mi.length;t++)i.push(e.extend(!0,{},Mi[t]));return i.toolbarFind=Mi.toolbarFind,i.toolbarRemove=Mi.toolbarRemove,i.toolbarInsertAfter=Mi.toolbarInsertAfter,i}function Hi(e,t,i,n){var o,a,l,r,s,d,c=e;function u(e){var o,a;for(o=0;o<e.length;o++){if((a=e[o]).id===t||a.action===t)return i&&e.splice(o,1),n&&e.splice(o+1,0,n),a;if("subMenu"===a.type&&(a=u(a.menu.items)))return a}return null}for(o=0;o<c.length;o++){if((d=c[o]).id===t)return i&&c.splice(o,1),n&&c.splice(o+1,0,n),d;if(l=d.controls)for(a=0;a<l.length;a++){if((r=l[a]).id===t||r.action===t)return i&&l.splice(a,1),n&&l.splice(a+1,0,n),r;if(r.menu&&(s=u(r.menu.items)))return s}}return null}function Gi(e){return{label:e||"ENABLED",alignment:re,defaultValue:!0,columnCssClasses:H,cellTemplate:"<span class='ro-checkbox &\"enabledClass\".'></span><span class='u-vh'>&\"enabledText\".</span>",width:80,noStretch:!0,seq:10}}function Fi(e,t){e.recordView("fieldElement",t).hide()}function Pi(e,t){e.recordView("fieldElement",t).show()}function Ui(e){try{return p.parse(e,hi)}catch(e){return null}}function Bi(e){try{return p.format(e,hi)}catch(e){return""}}function qi(e){var t,i,n=[];for(t=0;t<e.length;t++)""!==(i=e[t].replace(/^\s+|\s+$/gm,""))&&-1===n.indexOf(i)&&n.push(i);return n}function Xi(e){var t=e;switch(e){case"groupby":t="group-by";break;case"savedReport":t="saved-report";break;case Ee:t="inactive-settings";break;case we:t="invalid-settings";break;case ke:t="control-break";break;case xe:case Me:t="save-report"}return t}function $i(e,t,i,n,o,a){var l;for(a||t.push({value:o,label:a}),l=0;l<e.length;l++)t.push({value:e[l][i],label:e[l][n]})}function Wi(t,i){var n;if(!e.isEmptyObject(i))for(n in i)mi(i,n)&&t.attr("data-"+n,i[n])}function Ki(t,i){var n,o=e.extend({id:"",type:Z,value:"",maxChars:"",title:"",role:"",ariaLabel:"",ariaLabelledBy:"",ariaDescribedBy:"",name:"",size:"",placeholder:"",readonly:!1,checked:!1,disabled:!1,invalid:!1,required:!1,cssClasses:[],data:{},attributes:{}},i),a=o.cssClasses,l=o.attributes;if(t.markup("<input").attr("id",o.id).attr("type",o.type).attr("value",o.value).optionalAttr("maxlength",o.maxChars).optionalAttr("title",o.title).optionalAttr(it,o.role).optionalAttr(q,o.ariaLabel).optionalAttr(X,o.ariaLabelledBy).optionalAttr($,o.ariaDescribedBy).optionalAttr("name",o.name).optionalAttr("size",o.size).optionalAttr("placeholder",o.placeholder).optionalBoolAttr("readonly",o.readonly).optionalBoolAttr(_e,o.checked).optionalBoolAttr(fe,o.disabled).optionalAttr("aria-invalid",o.invalid?"true":null).optionalBoolAttr(me,o.required),a.length>0&&t.attr(tt,fi(a)?a.join(" "):a),Wi(t,o.data),!e.isEmptyObject(l))for(n in l)mi(l,n)&&t.attr(n,l[n]);t.markup(" />")}function Yi(t,i){Ki(t,e.extend({cssClasses:y,maxChars:"4000"},i))}function zi(i,n){var o=e("#"+i+"_list");function a(e){o.iconList("setSelection",o.find('li[data-value="'+t.escapeHTMLAttr(e)+'"]'),!1)}o.iconList({multiple:!1,selectionChange:function(){e("#"+i).val(e(this).iconList("getSelectionValues")).trigger("change")}}),a(n),e("#"+i).on("change",(function(){a(e("#"+i).val())}))}function ji(t,i){var n,o,a,l,r=e.extend({id:"",buttonClass:"",label:"",icon:"",iconOnly:!1,iconPosition:j,tabindex:"",attributes:{},data:{},role:"",ariaLevel:"",ariaControls:"",ariaDescribedBy:""},i);if(n=V+(i.buttonClass?" "+i.buttonClass:""),o=D+(i.icon?" "+i.icon:""),a=i.icon&&!i.iconOnly,t.markup("<button type='button'").optionalAttr("id",r.id).optionalAttr("tabindex",r.tabindex).attr(tt,n).optionalAttr(it,r.role).optionalAttr(K,r.ariaLevel).optionalAttr(W,r.ariaControls).optionalAttr($,r.ariaDescribedBy),i.iconOnly&&r.label&&t.attr("title",r.label).attr(q,r.label),!e.isEmptyObject(r.attributes))for(l in r.attributes)mi(r.attributes,l)&&t.attr(l,r.attributes[l]);Wi(t,r.data),t.markup(">"),a&&r.iconPosition===z&&t.markup("<span").attr(B,!0).attr(tt,o+" a-Icon--left").markup("></span>"),i.iconOnly?t.markup("<span").attr(B,!0).attr(tt,o).markup("></span>"):r.label&&t.markup("<span").attr(tt,"a-Button-label").markup(">").content(r.label).markup("</span>"),a&&r.iconPosition===j&&t.markup("<span").attr(B,!0).attr(tt,o+" a-Icon--right").markup("></span>"),t.markup("</button>")}function Zi(t,i){Ki(t,e.extend({type:te},i))}function Qi(t,i){var n=e.extend({cssClasses:"",text:"",data:{}},i);t.markup("<a href='#'").attr(tt,n.cssClasses),Wi(t,n.data),t.markup(">").content(n.text).markup("</a>")}function Ji(t,i){var n,o=e.extend({cssClasses:"u-Form-label",ariaHidden:!1,labelFor:"",label:"",labelHidden:!1,labelTextHidden:!1},i);n=o.cssClasses,o.labelHidden&&(n+=" u-VisuallyHidden"),t.markup("<label").attr(tt,n).attr("for",o.labelFor).optionalAttr(B,o.ariaHidden?"true":null).markup(">"),o.labelTextHidden?t.markup("<span").attr(tt,F).markup(">").content(o.label).markup("</span>"):t.content(o.label),t.markup("</label>")}function en(t,i){Ki(t,e.extend({type:"radio"},i))}function tn(e){var t;for(fi(e)||(e=[e]),t=0;t<e.length;t++)d(e[t][0]).show()}function nn(e){var t;for(fi(e)||(e=[e]),t=0;t<e.length;t++)d(e[t][0]).hide()}function on(e,t){var i;for(fi(e)||(e=[e]),i=0;i<e.length;i++)e[i].prop(me,t).closest(".u-Form-fieldContainer").toggleClass("is-required",t)}function an(e,i){let n,a,l,d,c=null,u=null,h=null,g="apexDialogPromptInputId",p=t.htmlBuilder(),m=t.getTopApex().jQuery;"item"===e.type&&(u=e.columnItem,h=e.viewInst),p.markup("<div class='u-Form u-Form--labelsAbove u-Form--stretchInputs'>").markup("<div class='u-Form-fieldContainer'><div class='u-Form-labelContainer  u-tS'><span class='u-Form-label'>"),u&&u.item.setLabel||Ji(p,{labelFor:g,label:e.label||_i(e.labelKey)}),p.markup("</span></div><div class='u-Form-inputContainer'>"),d={id:g,value:e.value||"",required:!!e.required},"number"===e.type||"item"!==e.type&&Yi(p,d),p.markup("</div></div></div>"),n=m(p.toString()),l={title:_i(e.titleKey),dialogClass:"",confirm:!0,defaultButton:!0,beforeClose:function(){if(u){let e,t=u.item;a=t.getValue(),e=t.displayValueFor(a),a!==e&&(a={v:a,d:e}),t.setValue(c,null,!0),h._deactivateColumnItem(u),t.setLabel&&t.setLabel(null)}else a=m("#"+g).val()},callback:function(e){var t=!1;e&&(t=a),i(t)},init:function(t){if(u){let i=u.item,n=t.find(".u-Form-inputContainer");c=i.getValue(),i.setValue(i.nullValue||"",null,!0),n.empty().append(u.element$),h._activateColumnItem(u,g),i.setLabel&&i.setLabel(e.label)}},open:function(){m("#"+g).trigger("focus")}},e.okLabelKey&&(l.okLabelKey=e.okLabelKey),e.helpKey&&(l.extraButtons=[{text:_i("APEX.DIALOG.HELP"),CLASS:"ui-button-help",click:function(){o.loadMessagesIfNeeded([e.helpKey,e.helpTitleKey],(function(){r.popupFieldHelp({title:_i(e.helpTitleKey),helpText:_i(e.helpKey)})}))}}]),s.showDialog(n,l)}Mi.toolbarInsertAfter=function(e,t){Hi(this,e,!1,t)},Mi.toolbarRemove=function(e){return Hi(this,e,!0)},Mi.toolbarFind=function(e){return Hi(this,e,!1)};var ln={_allowInteraction:function(t){return e(t.target).closest(".a-IRR-sortWidget").length>0||this._super(t)}};e.ui.dialog&&(e.widget("ui.dialog",e.ui.dialog,ln),e.widget("apex.popup",e.apex.popup,ln)),e.widget("apex.interactiveGrid",{version:"21.1",widgetEventPrefix:"interactivegrid",options:{config:{toolbarData:null,modelInstanceId:null,initActions:null,columns:[],ajaxColumns:"",regionId:"",regionStaticId:"",columnGroups:[],ajaxIdentifier:"",itemsToSubmit:"",editable:!1,submitSelectedRows:!1,parentRegionStaticId:null,trackParentSelection:!0,lazyLoading:!1,filter:{row:!0,complex:!0,isRequired:!1,maxRowCount:null,oracleText:!1},appearance:{showNullValue:"",useFixedRowHeight:!0},pagination:{type:Be,showTotalRowCount:!1},text:{noDataFound:Ci("NO_DATA_FOUND"),moreDataFound:"",addRowButton:Ci("ADD_ROW"),help:""},toolbar:{reset:!0,save:!0,columnSelection:!0,searchField:!0,savedReports:!0,editing:!0,addRow:!0,actionMenu:!0},reportSettingsArea:{disabled:!1},features:{saveReport:{publicReportCs:"",isDeveloper:!1,authorizations:[]},download:!1,filter:!0,flashback:!0},initialSelection:!0,headingFixedTo:Ke,maxHeight:null,views:{icon:!1,detail:!1,grid:{disabled:!1,features:{reorderColumns:!0,resizeColumns:!0,sort:!0,stretchColumns:null,highlight:!0,controlBreak:!0,aggregate:!0,changeRowsPerPage:!0,cellRangeActions:!0,singleRowView:!0,gridView:!0,rowSelector:{multiSelect:!0,selectAll:!0,hideControl:!1}}},chart:{disabled:!1,features:{}}},defaultModelOptions:{},defaultGridViewOptions:{},defaultIconViewOptions:{},defaultDetailViewOptions:{},defaultSingleRowOptions:{},unsupported:{aggregateFunctions:[],chartFunctions:[],sortFunctions:[]}},savedReports:[],data:null,selectionChange:null,viewChange:null,reportChange:null,reportSettingsChange:null,viewModelCreate:null,save:null,modeChange:null},_create:function(){var n=this,o=this.element,r=this.options,s=r.config,c=e(".a-IG").length;function h(e,t){for(const[i,o]of Object.entries(e)){const a=t[i].useModelFrom;let l=o;a&&t[a].shareModel&&(l=e[a]),l.model&&l.model.subscribe({onChange:function(e){"destroy"===e?setTimeout((()=>{n._report(n._currentReportSettings().id),n.setMasterRecord(l.model,null)}),0):["delete","revert","refreshRecords","setValue","clearChanges"].includes(e)&&n.setMasterRecord(l.model,n.parentRecordId?l.model.getRecord(n.parentRecordId):null)}})}}if(!r.config)throw new Error("Missing required config option.");if(!r.savedReports)throw new Error("Missing required saved reports configuration.");if(this.idPrefix=o[0].id||"ig"+(c+1),this.viewsImpl={},this.columnMap={},this.baseModelColumns={},this.primaryKeyColumns=[],this.parentColumnNames=[],this.parentItemValues=[],this.parentModel="",this.parentRecordId=null,this.editMode=!1,this.currentSavedReportIdx="",this.toolbar$=null,this.currentFilterColumnId=null,this.searchCaseSensitive=!1,this.ignoreResizeHandler=!1,this.actions=a.createContext("InteractiveGrid",o[0],s.regionStaticId),this.reportSettingsSeq=1,this.modelReportSettingsSeq={},this.isRTL="rtl"===o.css("direction"),o.addClass(m),this._defaultIGConfig(),s.maxHeight&&o.height(s.maxHeight).css("overflow","hidden"),s.toolbar&&!s.toolbarData&&(s.toolbarData=xi()),this._defaultColumns(),this._createBaseColumnMap(),this._defaultSavedReports(),this._registerIGViews(),this._renderIG(),this._addActions(this.actions),s.initActions&&s.initActions(this.actions),s.toolbar&&(this._initToolbar(),this._updateToolbarElements()),this._forEachView((function(e,t){t.init(n)})),this._updateActions(),this.editableView=null,s.editable&&(this._forEachView((function(e,t){t.supports.edit&&(null===n.editableView?n.editableView=e:i.warn("Extra editable view ignored: "+e))})),null===this.editableView))throw new Error("No editable view for editable Interactive Grid");if(e("#"+s.regionStaticId).hasClass("resize")?o.addClass("resize").on("resize",(function(){n.resize()})):u.onElementResize(o[0],(function(){n.ignoreResizeHandler||n.resize()})),this.resize(),l.create(s.regionStaticId,{type:"InteractiveGrid",parentRegionId:s.parentRegionStaticId,widgetName:"interactiveGrid",refresh:function(){n.refresh()},focus:function(){n.focus()},widget:function(){return n.element},gotoError:function(e){n.gotoCell(null,e.record,e.column)},getSessionState:function(e){var t,i,o,a={beforeAsync:function(){var e=n._currentViewImpl();e.supports.edit&&e.lockActive&&e.lockActive()},afterAsync:function(){var e=n._currentViewImpl();e.supports.edit&&e.unlockActive&&e.unlockActive()}},l=[],r=[],s=n._currentViewImpl().getActiveRecordId();if(e)for(t=0;t<e.length;t++)(i=n._getColumnByStaticId(e[t]))?s&&r.push({n:i.name,v:d(e[t]).getValue()}):l.push(e[t]);return a.pageItems=l,r.length>0&&(o=n._currentViewImpl().model.getRecordMetadata(s),a.region=n._defaultAjaxRegionData({setSessionState:{values:r,protected:o.protected,salt:o.salt}})),a},alternateLoadingIndicator:function(e){var i,o=n._currentViewImpl();return o.internalIdentifier===Ie&&!o.singleRowMode&&(i=o.view$.grid("getActiveCellFromColumnItem",e))?t.showSpinner(i,{spinnerClass:"u-Processing--cellRefresh"}):null}}),s.headingFixedTo===Ke&&s.toolbar&&e.apex.stickyWidget&&e(_,o).stickyWidget({stickToEnd:!0,bottom:function(){return o.offset().top+e(".a-IG-body",o).outerHeight()-n._currentViewImpl().footerHeight()},toggleWidth:!0}),this._view(this._view(),{initialData:r.data,fetchData:s.lazyLoading}),u.onVisibilityChange(o[0],(function(e){e&&(u.updateResizeSensors(o[0]),n.actions.update("search"),n.resize())})),s.parentRegionStaticId&&s.trackParentSelection){const i=e("#"+s.parentRegionStaticId+"_ig"),o=i.interactiveGrid("getViews"),a=i.interactiveGrid("option","config.views");this._forEachView((function(e,t){t.view$&&t.setNoDataMessage(Ci("SELECT_1_ROW_IN_MASTER"))})),i.on("interactivegridselectionchange.ig",t.debounce((function(e,t){const i=1===t.selectedRecords.length?t.selectedRecords[0]:null;n.setMasterRecord(t.model,i)}),300)),i.on("interactivegridreportchange.ig",(function(){h(o,a)})),h(o,a)}},_setOption:function(t,i){var n=!1,o=this.options;"config"===t&&(i.modelInstanceId!==o.config.modelInstanceId&&(n=!0),i=e.extend(!0,o.config,i)),this._super(t,i),n&&this._setModelInstance(o.config.modelInstanceId)},_destroy:function(){var e=this,t=this.options.config;u.offElementResize(this.element[0]),this.element.removeClass(m).empty(),a.removeContext("InteractiveGrid",this.element[0]),this._destroyAllModels(),this._forEachView((function(t,i){i.destroy(e)})),l.destroy(t.regionStaticId)},_isCurrentlyEditable:function(){var e=this.options.config,t=this._currentReportSettings().flashback,i=t&&t.isEnabled;return e.editable&&!i},_setModelInstance:function(e,t,i){const n=this.options.config,o=e!==n.modelInstanceId;if(this.parentRecordId=null,n.modelInstanceId=e,n.parentRegionStaticId&&(this.parentRecordId=n.modelInstanceId,this.parentItemValues=[],t&&i))for(let e=0;e<this.parentColumnNames.length;e++)this.parentItemValues.push({n:this.parentColumnNames[e],v:t.getValue(i,this.parentColumnNames[e])});if(o){let t=!0,i=n.text.noDataFound;null===e&&(i=Ci("SELECT_1_ROW_IN_MASTER"),t=!1),this._forEachView(((e,n)=>{n.view$&&(n.setNoDataMessage(i),this._setModel({viewImpl:n,updateComponent:!0,fetchData:t}))}))}},_setInitialSelection:function(e){var t,i,n,o=this.options.config;t=this._currentViewImpl(),o.initialSelection&&t.supports.selection&&(o.pagination.type!==Be||0===e)&&((n=t.getSelectedRecords())&&0!==n.length||(i=t.model.recordAt(e))&&t.setSelectedRecords([i]))},_selectionChange:function(e){var t=this._currentViewImpl(),i=t.getSelectedRecords()||[];this._updateSelectionActions(),this._trigger("selectionChange",e,{selectedRecords:i,model:t.model})},_pageChange:function(e){var t=this;setTimeout((function(){t._setInitialSelection(e.offset)}),1)},_registerIGViews:function(){var e,t,n,o=this.options.config,a=0;for(e=0;e<rn.length;e++)t=rn[e],(n=o.views[t.internalIdentifier])&&!n.disabled&&(this._registerView(t),a+=1);0===a&&i.error("No views registered.")},_isViewRegistered:function(e){return!!this.viewsImpl[e]},_registerView:function(t){var i=this,n=e.extend(!0,{supports:{edit:!1,selection:!0,cellSelection:!1,highlight:!1,controlBreak:!1,aggregation:!1,singleRowView:!1,configurableColumns:!1,filter:!0,sort:!0,changeRowsPerPage:!0,download:!1,totalRows:!0},isConfigured:function(){return!!i._currentReportSettings().views[this.internalIdentifier]},initDialog:null,openDialog:function(){!this.dialog$&&this.initDialog&&this.initDialog(i),this.dialog$.dialog("open")},clearModelData:function(){this.model.getOption("parentModel")&&!this.model.getOption("parentRecordId")||(i.modelReportSettingsSeq[this.model.modelId()]=i.reportSettingsSeq,this.model.clearData())},setColumnConfig:function(){},init:function(){},updateActions:function(){},initView:function(){},viewChanged:function(){},setReportOptions:function(){},destroyView:function(){},destroy:function(){},getSelectedRecords:function(){return[]},setSelectedRecords:function(){},getActiveRecordId:function(){return null},getContextRecord:function(){return[]},gotoCell:null,selectCells:null,getColumns:null,canCopy2Clipboard:function(){return!1},setModelName:function(){},setEditMode:function(){},finishEditing:null,setNoDataMessage:function(){},focus:function(){},refreshColumns:function(){},footerHeight:function(){return 0},refresh:function(){},resize:function(){},show:function(){this.view$.show()},hide:function(){this.view$.hide()}},t);n.model=null,n.modelName=null,n.modelColumns=null,n.view$=null,n.elementId=n.internalIdentifier+"_vc",this.viewsImpl[n.internalIdentifier]=n},_forEachView:function(e){var t;for(t in this.viewsImpl)mi(this.viewsImpl,t)&&e(t,this.viewsImpl[t])},_getPaginationConfig:function(t,i){var n={},o=t.pagination;return i&&t[i].pagination&&(n=e.extend({},t[i].pagination)),n.scroll=o.type===Ue||o.type===Be,n.scroll&&(n.virtual=Ii(n.virtual,o.showTotalRowCount)),n.showPageLinks=Ii(n.showPageLinks,o.type===qe&&o.showTotalRowCount),n.firstAndLastButtons=Ii(n.firstAndLastButtons,o.type===qe&&o.showTotalRowCount),n},_renderDialogContent:function(i){var n,o,a=this,l=t.htmlBuilder();n=function(e,t){a._renderColumnItem(l,e,t)},l.markup("<div").attr(tt,"a-GV-columnItemContainer u-vh").attr(B,!0).markup(">"),i(n,l),l.markup("</div>"),o=e(l.toString()),this.element.append(o),apex.item.attach(o)},_createDialog:function(t,i,n){var o,a,l,r,s,d,c,u,h=e.extend(!0,{width:640,height:380,classPrefix:v,labelAlignment:le,formCssClasses:"u-Form--labelsAbove u-Form--stretchInputs",useSplitter:!0,splitterPosition:280,persistSplitter:t,noDataMessage:Ci("NO_DATA_FOUND"),modelOptions:{shape:"record",editable:!0,onlyMarkForDelete:!1,identityField:"id"}},n);for(o in s=(t+="Dialog")+"$",d=this._getId(t.replace(/[A-Z]/g,(function(e){return"_"+e.toLowerCase()}))),(r=h.dialogHelp)||(h.dialogHelp=r={}),r.helpTextKey="APEX.IG.HELP."+(r.helpTextKey||h.titleKey),r.titleKey=r.titleKey?"APEX.IG.HELP."+r.titleKey:r.helpTextKey+"_TITLE",h.titleKey="APEX.IG."+h.titleKey,h.modelName=h.modelName?this._getId(h.modelName):d,a=h.modelOptions.fields)mi(a,o)&&((l=a[o]).label&&(l.label=Ci(l.label),l.heading||"table"!==h.modelOptions.shape||(l.heading=l.label)),l.elementId&&(l.elementId=this._getId(l.elementId)));return n.checkboxColumn&&(u=h.init,h.init=function(t,i,n){var o="isEnabled";i.on("click",G,(function(){var n=e(this),a=i.grid("getRecords",[n.parent()])[0],l=!t.getValue(a,o);t.setValue(a,"enabledClass",l?x:""),t.setValue(a,"enabledText",Ci(l?"ENABLED":"DISABLED")),t.setValue(a,o,l)})).on("keydown",G,(function(t){t.which===e.ui.keyCode.SPACE&&e(this).trigger("click")})),Fi(n,o),u.call(this,t,i,n)},a.enabledClass={volatile:!0,canHide:!1,hidden:!0,seq:0,defaultValue:x},a.enabledText={volatile:!0,canHide:!1,hidden:!0,seq:0,defaultValue:Ci("ENABLED")}),this._renderDialogContent(i),c=e.apex.recordView.createModelEditDialog(d,h),n.viewDialog||(this[s]=c),c},_renderColumnItem:function(t,i,n){switch(t.markup("<div").attr(tt,"a-GV-columnItem").markup(">"),n.id&&(n.id=this._getId(n.id)),i){case te:Zi(t,n);break;case Q:!function(t,i){var n,o,a=e.extend({id:"",cssClasses:"apex-item-select",size:"1",title:"",required:!1,options:[]},i);for(t.markup("<select").optionalAttr("id",a.id).attr(tt,a.cssClasses).attr("size",a.size).optionalAttr("title",a.title).optionalBoolAttr(me,a.required).markup(">"),n=0;n<a.options.length;n++)o=a.options[n],t.markup("<option").attr("value",o.value).optionalBoolAttr("selected",o.isSelected).markup(">").content(o.label||o.value).markup("</option>");t.markup("</select>")}(t,n);break;case Z:Yi(t,n);break;case ee:!function(t,i){var n=e.extend({id:"",cssClasses:"apex-item-textarea",cols:"30",rows:"4",name:"",placeholder:"",disabled:!1,readonly:!1,required:!1,toolbar:!1,style:"resize: both;",wrap:"virtual"},i);n.toolbar&&(t.markup("<fieldset ").attr("id",i.id+"_fieldset").markup(">"),t.markup("<div").attr("id",n.id+"_toolbar").markup("></div>")),t.markup("<textarea").attr("id",n.id).attr(tt,n.cssClasses).attr("cols",n.cols).attr("rows",n.rows).optionalAttr("name",n.name).optionalAttr("placeholder",n.placeholder).optionalAttr("style",n.style).optionalAttr("wrap",n.wrap).optionalBoolAttr(fe,n.disabled).optionalBoolAttr("readonly",n.readonly).optionalBoolAttr(me,n.required).markup(">").markup("</textarea>"),n.toolbar&&t.markup("</fieldset>")}(t,n);break;case"radios":!function(t,i){var n,o,a,l=e.extend({id:"",label:"",name:"",radios:[]},i);for(t.markup("<div role='group'").attr("id",l.id).attr(X,"id1").markup(">"),n=0;n<l.radios.length;n++)o=l.radios[n],a=l.id+"_"+n,en(t,{name:l.name,id:a,value:o.value,checked:o.checked,cssClasses:"a-IG-dialog-input-checkbox"}),Ji(t,{labelFor:a,cssClasses:"a-IG-dialog-label-checkbox",label:o.label});t.markup("</div>")}(t,n);break;case J:!function(t,i){t.markup("<div ").attr(tt,"apex-item-group apex-item-group--color-picker a-Combobox-wrapper").markup(">"),Yi(t,e.extend({cssClasses:"color_picker apex-item-text apex-item-color-picker",data:{"display-as":"POPUP","display-mode":"FULL",colors:i.colors,"contrast-item":i.contrastItem||null,"max-colors":""+i.colors.split(";").length}},i)),t.markup("</div>")}(t,n);break;case ie:!function(t,i){var n,o,a=e.extend({id:"",iconOnly:!1,cssClasses:"",options:[]},i);for(t.markup("<fieldset ").attr(tt,b).attr("id",a.id+"_fieldset").markup(">"),t.markup("<ul ").attr(tt,"a-IG-dialog-iconList "+a.cssClasses).attr("id",a.id+"_list").markup(">"),n=0;n<a.options.length;n++)o=a.options[n],t.markup("<li").attr("data-value",o.value).attr(tt,"a-IG-dialog-iconList-item"+(o.isSelected?" is-selected":"")).markup(">").markup("<span ").attr(tt,"a-IG-dialog-iconList-link").attr(q,o.label||o.value).attr("title",o.label||o.value).markup(">").markup("<span ").attr(tt,"a-IG-dialog-iconList-icon a-Icon "+o.iconCssClasses).attr(B,!0).markup("></span>"),!1===a.iconOnly&&t.markup("<span ").attr(tt,"a-IG-dialog-iconList-label").markup(">").content(o.label||o.value).markup("</span>"),t.markup("</span>").markup("</li>");t.markup("</ul>"),t.markup("<input ").attr("type","hidden").attr(B,!0).attr("id",a.id).markup(">"),t.markup("</fieldset>")}(t,n)}t.markup("</div>")},_renderReportSettingsDialog:function(){var t,i=[],n=[],o=this.options.config,a=o.features.saveReport.isDeveloper,l=this;a&&(i.push({value:Ae,label:Ci("PRIMARY")}),i.push({value:Re,label:Ci("ALTERNATIVE")})),i.push({value:Se,label:Ci("SAVED_REPORT_PRIVATE")}),o.features.saveReport.publicReportCs&&i.push({value:Te,label:Ci("SAVED_REPORT_PUBLIC")}),$i(o.features.saveReport.authorizations,n,"r","d","",Ci(di)),this._createDialog("reportSettings",(function(e){e(Q,{id:"SRD_TYPE",options:i}),e(Z,{id:"SRD_NAME"}),e(Q,{id:"SRD_AUTHORIZATION",options:n})}),{height:350,titleKey:"REPORT",defaultButton:!0,modelOptions:{fields:{id:{canHide:!1,hidden:!0,seq:0},type:{label:"TYPE",elementId:"SRD_TYPE",seq:10,defaultValue:"named"},name:{label:"NAME",elementId:"SRD_NAME",seq:20},authorizationId:{label:"AUTHORIZATION",elementId:"SRD_AUTHORIZATION",seq:30}}},load:function(i){var n,o=e(this),r=o.dialog(Ce,"saveAs"),s=e.extend({id:"",type:"",name:"",authorizationId:""},l._currentReportSettings());return n=r?"REPORT_SAVE_AS":"REPORT_EDIT",o.dialog(Ce,"title",Ci(n)),t=s.type,r&&(s.name="",(a||e.inArray(s.type,[Ae,Re])>-1)&&(s.type=Se)),i.setData(s),l._report()},init:function(i,n,o){var a=l._getElement("SRD_TYPE"),r=l._getElement("SRD_NAME"),s=l._getElement("SRD_AUTHORIZATION"),d=e(this);function c(){var e,i;switch(i=d.dialog(Ce,"saveAs")&&t===Ae,a.find("option[value=primary]").prop(fe,i),e=a.val(),a.prop(fe,!1),on(r,!0),nn(s),e){case Ae:t===Ae&&a.prop(fe,!0),on(r,!1);break;case Re:tn(s)}}a.on(ki,c),o.on("apexbeginrecordedit",c)},store:function(t){var i=e(this).dialog(Ce,"saveAs"),n=t.getRecord();i?(n.baseReportId=n.id,l.addReport(n)):l.updateReport(n.id,n),l._updateReportSettingsActions()}})},_renderDownloadDialog:function(){var t,i=this,n=Ci("MAILADDRESSES_COMMASEP"),o=this.options.config.features.download,a=[],l=[],r=[],s=o&&o.print&&o.print.orientation||"VERTICAL",d=o&&o.print&&o.print.paperSize||"LETTER",c=o&&o.print&&o.print.accessible||!1,u=je,h=je;o&&o.formats.length>0&&(t=o.formats[0]),o&&-1!==o.formats.indexOf("CSV")&&a.push({value:"CSV",label:Ci("FORMAT_CSV"),iconCssClasses:"icon-ig-dl-xls"}),o&&-1!==o.formats.indexOf("HTML")&&a.push({value:"HTML",label:Ci("FORMAT_HTML"),iconCssClasses:"icon-ig-dl-html"}),o&&-1!==o.formats.indexOf("PDF")&&(a.push({value:"PDF",label:Ci("FORMAT_PDF"),iconCssClasses:"icon-ig-dl-pdf"}),l=[{value:"LETTER",label:Ci("PRINT_PAGE_SIZE.LOV.LETTER.D")},{value:"LEGAL",label:Ci("PRINT_PAGE_SIZE.LOV.LEGAL.D")},{value:"TABLOID",label:Ci("PRINT_PAGE_SIZE.LOV.TABLOID.D")},{value:"A4",label:Ci("PRINT_PAGE_SIZE.LOV.A4.D")},{value:"A3",label:Ci("PRINT_PAGE_SIZE.LOV.A3.D")}],o&&o.print&&"CUSTOM"===o.print.paperSize&&l.unshift({value:"CUSTOM",label:Ci("PRINT_PAGE_SIZE.LOV.CUSTOM.D")}),r=[{value:"VERTICAL",label:Ci("PRINT_ORIENTATION.LOV.VERTICAL.D")},{value:"HORIZONTAL",label:Ci("PRINT_ORIENTATION.LOV.HORIZONTAL.D")}]),o&&-1!==o.formats.indexOf("XLSX")&&a.push({value:"XLSX",label:Ci("FORMAT_XLSX"),iconCssClasses:"icon-ig-dl-xls"}),this._createDialog(He,(function(e){e(ie,{id:"DL_DOWNLOAD_FORMAT",options:a}),e(Q,{id:"DL_PRINT_PAGE_SIZE",options:l}),e(Q,{id:"DL_PRINT_ORIENTATION",options:r}),e(te,{id:"DL_PRINT_ACCESSIBLE",value:ze,checked:c}),e(te,{id:"DL_PRINT_STRIP_RICH_TEXT",value:ze}),e(te,{id:"DL_DATA_ONLY",value:ze}),e(te,{id:"DL_SEND_AS_EMAIL",value:je}),e(Z,{id:"DL_EMAIL_TO",placeholder:n}),e(Z,{id:"DL_EMAIL_CC",placeholder:n}),e(Z,{id:"DL_EMAIL_BCC",placeholder:n}),e(Z,{id:"DL_EMAIL_SUBJECT"}),e(ee,{id:"DL_EMAIL_BODY"})}),{height:500,titleKey:"DOWNLOAD",modelOptions:{fields:{id:{canHide:!1,hidden:!0,seq:0},format:{label:"DOWNLOAD_FORMAT",elementId:"DL_DOWNLOAD_FORMAT",seq:10},dataOnly:{label:"DOWNLOAD_DATA_ONLY",elementId:"DL_DATA_ONLY",seq:200},sendOrDownload:{label:"SEND_AS_EMAIL",elementId:"DL_SEND_AS_EMAIL",seq:200},emailTo:{label:"EMAIL_TO",elementId:"DL_EMAIL_TO",seq:210},emailCc:{label:"EMAIL_CC",elementId:"DL_EMAIL_CC",seq:220},emailBcc:{label:"EMAIL_BCC",elementId:"DL_EMAIL_BCC",seq:230},emailSubject:{label:"EMAIL_SUBJECT",elementId:"DL_EMAIL_SUBJECT",seq:240},emailBody:{label:"EMAIL_BODY",elementId:"DL_EMAIL_BODY",seq:250},sendEmail:{canHide:!1,hidden:!0,seq:0},printPageSize:{label:"PRINT_PAGE_SIZE.PROMPT",elementId:"DL_PRINT_PAGE_SIZE",seq:100,fieldColSpan:6},printOrientation:{label:"PRINT_ORIENTATION.PROMPT",elementId:"DL_PRINT_ORIENTATION",seq:110,fieldColSpan:6},printAccessible:{label:"PRINT_ACCESSIBLE.PROMPT",elementId:"DL_PRINT_ACCESSIBLE",seq:120},printStripRichText:{label:"PRINT_STRIP_RICH_TEXT.PROMPT",elementId:"DL_PRINT_STRIP_RICH_TEXT",seq:130}}},load:function(e){e.setData({id:0,format:t,dataOnly:h,sendEmail:je,printOrientation:s,printPageSize:d,printAccessible:c?ze:je,printStripRichText:u})},init:function(t,n,o){var a,l,r=i._getElement("DL_DOWNLOAD_FORMAT"),s=i._getElement("DL_SEND_AS_EMAIL"),d=i._getElement("DL_EMAIL_TO"),c=i._getElement("DL_EMAIL_CC"),u=i._getElement("DL_EMAIL_BCC"),h=i._getElement("DL_EMAIL_SUBJECT"),g=i._getElement("DL_EMAIL_BODY"),p=i._getElement("DL_PRINT_PAGE_SIZE"),m=i._getElement("DL_PRINT_ORIENTATION"),f=i._getElement("DL_PRINT_ACCESSIBLE"),_=i._getElement("DL_PRINT_STRIP_RICH_TEXT"),C=i._getElement("DL_DATA_ONLY"),I=e(this),v=I.dialog(Ce,"buttons");function b(){!0===s.prop(_e)?(tn([d,c,u,h,g]),on([d,h],!0),v[a].text=Ci("SEND_AS_EMAIL"),I.dialog(Ce,"buttons",v),null!==o.recordView("getRecord")&&t.setValue(o.recordView("getRecord"),"sendEmail",ze)):(nn([d,c,u,h,g]),on([d,h],!1),v[a].text=Ci("DOWNLOAD"),I.dialog(Ce,"buttons",v),null!==o.recordView("getRecord")&&t.setValue(o.recordView("getRecord"),"sendEmail",je))}for(l=0;l<v.length;l++)if(v[l].text===_i("APEX.DIALOG.SAVE")){a=l;break}o.on("apexbeginrecordedit",(function(){var n=r.val();const a=i._getCurrentView().columns.some((e=>e.isVisible&&!i._getColumn(e.columnId).escape)),l=function(){let e,t,n,o;const a=i._getCurrentView();function l(e){return e.some((e=>e.isEnabled&&!e.isInvalid))}return t=l(a.aggregations),n=l(a.highlights),e=a.columns.some((e=>e.break&&e.break.isEnabled)),r=a.columns,o=r.some((e=>i._getColumn(e.columnId).layout.groupId)),e||t||n||o;var r}(),d=[{fields:[p,m,f],active:e=>"PDF"===e},{fields:[_],active:e=>["CSV","XLSX"].includes(e)&&a},{fields:[C],active:e=>"CSV"!==e&&l}];zi(i._getId("DL_DOWNLOAD_FORMAT"),n),b(),!0===i.options.config.features.download.email?s.on(ki,b):nn(s),r.on(ki,(function(){const i=e(this).val();t.setValue(o.recordView("getRecord"),"format",i),d.forEach((e=>{e.active(i)?tn(e.fields):nn(e.fields)}))}))}))},store:function(e){var n,o=e.getRecord();t=o.format,c=o.printAccessible,s=o.printOrientation,d=o.printPageSize,u=o.printStripRichText,h=o.dataOnly,n={format:o.format,dataOnly:o.dataOnly===ze},"Y"===o.sendEmail&&(n.email={to:o.emailTo,subject:o.emailSubject},o.emailCc&&""!==o.emailCc&&(n.email.cc=o.emailCc),o.emailBcc&&""!==o.emailBcc&&(n.email.bcc=o.emailBcc),o.emailBody&&""!==o.emailBody&&(n.email.body=o.emailBody)),"PDF"===o.format&&(n.print={pageSize:o.printPageSize,orientation:o.printOrientation,accessible:o.printAccessible===ze,stripRichText:o.printStripRichText===ze}),["CSV","XLSX"].includes(o.format)&&(n.print={stripRichText:o.printStripRichText===ze}),i._downloadReport(n)}})},_columnFilterModelFields:function(e){var t=e+"_";return{type:{label:t+"TYPE",elementId:t+"TYPE",seq:100,canHide:!0,hidden:!0,defaultValue:oe},search:{label:"SEARCH",elementId:t+"SEARCH",seq:119,canHide:!0,hidden:!0},columnId:{label:"COLUMN",elementId:t+"COLUMN",seq:120,fieldColSpan:6,canHide:!0,hidden:!0},operator:{label:"OPERATOR",elementId:t+"OPERATOR",seq:130,fieldColSpan:6,canHide:!0,hidden:!0,defaultValue:gt},value:{label:"VALUE",elementId:t+"VALUE",seq:140,canHide:!0,hidden:!0},dateRangeValue:{label:"VALUE",elementId:t+"DATE_RANGE_VALUE",seq:141,fieldColSpan:6,canHide:!0,hidden:!0},dateRangeUnit:{label:"UNIT",elementId:t+"DATE_RANGE_UNIT",seq:142,fieldColSpan:6,canHide:!0,hidden:!0},isCaseSensitive:{label:"CASE_SENSITIVE",elementId:t+"CASE_SENSITIVE",seq:150,canHide:!0,hidden:!0,defaultValue:"N"},between:{label:"VALUE",elementId:t+"BETWEEN",seq:160,fieldColSpan:6,canHide:!0,hidden:!0},and:{label:"AND",elementId:t+"AND",seq:170,fieldColSpan:6,canHide:!0,hidden:!0},expression:{label:"EXPRESSION",elementId:t+"EXPRESSION",seq:180,canHide:!0,hidden:!0},hiddenValue:{seq:999,canHide:!0,hidden:!0},hiddenBetween:{seq:999,canHide:!0,hidden:!0},hiddenAnd:{seq:999,canHide:!0,hidden:!0}}},_renderSortControls:function(e,t){e(Q,{id:t+"DIRECTION",required:!0,options:[{value:Ge,label:Ci("ASCENDING")},{value:"desc",label:Ci("DESCENDING")}]}),e(Q,{id:t+"NULLS",required:!0,options:[{value:Fe,label:Ci("FIRST")},{value:Pe,label:Ci("LAST")}]})},_columnFilterDialogControls:function(e,t){var i,n,o=[],a=this.options.config.columns,l=t+"_";for(i=0;i<a.length;i++)n=a[i],("FD"===t&&this._isColumnFilterable(n.id)||"HD"===t&&!this._getColumn(n.id).specialType&&!this._getColumn(n.id).isHidden)&&o.push({value:n.id,label:this._getColumnLabel(n.id)});e(Q,{id:l+"TYPE",options:[{value:ne,label:Ci("ROW")},{value:oe,label:Ci("COLUMN")}]}),e(Q,{id:l+"COLUMN",options:o}),e(Q,{id:l+"OPERATOR",options:[]}),e(Z,{maxChars:4e3,id:l+"VALUE"}),e(Z,{maxChars:4e3,id:l+"SEARCH"}),e(Z,{maxChars:20,id:l+"DATE_RANGE_VALUE"}),e(Q,{id:l+"DATE_RANGE_UNIT",options:[{value:"MI",label:Ci("MINUTES")},{value:"H",label:Ci("HOURS")},{value:"D",label:Ci("DAYS")},{value:"W",label:Ci("WEEKS")},{value:"M",label:Ci("MONTHS")},{value:"Y",label:Ci("YEARS")}]}),e(te,{id:l+"CASE_SENSITIVE",value:ze}),e(Z,{maxChars:100,id:l+"BETWEEN"}),e(Z,{maxChars:100,id:l+"AND"}),e(Z,{maxChars:40,id:l+"NAME"}),e(ee,{id:l+"EXPRESSION",toolbar:!0})},_columnFilterInitActions:function(t,i,n,a,l){var r,s,d=this,c=a+"_",u="FD"===a,h=[],g=d._getElement(c+"TYPE"),m=d._getElement(c+"COLUMN"),f=d._getElement(c+"OPERATOR"),_=d._getElement(c+"VALUE"),C=d._getElement(c+"BETWEEN"),I=d._getElement(c+"AND"),v=d._getElement(c+"NAME"),b=d._getElement(c+"EXPRESSION"),E=d._getElement(c+"CASE_SENSITIVE"),w=d._getElement(c+"DATE_RANGE_VALUE"),A=d._getElement(c+"DATE_RANGE_UNIT"),R=d._getElement(c+"SEARCH");function S(){var e;u&&null!==n.recordView("getRecord")&&(e=d._shortenString(d._getSettingLabel(ye,n.recordView("getRecord")),37),v.val(e).trigger("change"))}function T(e){e.hasClass(L)&&e.combobox(se),e.hasClass(O)&&(e.parent().find("a-date-picker").remove(),e.show(),e.removeClass(O))}function N(e,i){null!==n.recordView("getRecord")&&t.setValue(n.recordView("getRecord"),e,i)}function y(t){var i=g.val(),n=f.val();switch(nn([m,f,_,C,I,b,E,w,A,R]),u&&nn(v),N("type",i),i){case ne:tn(R),d.options.config.filter.oracleText?(E.prop(fe,!0),nn(E)):(E.prop(fe,!1),tn(E)),T(_),S();break;case oe:tn([m,f]),e.inArray(n,[St,Tt])>-1?tn([C,I]):e.inArray(n,[Nt,Lt,yt,Ot])>-1?tn([w,A]):tn(_),V(t)}}function V(i){var l,s,u,v,b={},w=m.val();if(g.val()===oe&&w){if((r=d._getColumn(w)).filter.textCase)switch(r.filter.textCase.toLowerCase()){case"upper":_.css({"text-transform":"uppercase"}),C.css({"text-transform":"uppercase"}),I.css({"text-transform":"uppercase"});break;case"lower":_.css({"text-transform":"lowercase"}),C.css({"text-transform":"lowercase"}),I.css({"text-transform":"lowercase"});break;default:_.css({"text-transform":"none"}),C.css({"text-transform":"none"}),I.css({"text-transform":"none"})}if("HD"===a)switch(r.dataType){case Mt:b.EQ=Ci(gi.EQ),b.NEQ=Ci(gi.NEQ),b.N=Ci(gi.N),b.NN=Ci(gi.NN),b[wt]=Ci(gi[wt]),b[At]=Ci(gi[At]),b.C=Ci(gi.C),b.NC=Ci(gi.NC),b.S=Ci(gi.S),b.NS=Ci(gi.NS),b.REGEXP=Ci(gi.REGEXP);break;case xt:b.EQ=Ci(gi.EQ),b.NEQ=Ci(gi.NEQ),b.GT=Ci(gi.GT),b.GTE=Ci(gi.GTE),b.LT=Ci(gi.LT),b.LTE=Ci(gi.LTE),b.N=Ci(gi.N),b.NN=Ci(gi.NN),b[wt]=Ci(gi[wt]),b[At]=Ci(gi[At]),b.BETWEEN=Ci(gi.BETWEEN),b.NBETWEEN=Ci(gi.NBETWEEN);break;case Ht:case Ft:case Pt:case Ut:b.EQ=Ci(gi.EQ),b.NEQ=Ci(gi.NEQ),b.GT=Ci(gi.GT),b.GTE=Ci(gi.GTE),b.LT=Ci(gi.LT),b.LTE=Ci(gi.LTE),b.N=Ci(gi.N),b.NN=Ci(gi.NN),e.inArray(r.filter.dateRanges,[ct,ut])>-1&&(b.LAST=Ci(gi.LAST),b.NLAST=Ci(gi.NLAST)),e.inArray(r.filter.dateRanges,[ct,ht])>-1&&(b.NEXT=Ci(gi.NEXT),b.NNEXT=Ci(gi.NNEXT)),b.BETWEEN=Ci(gi.BETWEEN),b.NBETWEEN=Ci(gi.NBETWEEN);break;case Gt:b.N=Ci(gi.N),b.NN=Ci(gi.NN)}else for(E.prop(fe,!0),s=0;s<r.filter.operators.length;s++)if("$std$"===(u=r.filter.operators[s]).name)switch(r.filter.dataType){case Mt:b.EQ=Ci(gi.EQ),b.NEQ=Ci(gi.NEQ),b.N=Ci(gi.N),b.NN=Ci(gi.NN),b[wt]=Ci(gi[wt]),b[At]=Ci(gi[At]);break;case xt:b.EQ=Ci(gi.EQ),b.NEQ=Ci(gi.NEQ),b.GT=Ci(gi.GT),b.GTE=Ci(gi.GTE),b.LT=Ci(gi.LT),b.LTE=Ci(gi.LTE),b.N=Ci(gi.N),b.NN=Ci(gi.NN),b[wt]=Ci(gi[wt]),b[At]=Ci(gi[At]),b.BETWEEN=Ci(gi.BETWEEN),b.NBETWEEN=Ci(gi.NBETWEEN);break;case Ht:case Ft:case Pt:case Ut:b.EQ=Ci(gi.EQ),b.NEQ=Ci(gi.NEQ),b.GT=Ci(gi.GT),b.GTE=Ci(gi.GTE),b.LT=Ci(gi.LT),b.LTE=Ci(gi.LTE),b.N=Ci(gi.N),b.NN=Ci(gi.NN),e.inArray(r.filter.dateRanges,[ct,ut])>-1&&(b.LAST=Ci(gi.LAST),b.NLAST=Ci(gi.NLAST)),e.inArray(r.filter.dateRanges,[ct,ht])>-1&&(b.NEXT=Ci(gi.NEXT),b.NNEXT=Ci(gi.NNEXT)),b.BETWEEN=Ci(gi.BETWEEN),b.NBETWEEN=Ci(gi.NBETWEEN);break;case Gt:b.N=Ci(gi.N),b.NN=Ci(gi.NN)}else"$perform$"===u.name?e.inArray(r.filter.dataType,[Mt,Gt])>-1&&(b.C=Ci(gi.C),b.NC=Ci(gi.NC),b.S=Ci(gi.S),b.NS=Ci(gi.NS),b.REGEXP=Ci(gi.REGEXP),r.filter.textCase&&"MIXED"===r.filter.textCase.toUpperCase()&&E.prop(fe,!1)):"CASE_INSENSITIVE"===u.name?r.filter.textCase&&"MIXED"===r.filter.textCase.toUpperCase()&&E.prop(fe,!1):b[u.name]=Ci(gi[u.name]);v=t.getValue(n.recordView("getRecord"),"operator"),f.empty();for(const[t,i]of Object.entries(b))f.append(e(Y).attr("value",t).text(i));v&&null!==v&&e.inArray(v,b)&&f.val(v),null===f.val()&&f.val(gt),N("operator",f.val()),function(){var i,a,l,s;function u(t,i){const n=r.appearance.dateFormatMask,a=-1!==n.toLowerCase().indexOf("hh");let l=i;if(l)try{l=p.format(p.parse(l,hi),n)}catch(e){}e("<a-date-picker>").attr("show-time",a).attr("autocomplete","off").attr("format",n).attr("id",t.substring(1)+"_dp").attr("name",t.substring(1)).attr("value",l).attr("today-button","true").attr("change-month","true").attr("change-year","true").attr("aria-labelledby",t.substring(1)+"_LABEL").attr("placeholder",o.formatMessageNoEscape("APEX.SAMPLE_FORMAT_SHORT",r.appearance.formatExample)).change((function(){let i=e(this).val();if(i)try{i=p.format(p.parse(i,n),hi)}catch(e){}e(t).val(i),e(t).trigger("change")})).appendTo(e(t).parent()),e(t).hide(),e(t).val(i),e(t).addClass(O)}s=n.recordView("getRecord"),i=t.getValue(s,"hiddenValue"),a=t.getValue(s,"hiddenBetween"),l=t.getValue(s,"hiddenAnd"),T(_),T(C),T(I),e("#"+d._getId(c+"VALUE")+"_LABEL ").text(Ci("VALUE")),r.filter.dataType===Ht||r.filter.dataType===Ft||r.filter.dataType===Pt||r.filter.dataType===Ut?(r.filter.dataType===Pt&&e("#"+d._getId(c+"VALUE")+"_LABEL ").text(Ci("VALUE_TIMESTAMP_TZ")),u("#"+d._getId(c+"VALUE"),i),u("#"+d._getId(c+"BETWEEN"),a),u("#"+d._getId(c+"AND"),l)):(_.combobox({label:Ci("VALUE")}),C.combobox({label:Ci("VALUE")}),I.combobox({label:Ci("AND")}),_.val(i),C.val(a),I.val(l))}(),d._hasColumnFilterLov(w)?d._getFilterValues(w,!1,(function(e){if(h=[],e.regions[0].filterValues)for(l=e.regions[0].filterValues,s=0;s<l.length;s++)h.push({label:l[s],value:l[s]});C.hasClass(L)&&C.combobox(Ce,"source",h),I.hasClass(L)&&I.combobox(Ce,"source",h),_.hasClass(L)&&_.combobox(Ce,"source",h)})):(T(_),T(C),T(I)),N("columnId",w),i&&(_.val("").trigger("change"),C.val("").trigger("change"),I.val("").trigger("change")),D()}}function D(){var t=f.val();g.val()===oe&&(nn([_,C,I,w,A,E]),null!==t&&(-1===e.inArray(r.filter.dataType,[Ht,Ft,Pt,Ut])&&_.hasClass(L)&&(e.inArray(t,[wt,At])>-1?(_.combobox(Ce,"multipleValues",!0),_.combobox(Ce,"multipleValueDelimiter","; "),_.prop("placeholder",o.formatMessage("APEX.IG.PLACEHOLDER_INVALUES",Rt))):(_.combobox(Ce,"multipleValues",!1),_.prop("placeholder",""))),e.inArray(t,[bt,Et,Vt,Dt,kt])>-1&&!1===E.prop(fe)&&tn(E),e.inArray(s,[St,Tt])>-1&&-1===e.inArray(t,[St,Tt])&&_.trigger(ki),-1===e.inArray(s,[St,Tt])&&e.inArray(t,[St,Tt])>-1&&(C.trigger(ki),I.trigger(ki)),e.inArray(s,[Nt,Lt,yt,Ot])>-1&&-1===e.inArray(t,[Nt,Lt,yt,Ot])&&_.trigger(ki),e.inArray(t,[St,Tt])>-1?tn([C,I]):e.inArray(t,[Nt,Lt,yt,Ot])>-1?(tn([w,A]),M()):-1===e.inArray(t,[It,vt])&&tn(_))),s=t,S()}function k(e){var i,o,a,l,r=d._getElement(c+e);"VALUE"===e&&(i="hiddenValue"),"SEARCH"===e&&(i="hiddenValue"),"BETWEEN"===e&&(i="hiddenBetween"),"AND"===e&&(i="hiddenAnd"),t.setValidity("valid",n.recordView("getRecord").id,e.toLowerCase()),r.hasClass(O)?""===r.val()?(l="",a=""):(o=r.parent().find("a-date-picker")[0].getNativeValue())&&!isNaN(o.getTime())?(l=r.val(),a=Bi(o)):(""!==r.val()&&t.setValidity(et,n.recordView("getRecord").id,e.toLowerCase(),Ci("DATE_INVALID_VALUE")),l=r.val(),a=r.val()):"uppercase"===r.css("text-transform")?(a=r.val().toUpperCase(),l=r.val().toUpperCase()):"lowercase"===r.css("text-transform")?(a=r.val().toLowerCase(),l=r.val().toLowerCase()):(a=r.val(),l=r.val()),N(i,a),N(e.toLowerCase(),l),S()}function M(){_.val(w.val()+Ye+A.val()),N("value",_.val()),N("dateRangeValue",w.val()),N("dateRangeUnit",A.val()),S()}w.on(ki,M),A.on(ki,M),E.on(ki,(function(){var e=E.prop(_e);N("isCaseSensitive",e),E.prop(_e,e)})),g.on(ki,(function(){y(!0)})),m.on(ki,(function(){V(!0)})),f.on(ki,D),_.on(ki,(function(){k("VALUE")})),R.on(ki,(function(){k("SEARCH")})),C.on(ki,(function(){k("BETWEEN")})),I.on(ki,(function(){k("AND")})),n.on("apexbeginrecordedit",(function(){y(),"function"==typeof l&&l()}))},_renderFilterDialog:function(){var t=this;this._createDialog(ye,(function(e){t._columnFilterDialogControls(e,"FD")}),{titleKey:"FILTERS",dialogHelp:{helpTextKey:"FILTER"},checkboxColumn:!0,modelOptions:{shape:"table",fields:e.extend({id:{canHide:!1,hidden:!0,seq:0},isEnabled:Gi(),name:{headingAlignment:le,label:"NAME",elementId:"FD_NAME",width:100,seq:105,escape:!1}},this._columnFilterModelFields("FD"))},load:function(i){var n,o,a,l,r,s=[],d=t.getFilters(),c=e(this).dialog(Ce,"id");if(d.length>0){for(n=0;n<d.length;n++){switch(o=(a=e.extend({id:"",type:"",columnId:"",operator:"",value:"",hiddenValue:"",dateRangeValue:"",dateRangeUnit:"",isCaseSensitive:!1,between:"",and:"",hiddenBetween:"",hiddenAnd:"",isEnabled:"",enabledClass:"",enabledText:"",name:"",expression:"",search:""},d[n])).isEnabled,a.enabledClass=o?x:"",a.enabledText=Ci(o?"ENABLED":"DISABLED"),a.name=t._getSettingLabel(ye,a),a.type){case ne:a.search=a.value,a.hiddenValue=a.value;break;case oe:a.hiddenValue=a.value,e.inArray(a.operator,[St,Tt])>-1?(l=a.value.split(Ye),a.hiddenBetween=l[0],a.hiddenAnd=l[1],a.hiddenValue="",a.value=""):e.inArray(a.operator,[Nt,Lt,yt,Ot])>-1&&(r=a.value.split(Ye),a.dateRangeValue=r[0],a.dateRangeUnit=r[1],a.hiddenValue="",a.value=""),e.inArray(a.operator,[wt,At])>-1&&(a.value=a.value.split("").join("; "),a.hiddenValue=a.value)}a.isCaseSensitive=a.isCaseSensitive?ze:je,s.push(a)}i.setData(s)}else c=i.insertNewRecord();return c},init:function(e,i,n){Fi(n,"hiddenValue"),Fi(n,"hiddenBetween"),Fi(n,"hiddenAnd"),t._columnFilterInitActions(e,i,n,"FD")},validate:function(e,i,n){var o,a,l,r,s=!0;function d(e,t){return!isNaN(h.toNumber(e,t))}return e.forEach((function(e,c,u){switch(i(u,"between"),i(u,"and"),i(u,"value"),i(u,"expression"),e.type){case oe:switch(o=t._getColumn(e.columnId),a=o.filter.dataType,l=o.appearance.formatMask,e.operator){case St:case Tt:e.hiddenBetween&&""!==e.hiddenBetween||(s=!1,n(u,"between",Ci(li))),e.hiddenAnd&&""!==e.hiddenAnd||(s=!1,n(u,"and",Ci(li))),s&&(a===xt?(d(e.hiddenBetween,l)?e.hiddenBetween=h.toNumber(e.hiddenBetween,l):(s=!1,n(u,"between",Ci(si))),d(e.hiddenAnd,l)?e.hiddenAnd=h.toNumber(e.hiddenAnd,l):(s=!1,n(u,"and",Ci(si)))):[Ht,Ft,Pt,Ut].includes(a)&&(e.hiddenBetween!==Bi(Ui(e.hiddenBetween))&&(s=!1,n(u,"between",Ci(ri))),e.hiddenAnd!==Bi(Ui(e.hiddenAnd))&&(s=!1,n(u,"and",Ci(ri)))));break;case Nt:case Lt:case yt:case Ot:e.dateRangeValue&&""!==e.dateRangeValue||(s=!1,n(u,"dateRangeValue",Ci(li))),e.dateRangeUnit&&""!==e.dateRangeUnit||(s=!1,n(u,"dateRangeUnit",Ci(li)));break;case gt:case pt:case _t:case Ct:case mt:case ft:case wt:case At:e.hiddenValue&&""!==e.hiddenValue?a===xt?(r=[wt,At].includes(e.operator)?e.hiddenValue.split(Rt):[e.hiddenValue]).some((e=>!d(e,l)))?(s=!1,n(u,"value",Ci(si))):e.hiddenValue=r.map((e=>h.toNumber(e,l))).join(Rt):[Ht,Ft,Pt,Ut].includes(a)&&e.hiddenValue!==Bi(Ui(e.hiddenValue))&&(s=!1,n(u,"value",Ci("DATE_INVALID_VALUE"))):(s=!1,n(u,"value",Ci(li)))}break;case ne:e.hiddenValue&&""!==e.hiddenValue||(s=!1,n(u,"search",Ci(li)))}})),s},store:function(i){t._ifNoChangesDo((function(){var n,o,a,l={save:!1,skipNoChangesCheck:!0},r=i.getChanges();for(n=0;n<r.length;n++){switch(delete(a=(o=r[n]).record).enabledClass,delete a.enabledText,a.type){case ne:a.value=a.search,delete a.expression,delete a.columnId,delete a.and,delete a.between,delete a.hiddenAnd,delete a.hiddenBetween,delete a.dateRangeValue,delete a.dateRangeUnit,delete a.operator,delete a.search,a.isCaseSensitive=a.isCaseSensitive===ze;break;case oe:a.value=a.hiddenValue,e.inArray(a.operator,[St,Tt])>-1?a.value=a.hiddenBetween+Ye+a.hiddenAnd:e.inArray(a.operator,[Nt,Lt,yt,Ot])>-1&&(a.value=a.dateRangeValue+Ye+a.dateRangeUnit),e.inArray(a.operator,[wt,At])>-1&&(a.value=qi(a.value.split(Rt)).join("")),delete a.dateRangeValue,delete a.dateRangeUnit,delete a.between,delete a.and,delete a.hiddenValue,delete a.hiddenBetween,delete a.hiddenAnd,delete a.expression,delete a.search,a.isCaseSensitive=a.isCaseSensitive===ze}o.inserted?(delete a.id,a.columnType=oe,t.addFilter(a,l)):o.updated?(a.columnType=oe,t.updateFilter(a.id,a,l)):o.deleted&&t.deleteFilter(a.id,l)}t._setReportSettings({refreshModel:!0})}))}})},_renderColumnsDialog:function(){var t=this,i=[],n=this.options.config.views[this._view()].features;function o(i){var n,o,a,l,r=[],s=t._getCurrentView().columns;function d(e){return!(e.id!==a.columnId||e.specialType&&"actions"!==e.specialType||e.isHidden)}for(n=0;n<s.length;n++)a=s[n],(o=(o=e.grep(t.options.config.columns,d)).length>0&&o[0])&&(l={id:a.columnId,columnId:a.columnId,columnWidth:a.width,seq:n+1,heading:"actions"===o.specialType?Ci("ROW_ACTIONS"):o.heading.label,groupId:o.layout.groupId,canHide:o.features.canHide,isVisible:a.isVisible,enabledClass:a.isVisible?x:""},"ALL"===i||"VISIBLE"===i&&a.isVisible?r.push(l):"INVISIBLE"!==i||l.isVisible||r.push(l));return r}$i(this.options.config.columnGroups,i,"id","label","",""),this._createDialog(Ne,(function(e){e(Z,{id:"CD_COLUMN_WIDTH"}),e(Q,{id:"CD_COLUMN_GROUP",options:i})}),{titleKey:"COLUMNS",modelOptions:{shape:"table",canDelete:!1,canAdd:!1,sequenceField:n.reorderColumns?"seq":null,fields:{id:{canHide:!1,hidden:!0,seq:0},isVisible:Gi("VISIBLE"),heading:{label:"COLUMN",headingAlignment:le,elementId:"CD_COLUMN_HEADING",canHide:!0,hidden:!1,width:100,seq:20},groupId:{label:"GROUP",elementId:"CD_COLUMN_GROUP",canHide:!0,escape:!1,volatile:!0,hidden:!0,seq:30},columnWidth:{label:"WIDTH",elementId:"CD_COLUMN_WIDTH",canHide:!0,hidden:!0,seq:40},columnId:{label:"COLUMN",elementId:"CD_COLUMN",seq:0,canHide:!0,hidden:!0},seq:{canHide:!1,hidden:!0,seq:0},canHide:{canHide:!1,hidden:!0,seq:0},enabledClass:{volatile:!0,canHide:!1,hidden:!0,defaultValue:x,seq:0}}},load:function(e){e.setData(o(this.showColumns))},init:function(t,i,n,l){var r,s=this;this.showColumns||(this.showColumns="ALL"),r=[{type:st,iconOnly:!0,icon:"icon-up-chevron",action:"move-up"},{type:st,iconOnly:!0,icon:"icon-down-chevron",action:"move-down"},{type:dt,labelKey:"APEX.IG.SHOW",icon:"icon-ig-select-cols",iconOnly:!0,menu:{items:[{type:lt,action:"show-columns"}]}}],a.findContext("ModelEditDialog",this).add([{name:"show-columns",choices:[{label:Ci("ALL"),value:"ALL"},{label:Ci("VISIBLE"),value:"VISIBLE"},{label:Ci("INVISIBLE"),value:"INVISIBLE"}],get:function(){return s.showColumns},set:function(e){s.showColumns=e;var i=o(e);t.setData(i)}}]),l.toolbar({data:[{align:"start",controls:r}]}),i.on("click",G,(function(){var n,o,a=e(this);o=i.grid("getRecords",[a.parent()])[0],t.getValue(o,"canHide")&&(n=!t.getValue(o,"isVisible"),t.setValue(o,"enabledClass",n?x:""),t.setValue(o,"isVisible",n))})).on("keydown",G,(function(t){t.which===e.ui.keyCode.SPACE&&e(this).trigger("click")})),n.on("apexbeginrecordedit",(function(){""===t.getValue(n.recordView("getRecord"),"groupId")?Fi(n,"groupId"):Pi(n,"groupId")})),Fi(n,"columnId"),Fi(n,"isVisible")},validate:function(e,t,i){var n,o=!0;return e.forEach((function(e,a,l){null!==(n=e.columnWidth)&&""!==n&&isNaN(parseInt(n,10))?(i(l,"columnWidth",Ci(ri)),o=!1):t(l,"columnWidth")})),o},store:function(e){var i,n,o,a=!1,l=t._getCurrentView().columns,r=t._currentViewImpl().getColumns();for(l.sort((function(e,t){return e.seq-t.seq})),i=0;i<l.length;i++)!0===l[i].isFrozen&&(a=i+1);for(e.forEach((function(e){(o=e.columnWidth)&&null!==o||(o=""),o=o.toString(),t._currentViewColumn(e.columnId,{isVisible:e.isVisible,width:parseInt(o,10),seq:parseFloat(e.seq)})})),l.sort((function(e,t){return e.seq-t.seq})),i=0;i<l.length;i++)for(n=0;n<r.length;n++)if(l[i].columnId===r[n].id){r[n].seq=l[i].seq,r[n].canHide&&(r[n].hidden=!l[i].isVisible),r[n].width=l[i].width,l[i].seq=i,!1!==a&&i>=a&&(l[i].isFrozen=!1,r[n].frozen=!1),!1!==a&&i<a&&(l[i].isFrozen=!0,r[n].frozen=!0);break}t._setReportSettings({refreshView:!0,refreshColumns:!0})}})},_renderHighlightDialog:function(){var t,i,n=this,o=this.options.config.columns,a=[];for(i=0;i<o.length;i++)t=o[i],this._getColumn(t.id).specialType||this._getColumn(t.id).isHidden||a.push({value:t.id,label:this._getColumnLabel(t.id)});this._createDialog(Le,(function(e){n._columnFilterDialogControls(e,"HD"),e(J,{id:"HD_BACKGROUND_COLOR",size:"7",colors:"#fff5ce;#d0f1cc;#cce5ff;#ffd6d2;#e8e8e8;#000000;#ffffff",contrastItem:n._getId("HD_TEXT_COLOR"),itemLabel:Ci("BACKGROUND_COLOR")}),e(J,{id:"HD_TEXT_COLOR",size:"7",colors:"#a96e17;#3baa2c;#0076df;#f44336;#767676;#000000;#ffffff",contrastItem:n._getId("HD_BACKGROUND_COLOR"),itemLabel:Ci("TEXT_COLOR")}),e(Q,{id:"HD_HIGHLIGHT_TYPE",options:[{value:ne,label:Ci("ROW")},{value:oe,label:Ci("COLUMN")}]}),e(Q,{id:"HD_HIGHLIGHT_COLUMN",options:a})}),{width:800,height:580,titleKey:"HIGHLIGHT",checkboxColumn:!0,modelOptions:{shape:"table",sequenceField:"seq",fields:e.extend({id:{canHide:!1,hidden:!0,seq:0},seq:{canHide:!1,hidden:!0,seq:0},isEnabled:Gi(),name:{label:"NAME",headingAlignment:le,elementId:"HD_NAME",isRequired:!0,width:100,seq:15},highlightType:{label:"HIGHLIGHT",elementId:"HD_HIGHLIGHT_TYPE",seq:20,canHide:!0,hidden:!0},highlightColumnId:{label:"COLUMN",elementId:"HD_HIGHLIGHT_COLUMN",seq:30,canHide:!0,hidden:!0},backgroundColor:{label:"BACKGROUND_COLOR",elementId:"HD_BACKGROUND_COLOR",seq:40,fieldColSpan:4,canHide:!0,hidden:!0},textColor:{label:"TEXT_COLOR",elementId:"HD_TEXT_COLOR",seq:50,fieldColSpan:4,canHide:!0,hidden:!0},preview:{label:"COLOR_PREVIEW",cellTemplate:`<div id='${this._getId("HD_PREVIEW")}' class='a-IG-highlightPreview'>Aa</div><div class='a-IG-highlightContrast'>${apex.widget.util.colorPicker.renderColorContrastReport(this._getId("HD_CONTRAST"))}</div>`,seq:60,fieldColSpan:4,canHide:!0,hidden:!0}},this._columnFilterModelFields("HD"))},load:function(t){var i,o,a,l,r,s=[],d=n.getHighlights(),c=e(this).dialog(Ce,"id");if(d.length>0){for(i=0;i<d.length;i++){switch((l={id:(r=d[i]).id,seq:r.seq,name:r.name,highlightType:r.type,highlightColumnType:r.columnType,highlightColumnId:r.columnId,backgroundColor:r.backgroundColor,textColor:r.textColor,type:r.condition.type,columnType:r.condition.columnType,columnId:r.condition.columnId,operator:r.condition.operator,isCaseSensitive:r.condition.isCaseSensitive?ze:je,value:r.condition.value,expression:r.condition.expression,isEnabled:r.isEnabled,hiddenValue:"",dateRangeValue:"",dateRangeUnit:"",between:"",and:"",hiddenBetween:"",hiddenAnd:"",enabledClass:"",enabledText:"",search:""}).enabledClass=l.isEnabled?x:"",l.enabledText=l.isEnabled?Ci("ENABLED"):Ci("DISABLED"),l.hiddenValue=l.value,l.type){case ne:l.search=l.value;break;case oe:e.inArray(l.operator,[St,Tt])>-1?(o=l.value.split(Ye),l.hiddenBetween=o[0],l.hiddenAnd=o[1],l.hiddenValue="",l.value=""):e.inArray(l.operator,[Nt,Lt,yt,Ot])>-1&&(a=l.value.split(Ye),l.dateRangeValue=a[0],l.dateRangeUnit=a[1],l.hiddenValue="",l.value=""),e.inArray(l.operator,[wt,At])>-1&&(l.value=l.value.split("").join("; "),l.hiddenValue=l.value)}s.push(l)}t.setData(s)}else c=t.insertNewRecord();return c},init:function(e,t,i){let o=n._getElement("HD_HIGHLIGHT_TYPE"),a=n._getElement("HD_HIGHLIGHT_COLUMN"),l=n._getElement("HD_TEXT_COLOR"),r=n._getElement("HD_BACKGROUND_COLOR"),s=n._getElement("HD_NAME");function c(){var e=o.val(),t=d(a.attr("id"));e===ne?nn(a):(tn(a),t.setValue(t.getValue()))}l.add(r).on("change",(()=>{let e,t=n._getElement("HD_PREVIEW"),i=n._getElement("HD_CONTRAST"),o=d(r[0].id).getValue()||"#ffffff",a=d(l[0].id),s=a.getValue()||"#000000";t.css({backgroundColor:o,color:s}),a.whenReady().then((()=>{e=a.contrastWith(o),apex.widget.util.colorPicker.updateColorContrastReport(i,e)}))})),on(s,!0),Fi(i,"hiddenValue"),Fi(i,"hiddenBetween"),Fi(i,"hiddenAnd"),n._columnFilterInitActions(e,t,i,"HD",(function(){c(),l.trigger(ki),r.trigger(ki)})),o.on(ki,c)},validate:function(t,i,o){var a=!0;return t.forEach((function(t,l,r){switch(i(r,"between"),i(r,"and"),i(r,"value"),i(r,"expression"),i(r,"name"),i(r,"textColor"),i(r,"backgroundColor"),""===t.textColor&&""===t.backgroundColor&&(o(r,"textColor",Ci(li)),o(r,"backgroundColor",Ci(li))),""===t.name&&o(r,"name",Ci(li)),t.type){case oe:switch(t.operator){case St:case Tt:t.hiddenBetween&&""!==t.hiddenBetween||(a=!1,o(r,"between",Ci(li))),t.hiddenAnd&&""!==t.hiddenAnd||(a=!1,o(r,"and",Ci(li))),a&&e.inArray(n._getColumn(t.columnId).filter.dataType,[Ht,Ft,Pt,Ut])>-1&&(t.hiddenBetween!==Bi(Ui(t.hiddenBetween))&&(a=!1,o(r,"between",Ci(ri))),t.hiddenAnd!==Bi(Ui(t.hiddenAnd))&&(a=!1,o(r,"and",Ci(ri))));break;case Nt:case Lt:case yt:case Ot:t.dateRangeValue&&""!==t.dateRangeValue||(a=!1,o(r,"dateRangeValue",Ci(li))),t.dateRangeUnit&&""!==t.dateRangeUnit||(a=!1,o(r,"dateRangeUnit",Ci(li)));break;case gt:case pt:case _t:case Ct:case mt:case ft:case wt:case At:t.hiddenValue&&""!==t.hiddenValue?e.inArray(n._getColumn(t.columnId).filter.dataType,[Ht,Ft,Pt,Ut])>-1&&t.hiddenValue!==Bi(Ui(t.hiddenValue))&&(a=!1,o(r,"value",Ci("DATE_INVALID_VALUE"))):(a=!1,o(r,"value",Ci(li)))}break;case ne:t.hiddenValue&&""!==t.hiddenValue||(a=!1,o(r,"search",Ci(li)))}})),a},store:function(t){n._ifNoChangesDo((function(){var i,o,a,l,r,s={save:!1,skipNoChangesCheck:!0},d=t.getChanges();for(i=0;i<d.length;i++){switch((l=(o=d[i]).record).type){case ne:r={type:ne,value:l.search,isCaseSensitive:l.isCaseSensitive===ze};break;case oe:r={type:oe,value:l.hiddenValue,columnId:l.columnId,operator:l.operator,columnType:oe,isCaseSensitive:l.isCaseSensitive===ze},e.inArray(l.operator,[wt,At])>-1&&(r.value=qi(l.hiddenValue.split(Rt)).join("")),e.inArray(l.operator,[St,Tt])>-1?r.value=l.hiddenBetween+Ye+l.hiddenAnd:e.inArray(l.operator,[Nt,Lt,yt,Ot])>-1&&(r.value=l.dateRangeValue+Ye+l.dateRangeUnit)}a={id:l.id,seq:parseFloat(l.seq),name:l.name,type:l.highlightType,textColor:l.textColor,backgroundColor:l.backgroundColor,condition:r,isEnabled:l.isEnabled},l.highlightType===oe?(a.type=oe,a.columnType=oe,a.columnId=l.highlightColumnId):l.highlightType===ne&&(a.type=ne,delete a.columnType,delete a.columnId),o.inserted?(delete a.id,n.addHighlight(a,s)):o.updated?n.updateHighlight(a.id,a,s):o.deleted&&n.deleteHighlight(a.id,s)}n._setReportSettings({refreshModel:!0,changeIdentifier:"views.grid.highlights"})}))}})},_loadColumnOptions:function(e,t){var i,n,o,a=this.options.config.columns;for(e.push({value:"",label:Ci(di)}),i=0;i<a.length;i++)(o=a[i]).specialType||!o.features[t]||o.isHidden||(n||(n=o),e.push({value:o.id,label:this._getColumnLabel(o.id)}));return n},_renderSortDialog:function(){var e=[],t=this;this._loadColumnOptions(e,"sort"),this._createDialog(Ve,(function(i){i(Q,{id:"SD_COLUMN",required:!0,options:e}),t._renderSortControls(i,"SD_")}),{titleKey:"SORT",modelOptions:{shape:"table",identityField:"order",sequenceField:"seq",fields:{order:{canHide:!1,hidden:!0,seq:10},seq:{seq:20,canHide:!1,hidden:!0},columnId:{label:"COLUMN",headingAlignment:le,elementId:"SD_COLUMN",isRequired:!0,width:100,seq:30,canHide:!0,hidden:!1},direction:{label:"DIRECTION",headingAlignment:le,elementId:"SD_DIRECTION",width:60,seq:40,defaultValue:Ge,canHide:!0,hidden:!1},nulls:{label:"NULLS",elementId:"SD_NULLS",seq:50,defaultValue:Pe,canHide:!0,hidden:!0}}},load:function(e){var i,n,o=t.getSorts();for(i=0;i<o.length;i++)o[i].seq=i+1,o[i].order=i+1;return o.length>0?e.setData(o):n=e.insertNewRecord(),n},init:function(e,i,n){var o=t._getElement("SD_COLUMN"),a=t._getElement("SD_DIRECTION");t.options.config.unsupported.sortFunctions.includes("NULLS")?Fi(n,"nulls"):Pi(n,"nulls"),o.on(ki,(function(){e.setValue(n.recordView("getRecord"),"columnId",o.val())})),a.on(ki,(function(){e.setValue(n.recordView("getRecord"),"direction",a.val())}))},validate:function(e){var t={},i=!0;return e.forEach((function(e){t[e.columnId]?i=!1:t[e.columnId]=!0})),!1!==i||Ci("SORT_ONLY_ONE_PER_COLUMN")},store:function(e){var i,n,o,a,l,r=e.getChanges(),s=t.getSorts();for(i=0;i<s.length;i++)s[i].seq=i+1;for(i=0;i<r.length;i++)if(a=(o=r[i]).record,l=o.original,a.seq=parseFloat(a.seq),o.inserted)s.push(a);else if(o.updated)if(l.columnId===a.columnId){for(n=0;n<s.length;n++)if(a.columnId===s[n].columnId){s[n]=a;break}}else{for(n=0;n<s.length;n++)if(l.columnId===s[n].columnId){s.splice(n,1);break}s.push(a)}else if(o.deleted)for(n=0;n<s.length;n++)if(a.columnId===s[n].columnId){s.splice(n,1);break}s.length>0&&(s=s.sort((function(e,t){return e.seq-t.seq}))),r.length>0&&t.setSorts(s)}})},_renderAggregateDialog:function(){var t,i=[],n=[],o=this,a=o.options.config.unsupported.aggregateFunctions;t=this._loadColumnOptions(i,"aggregate"),[{value:pi.CNT,label:Ci(pi.CNT)},{value:pi.CNT_DIST,label:Ci(pi.CNT_DIST)},{value:pi.MIN,label:Ci(pi.MIN)},{value:pi.MAX,label:Ci(pi.MAX)},{value:pi.MEDIAN,label:Ci(pi.MEDIAN)},{value:pi.SUM,label:Ci(pi.SUM)},{value:pi.AVG,label:Ci(pi.AVG)}].forEach((function(e){a.includes(e.value)||n.push(e)})),this._createDialog(De,(function(e){e(Q,{id:"AD_COLUMN",required:!0,options:i}),e(Q,{id:"AD_AGGREGATION",required:!0,options:n}),e(Z,{maxlength:"30",id:"AD_TOOLTIP"}),e(te,{id:"AD_SHOW_GRAND_TOTAL",value:ze})}),{titleKey:"AGGREGATION",dialogHelp:{helpTextKey:"AGGREGATE"},checkboxColumn:!0,modelOptions:{shape:"table",fields:{id:{canHide:!1,hidden:!0,seq:0},isEnabled:Gi(),columnId:{label:"COLUMN",headingAlignment:le,elementId:"AD_COLUMN",isRequired:!0,defaultValue:"",seq:30,width:80,canHide:!0,hidden:!1},function:{label:"AGGREGATION",headingAlignment:le,elementId:"AD_AGGREGATION",isRequired:!0,seq:40,width:80,defaultValue:"",canHide:!0,hidden:!1},tooltip:{label:"TOOLTIP",elementId:"AD_TOOLTIP",seq:50,defaultValue:"",canHide:!0,hidden:!0},showGrandTotal:{label:"SHOW_OVERALL_VALUE",elementId:"AD_SHOW_GRAND_TOTAL",seq:60,defaultValue:ze,canHide:!0,hidden:!0}}},load:function(i){var n,a,l,r=[],s=e(this),d=s.dialog(Ce,"id"),c=s.dialog(Ce,"columnId"),u=o.getAggregates();function h(e){var t=o._getColumn(e);return l=t.filter.dataType===xt?pi.SUM:pi.CNT,i.insertNewRecord(null,null,{columnId:e,isEnabled:!0,enabledClass:x,function:l})}if(u.length>0){for(n=0;n<u.length;n++)(a=e.extend({id:"",columnId:"",function:"",tooltip:"",showGrandTotal:"",isEnabled:"",enabledClass:"",enabledText:""},u[n])).enabledClass=a.isEnabled?x:"",a.enabledText=a.isEnabled?Ci("ENABLED"):Ci("DISABLED"),a.showGrandTotal=a.showGrandTotal?ze:je,r.push(a);i.setData(r),c&&(d=h(c))}else d=h(c||t.id);return d},init:function(t,i,n){var l=o._getElement("AD_COLUMN"),r=o._getElement("AD_AGGREGATION"),s=o._getElement("AD_SHOW_GRAND_TOTAL");function d(){var i,s,d={},u=l.val();if(i=o._getColumn(u),u&&""!==u){Pi(n,"function"),Pi(n,"tooltip"),Pi(n,"showGrandTotal"),d[pi.CNT]=Ci(pi.CNT),i.filter.dataType!==Mt&&i.filter.dataType!==xt&&i.filter.dataType!==Ht||(a.includes(pi.CNT_DIST)||(d[pi.CNT_DIST]=Ci(pi.CNT_DIST)),a.includes(pi.MIN)||(d[pi.MIN]=Ci(pi.MIN)),a.includes(pi.MAX)||(d[pi.MAX]=Ci(pi.MAX))),a.includes(pi.MEDIAN)||i.filter.dataType!==xt&&i.filter.dataType!==Ht||(d[pi.MEDIAN]=Ci(pi.MEDIAN)),i.filter.dataType===xt&&(a.includes(pi.SUM)||(d[pi.SUM]=Ci(pi.SUM)),a.includes(pi.AVG)||(d[pi.AVG]=Ci(pi.AVG))),s=r.val(),r.empty(),r.append(e(Y).attr("value","").text(Ci(di)));for(const[t,i]of Object.entries(d))r.append(e(Y).attr("value",t).text(i));""!==s&&r.val(s),""!==r.val()&&null!==r.val()||(i.filter.dataType===xt?r.val(pi.SUM):r.val(pi.CNT)),t.setValue(n.recordView("getRecord"),"columnId",u),c()}else Fi(n,"function"),Fi(n,"tooltip"),Fi(n,"showGrandTotal"),t.setValue(n.recordView("getRecord"),"columnId",""),r.val("").trigger("change")}function c(){t.setValue(n.recordView("getRecord"),"function",r.val())}tn(l),l.on(ki,d),r.on(ki,c),s.on(ki,(function(){t.setValue(n.recordView("getRecord"),"showGrandTotal",s.prop(_e)?"Y":"N")})),n.on("apexbeginrecordedit",(function(){d()}))},validate:function(e,t,i){var n,o={},a=!0;return e.forEach((function(e,l,r){n=e.columnId.toString()+e.function,o[n]?(a=!1,i(r,"columnId",Ci("DUPLICATE_AGGREGATION")),i(r,"function",Ci("DUPLICATE_AGGREGATION"))):(o[n]=!0,t(r,"columnId"),t(r,"function")),""===e.columnId&&(i(r,"columnId",Ci("DUPLICATE_AGGREGATION")),a=!1)})),a},store:function(e){o._ifNoChangesDo((function(){var t,i,n,a={save:!1,skipNoChangesCheck:!0},l=e.getChanges();for(t=0;t<l.length;t++)(i=l[t]).record.columnId&&""!==i.record.columnId&&(delete(n=i.record).enabledClass,delete n.enabledText,n.showGrandTotal=n.showGrandTotal===ze,i.inserted?(delete n.id,n.columnType=oe,o.addAggregate(n,a)):i.updated?o.updateAggregate(n.id,n,a):i.deleted&&o.deleteAggregate(n.id,a));o._setReportSettings({refreshModel:!0,changeIdentifier:"views.grid.aggregations"})}))}})},_renderControlBreakDialog:function(){var t,i=[],n=this;t=this._loadColumnOptions(i,"sort"),this._createDialog(ke,(function(e){e(Q,{id:"CBD_COLUMN",required:!0,options:i}),n._renderSortControls(e,"CBD_")}),{titleKey:"CONTROL_BREAK",checkboxColumn:!0,modelOptions:{shape:"table",sequenceField:"sequenceField",fields:{id:{canHide:!1,hidden:!0,seq:0},sequenceField:{canHide:!1,hidden:!0,seq:0},oldColumnId:{canHide:!1,hidden:!0,seq:0},isEnabled:Gi(),columnId:{label:"COLUMN",headingAlignment:le,elementId:"CBD_COLUMN",isRequired:!0,seq:20,width:100,canHide:!0,hidden:!1},direction:{label:"DIRECTION",elementId:"CBD_DIRECTION",defaultValue:Ge,seq:30,canHide:!0,hidden:!0},nulls:{label:"NULLS",elementId:"CBD_NULLS",defaultValue:Pe,seq:40,canHide:!0,hidden:!0}}},load:function(i){var o,a,l,r,s=[],d=e(this).dialog(Ce,"id"),c=n._getCurrentView().columns;for(o=0;o<c.length;o++)(r=(a=c[o]).break)&&(l=e.extend({},{id:a.columnId,columnId:a.columnId,oldColumnId:a.columnId,direction:a.direction,nulls:a.nulls,sequenceField:parseFloat(r.order),isEnabled:r.isEnabled,enabledClass:r.isEnabled?x:""}),s.push(l));return s.length>0?(s.sort((function(e,t){return e.sequenceField<t.sequenceField?-1:e.sequenceField>t.sequenceField?1:0})),i.setData(s)):d=i.insertNewRecord({isEnabled:!0,id:t.columnId,columnId:t.columnId,oldColumnId:t.columnId,direction:t.sort?t.sort.direction:Ge,nulls:t.sort?t.sort.nulls:Pe}),d},init:function(e,t,i){var o=n._getElement("CBD_COLUMN"),a=n._getElement("CBD_DIRECTION"),l=n._getElement("CBD_NULLS");function r(){e.setValue(i.recordView("getRecord"),"columnId",o.val()),""===o.val()?nn([a,l]):tn([a,l])}o.on(ki,r),a.on(ki,(function(){e.setValue(i.recordView("getRecord"),"direction",a.val())})),l.on(ki,(function(){e.setValue(i.recordView("getRecord"),"nulls",l.val())})),i.on("apexbeginrecordedit",r)},validate:function(e,t,i){var n={},o=!0;return e.forEach((function(e,t,a){n[e.columnId]?(o=!1,i(a,"columnId",Ci("DUPLICATE_CONTROLBREAK"))):n[e.columnId]=!0,""===e.columnId&&(o=!1)})),o},store:function(e){n._ifNoChangesDo((function(){var t,i,o,a={save:!1,skipNoChangesCheck:!0},l=e.getChanges();function r(){n.addControlBreak(n._currentViewImpl().modelColumns[n._getColumn(o.columnId).name],{isEnabled:o.isEnabled,order:parseFloat(o.sequenceField),direction:o.direction,nulls:o.nulls},a)}for(t=0;t<l.length;t++)i=l[t],o=i.record,i.inserted?r():i.updated?o.columnId!==o.oldColumnId?(n.deleteControlBreak(o.oldColumnId,a),r()):n.updateControlBreak(o.columnId,{isEnabled:o.isEnabled,order:parseFloat(o.sequenceField),direction:o.direction,nulls:o.nulls},a):i.deleted&&n.deleteControlBreak(o.columnId,a);n._setReportSettings({refreshModel:!0,refreshColumns:!0})}))}})},_addActions:function(n){var a=this,l=this.options.config;n.add([{name:"search-case-sensitive",labelKey:"APEX.IG.CASE_SENSITIVE",value:!1,get:function(){return a.searchCaseSensitive},set:function(e){a.searchCaseSensitive=e}},{name:"filter-column",labelKey:"APEX.IG.SELECT_COLUMNS_TO_SEARCH",get:function(){return a.currentFilterColumnId},set:function(e){a._setFilterColumn(e)}},{name:"search",labelKey:"APEX.IG.GO",getSearchValue:function(e){let t="";l.toolbar&&l.toolbar.searchField&&(t=a._tbFindElement("search_field").val(),a._tbFindElement("search_field").val("")),e(t)},action:function(){this.getSearchValue((function(e){let t,i=a._currentReportSettings().filters.filter((t=>t.value===e&&t.type===ne));e&&!i.length?(t=a.currentFilterColumnId?{type:oe,columnType:oe,columnId:a.currentFilterColumnId,operator:bt,value:e,isCaseSensitive:a.searchCaseSensitive}:{type:ne,value:e,isCaseSensitive:a.searchCaseSensitive},a.addFilter(t)):a.refresh()}))}},{name:"change-report",labelKey:"APEX.IG.SAVED_REPORTS",hide:!0,choices:[],get:function(){return a._report()},set:function(e){a._ifNoChangesDo((function(t){t&&a.clearChanges(),a._report(e)}))}},{name:"change-view",labelKey:"APEX.IG.CHANGE_VIEW",choices:[],get:function(){return a._view()},set:function(e){a._view(e,{fetchData:!0})}},{name:"show-columns-dialog",labelKey:"APEX.IG.COLUMNS",icon:"icon-ig-select-cols",action:function(){return a._openDialog(Ne),!0}},{name:"show-filter-dialog",labelKey:"APEX.IG.FILTER",icon:"icon-ig-filter",hide:!0,action:function(){return a._openDialog(ye),!0}},{name:"chart-view",labelKey:"APEX.IG.CHART",icon:"icon-ig-chart",hide:!a._isViewRegistered(be),action:function(){a._isViewRegistered(be)?(a.viewsImpl.chart.isConfigured()&&a._view(be,{fetchData:!0}),a.viewsImpl.chart.openDialog()):i.error("Chart view is not defined.")}},{name:"show-sort-dialog",labelKey:"APEX.IG.SORT",icon:"icon-ig-sort",action:function(){return a._openDialog(Ve),!0}},{name:"show-aggregate-dialog",labelKey:"APEX.IG.AGGREGATE",icon:"icon-ig-aggregate",action:function(){return a._openDialog(De),!0}},{name:"show-flashback-dialog",labelKey:"APEX.IG.FLASHBACK",icon:"icon-ig-flashback",hide:!0,action:function(){return a._openDialog(Oe),!0}},{name:"show-highlight-dialog",labelKey:"APEX.IG.HIGHLIGHT",icon:"icon-ig-highlight",hide:!0,action:function(){return a._openDialog(Le),!0}},{name:"show-control-break-dialog",labelKey:"APEX.IG.CONTROL_BREAK",icon:"icon-ig-control-break",action:function(){return a._openDialog(ke),!0}},{name:"stretch-columns",labelKey:"APEX.IG.STRETCH_COLUMNS",hide:!0,get:function(){var e=a._view(),t=a._currentReportSettings().views[e];return t&&t.stretchColumns},set:function(e){var t=a._currentReportSettings(),i=a._view(),n=t.views[i];n&&(n.stretchColumns=e),a._setOperationUpdate(t),a._setReportSettings({changeIdentifier:"views.grid.columns"})}},{name:"change-rows-per-page",labelKey:"APEX.IG.ROWS_PER_PAGE",choices:[{labelKey:"APEX.IG.AUTO",value:"null"},{label:"5",value:5},{label:"10",value:10},{label:"15",value:15},{label:"20",value:20},{label:"25",value:25},{label:"50",value:50},{label:"100",value:100},{label:"1000",value:1e3}],get:function(){var e=a._currentReportSettings().rowsPerPage;return null===e?"null":e},set:function(e){var t=a._currentReportSettings();e="null"===e?null:parseInt(e,10),t.rowsPerPage=e,a._setOperationUpdate(t),a._setReportSettings({changeIdentifier:"rowsPerPage",refreshView:!0})}},{name:"save-report",labelKey:"APEX.IG.SAVE",icon:"icon-ig-save",action:function(){var e=a._currentReportSettings();a.updateReport(e.id,e)}},{name:"show-save-report-as-dialog",labelKey:"APEX.IG.SAVE_AS",icon:"icon-ig-save-as",action:function(){return a._openDialog(xe),!0}},{name:"show-edit-report-dialog",labelKey:"APEX.IG.EDIT",icon:"icon-ig-edit",action:function(){return a._openDialog(Me),!0}},{name:"delete-report",labelKey:"APEX.IG.DELETE",icon:"icon-ig-delete",action:function(){s.confirm(Ci("DELETE_REPORT_CONFIRM"),(function(e){e&&a.deleteReport(a._report())}))}},{name:"show-download-dialog",labelKey:"APEX.IG.DOWNLOAD",icon:"icon-ig-download",hide:!0,action:function(){return a._openDialog(He),!0}},{name:"show-help-dialog",labelKey:"APEX.IG.HELP",icon:"icon-ig-help",action:function(){var i=a.options.config;o.loadMessagesIfNeeded(["APEX.IG.HELP.ACTIONS.INTRO_HEADING","APEX.IG.HELP.ACTIONS.INTRO","APEX.IG.HELP.ACTIONS.REPORTING_HEADING","APEX.IG.HELP.ACTIONS.REPORTING","APEX.IG.HELP.ACTIONS.EDITING_HEADING","APEX.IG.HELP.ACTIONS.EDITING"],(function(){var n=t.htmlBuilder();function o(t,i){var n=e.extend({headingKey:"",helpText:"",helpTextKey:""},i);n.headingKey&&t.markup("<h2>").content(_i(n.headingKey)).markup("</h2>"),n.helpText&&t.markup("<div").attr(tt,"apex-help-custom").markup(">").markup(n.helpText).markup("</div>"),n.helpTextKey&&t.markup("<p>").markup(_i(n.helpTextKey)).markup("</p>")}i.text.help&&o(n,{helpText:i.text.help}),o(n,{headingKey:"APEX.IG.HELP.ACTIONS.INTRO_HEADING",helpTextKey:"APEX.IG.HELP.ACTIONS.INTRO"}),o(n,{headingKey:"APEX.IG.HELP.ACTIONS.REPORTING_HEADING",helpTextKey:"APEX.IG.HELP.ACTIONS.REPORTING"}),i.editable&&o(n,{headingKey:"APEX.IG.HELP.ACTIONS.EDITING_HEADING",helpTextKey:"APEX.IG.HELP.ACTIONS.EDITING"}),r.popupFieldHelp({title:Ci("HELP.ACTIONS_TITLE"),helpText:n.toString()})}))}},{name:"selection-mode",onLabelKey:"APEX.IG.SEL_MODE_CELL",offLabelKey:"APEX.IG.SEL_MODE_ROW",shortcut:"F8",hide:!0,get:function(){var e=a._currentViewImpl();return!e.view$||!e.supports.cellSelection||!e.selectCells()},set:function(e){var t=a._currentViewImpl();t.view$&&t.supports.cellSelection&&t.selectCells(!e)}},{name:"selection-duplicate",type:ot,labelKey:"APEX.IG.DUPLICATE_ROWS",icon:"icon-ig-duplicate",hide:!0,action:function(){var e,t=a._currentViewImpl();if(t.supports.edit&&(e=t.getSelectedRecords()).length>0)return t.model.copyRecords(e,null,e[e.length-1]),!0}},{name:"selection-delete",labelKey:"APEX.IG.DELETE_ROWS",icon:"icon-ig-delete",hide:!0,action:function(){var e,t,i=a._currentViewImpl();if(i.supports.edit){for(t=i.getSelectedRecords(),e=0;e<t.length;e++)i.model.allowDelete(t[e])||(t.splice(e,1),e-=1);t.length>0&&i.model.deleteRecords(t)}}},{name:"selection-refresh",labelKey:"APEX.IG.REFRESH_ROWS",icon:"icon-ig-refresh",action:function(){var e,t=a._currentViewImpl();t.supports.edit&&(e=t.getSelectedRecords()).length>0&&t.model.fetchRecords(e)}},{name:"selection-revert",labelKey:"APEX.IG.REVERT_CHANGES",icon:"icon-ig-revert",hide:!0,action:function(){var e,t,i=a._currentViewImpl();if(i.supports.edit){for(t=i.getSelectedRecords(),e=0;e<t.length;e++)i.model.canRevertRecord(t[e])||(t.splice(e,1),e-=1);t.length>0&&(i.model.revertRecords(t),a._updateSelectionActions())}}},{name:"selection-copy",labelKey:"APEX.IG.COPY_CB",icon:"icon-ig-copy",action:function(){var e=a._currentViewImpl();e.canCopy2Clipboard()&&(e.focus(),apex.clipboard.copy())}},{name:"refresh",labelKey:"APEX.IG.REFRESH",icon:"icon-ig-refresh",action:function(){a.refresh()}},{name:"reset-report",labelKey:"APEX.IG.RESET",disabled:!0,icon:"icon-ig-reset",action:function(){a._resetReportSettings()}},{name:"edit",labelKey:"APEX.IG.EDIT",ariaControls:this._getId("content_container"),offStateDescription:Ci("VIEW_MODE_DESCRIPTION"),onStateDescription:Ci("EDIT_MODE_DESCRIPTION"),hide:!0,get:function(){return a.editMode},set:function(e){a._setEditMode(e)}},{name:"save",labelKey:"APEX.IG.SAVE",hide:!0,shortcut:"Ctrl+Alt+S",action:function(){var e,t=a.options.config,i=a.editableViewImpl.model.name;c.anyErrors(!1,i,!0)?s.alert(_i("APEX.CORRECT_ERRORS"),(function(){})):a.editableViewImpl.finishEditing().done((function(){var n=null;void 0===t.saveLoadingIndicatorPosition&&void 0===t.saveLoadingIndicator||(n={loadingIndicatorPosition:t.saveLoadingIndicatorPosition||null,loadingIndicator:t.saveLoadingIndicator||null}),(e=c.save(null,n,i,!0))&&(e.done((function(e){var t,i,n="",o="";if(e.errors)s.clearErrors(),s.showErrors(e.errors),n=et;else if(e.regions){for(t=0;t<e.regions.length;t++)(i=e.regions[t]).fetchedData&&i.fetchedData.successMessage&&(o&&(o+="<br>"),o+=i.fetchedData.successMessage);o||(o=Ci("CHANGES_SAVED")),s.showPageSuccess(o),n="success"}a._selectionChange(null),a._trigger(Di,null,{status:n})})).fail((function(){a._trigger(Di,null,{status:"fail"})})).always((function(){a.actions.enable("save")})),a.actions.disable("save"))}))}},{name:"selection-add-row",label:l.text.addRowButton,hide:!0,action:function(){var e=a._currentViewImpl(),t=e.getSelectedRecords();if(!e.supports.singleRowView||!e.singleRowMode)return e.focus(),e.model.insertNewRecord(null,t[t.length-1]),!0;a.getActions().invoke("insert-record")}},{name:"single-row-view",label:Ci("SINGLE_ROW_VIEW"),icon:"icon-ig-single-row-view",hide:!0,action:function(e,t){var i,n=null,o=a.editMode,l=a._currentViewImpl();if(l.supports.singleRowView&&l.singleRowView$&&l.singleRowView$.length&&!l.singleRowMode)return t&&(n=l.getContextRecord(t)[0]),n||(n=l.getSelectedRecords()[0]),o&&l.view$.grid("setEditMode",!1),l.singleRowMode=!0,l.view$.hide(),l.curInst=l.singleRowView$.recordView("instance"),a._updateSummary(),(i=a._tbFind("selection_submenu"))&&(i.disabled=!0),l.singleRowView$.show().recordView(ce),n&&l.setSelectedRecords([n]),o?l.singleRowView$.recordView("setEditMode",!0):l.singleRowView$.recordView("focus"),!0}},{name:"row-add-row",label:Ci("ADD_ROW"),icon:"icon-ig-add-row",hide:!0,action:function(e,t){var i=a._currentViewImpl(),n=i.getContextRecord(t);return i.focus(),i.model.insertNewRecord(null,n[0]),!0}},{name:"row-duplicate",label:Ci("DUPLICATE_ROW"),icon:"icon-ig-duplicate",hide:!0,action:function(e,t){var i=a._currentViewImpl(),n=i.getContextRecord(t);return i.model.copyRecords(n,null,n[0]),!0}},{name:"row-delete",label:Ci("DELETE_ROW"),icon:"icon-ig-delete",hide:!0,action:function(e,t){var i=a._currentViewImpl(),n=i.getContextRecord(t);i.model.deleteRecords(n)}},{name:"row-refresh",label:Ci("REFRESH_ROW"),icon:"icon-ig-refresh",action:function(e,t){var i=a._currentViewImpl(),n=i.getContextRecord(t);i.model.fetchRecords(n)}},{name:"row-revert",label:Ci("REVERT_CHANGES"),icon:"icon-ig-revert",hide:!0,action:function(e,t){var i=a._currentViewImpl(),n=i.getContextRecord(t);i.focus(),i.model.revertRecords(n)}}])},_initToolbar:function(){var e,t=this.options.config.toolbarData,i=this;delete t.toolbarFind,delete t.toolbarRemove,delete t.toolbarInsertAfter,this.toolbar$=this._getElement("toolbar").toolbar({actionsContext:this.actions,data:t}),e=this._tbFindElement("actions_button_menu"),this._tbFindElement("column_filter_button").hide(),this._tbFindElement("search_field").hide(),this._tbFindElement("actions_button").hide(),this._currentReportSettings().defaultFilterColumn?this._setFilterColumn(this._currentReportSettings().defaultFilterColumn.columnId):this._setFilterColumn(null),e.on("menubeforeopen",(function(){var t;(t=e.menu("find","rows"))&&(t.hide=i.options.config.pagination.type!==qe)}))},_getId:function(e){return e?this.idPrefix+"_"+e:""},_getIdSelector:function(e){return"#"+this._getId(e)},_getElement:function(t){return e(this._getIdSelector(t))},_setEditMode:function(t){var i,n,o={},a=this._currentViewImpl(),l=!1,r=this,s=this.options.config.columns,d=e("#"+this._getId("content_container"));function c(){a.setEditMode(r.editMode),t&&setTimeout((function(){a.focus()}),100)}if(this.editMode=t,t){for(i=0;i<s.length;i++)s[i].validation&&s[i].validation.isRequired&&(o[s[i].id]=s[i]);if(Object.keys(o).length>0){for(n=this._getCurrentView().columns,i=0;i<n.length;i++)o[n[i].columnId]&&!n[i].isVisible&&(n[i].isVisible=!0,this._setOperationUpdate(n[i]),l=!0);l&&this._setReportSettings({changeIdentifier:"views.grid.columns"},c)}}l||(c(),d.attr(q,Ci(t?ci:ui)))},_configureView:function(e){this.viewsImpl[e].isConfigured()&&this._view(e,{fetchData:!0}),this.viewsImpl[e].openDialog()},_getColumn:function(e){return this.columnMap[e]},_getColumnByName:function(e){var t,n=this.options.config.columns;for(t=0;t<n.length;t++)if(n[t].name===e)return n[t];i.warn("No column exists with name: ",e)},_getColumnByStaticId:function(e){var t,n=this.options.config.columns;for(t=0;t<n.length;t++)if(n[t].staticId===e)return n[t];i.warn("No column exists with static ID: ",e)},_getTextTransformClass:function(e){var t,i=e.filter.textCase;return i&&(t={lower:"u-textLower",upper:"u-textUpper"}[i.toLowerCase()]),t},_convertNamesToLabels:function(e){var t,i=this.options.config.columns,n={};for(t=0;t<i.length;t++)n[i[t].name]=i[t].heading.label;return e&&""!==e?e.replace(/(")(.*?)(")/g,(function(e,t,i){return'"'+n[i]+'"'})):e},_convertLabelsToNames:function(e){var t,i=this.options.config.columns,n={};for(t=0;t<i.length;t++)n[i[t].heading.label]=i[t].name;return e&&""!==e?e.replace(/(")(.*?)(")/g,(function(e,t,i){return'"'+n[i]+'"'})):e},_getColumnLabel:function(e){var t,n=this._getColumn(e);return n.isHidden?i.info("_getColumnLabel called on hidden column, check calling logic",e):t=n.heading.label,t},_isColumnFilterable:function(e){var t=this._getColumn(e);return!t.specialType&&t.filter&&!t.isHidden},_hasColumnFilterLov:function(e){var t=this._getColumn(e);return t.filter&&t.filter.hasLov},_getColumnType:function(){return oe},_getCurrentView:function(){var e=this._view(),t=this.options,i=t.config.views,n=i[e].useModelFrom;return n&&i[n].shareModel&&(e=n),t.savedReports[this.currentSavedReportIdx].views[e]},_currentViewImpl:function(){return this.viewsImpl[this._view()]},_view:function(t,i){var n,o,a,l,r,s,d,c,u=this,h=this.options.config,g=this.actions,p=!1,m=!1,f=this._currentReportSettings(),_=!1,C=[],I=e.extend({initialData:null,fetchData:!1},i);if(!t)return f.currentView;if(r=this._currentViewImpl(),this.viewsImpl[t].isConfigured()){for(a in f.currentView=t,l=this._currentViewImpl(),s=h.views[t].features,d=l.supports,r&&r.view$&&r.hide(),l.view$?(l.show(),this._updateModelRegionData(l),l.pendingRefresh&&(l.pendingRefresh=!1,l.refresh()),this._setReportSettings({changeIdentifier:"view.change"})):(this._getElement(l.elementId).show(),l.view$=this._getElement(l.elementId),l.setColumnConfig({baseModelColumns:this.baseModelColumns,igConfig:h,ig:this,currentReportSettings:f}),I.viewImpl=l,this._setModel(I),I.viewImpl.supports.edit&&(this.editableViewImpl=I.viewImpl),l.initView({ig$:this.element,ig:this,igConfig:h,currentReportSettings:f}),this._setInitialSelection(0),_=!0),o=this._refreshReportSettings(),this._updateSummary(),C.push({labelKey:"APEX.IG.ALL_TEXT_COLUMNS",value:null}),l.modelColumns)if(mi(l.modelColumns,a)&&l.modelColumns[a].id&&this._isColumnFilterable(l.modelColumns[a].id)&&(p=!0,-1!==e.inArray(this._getColumn(l.modelColumns[a].id).filter.dataType,[Mt,Gt])))for(n=0;n<this._getColumn(l.modelColumns[a].id).filter.operators.length;n++)-1!==e.inArray(this._getColumn(l.modelColumns[a].id).filter.operators[n].name,["$perform$","C"])&&(m=!0,C.push({label:l.modelColumns[a].label,value:l.modelColumns[a].id}));h.filter.oracleText&&(m=!0),g.lookup("filter-column").choices=C,g.updateChoices("filter-column"),this._updateChangeViewActions(),this._toggleEnableAction(m,"search"),h.toolbar&&h.toolbar.searchField&&h.toolbar.columnSelection&&this._tbFindElement("column_filter_button").prop(fe,!m),_||o||l.resize(),this._toggleEnableAction(h.editable&&d.edit,["edit","save","selection-add-row","selection-add-row","row-add-row","selection-duplicate","row-duplicate","selection-delete","row-delete","selection-revert","row-revert"]),this._toggleEnableAction(h.editable&&d.edit&&d.singleRowView,["insert-record","delete-record","revert-record","duplicate-record"]),this._toggleEnableAction(d.controlBreak&&s.controlBreak,"show-control-break-dialog"),this._toggleEnableAction(d.aggregation&&s.aggregate,"show-aggregate-dialog"),this._toggleEnableAction(d.highlight&&s.highlight,"show-highlight-dialog"),this._toggleEnableAction(d.changeRowsPerPage&&s.changeRowsPerPage,"change-rows-per-page"),this._toggleEnableAction(d.singleRowView&&s.singleRowView,["single-row-view","refresh-record"]),this._toggleShowAction(l.canCopy2Clipboard(),"selection-copy"),this._toggleShowAction(d.cellSelection,"selection-mode"),(c=this._tbFind("selection_submenu"))&&(c.disabled=!d.selection),this._toggleEnableAction(d.configurableColumns,["show-columns-dialog","stretch-columns"]),this._toggleEnableAction(d.filter&&h.features.filter,"show-filter-dialog"),p||this._toggleEnableAction(!1,"show-filter-dialog"),this._toggleEnableAction(d.sort,"show-sort-dialog"),this._toggleEnableAction(d.download&&h.features.download,"show-download-dialog"),this._trigger(Vi,null,{view:t,created:_}),this._selectionChange(null),this._forEachView((function(e,i){i.viewChanged(e===t,u,h)}))}else this.viewsImpl[t].openDialog()},_destroyAllModels:function(){var e=this;this._forEachView((function(t,i){e._setModel({viewImpl:i,remove:!0}),i.view$&&(i.hide(),i.destroyView(e),i.view$=null)}))},_report:function(e){var t,i,n=this.options;if(!e)return this._currentReportSettings().id;for(this._destroyAllModels(),s.hidePageSuccess(),t=0;t<n.savedReports.length;t++)if(n.savedReports[t].id===e){this.currentSavedReportIdx=t;break}i=this._currentViewImpl(),this._forEachView((function(e,t){t.view$&&t.hide()})),i.view$||(i.view$=this._getElement(i.elementId)),this._updateSummary(),i.view$.show(),i.setColumnConfig({baseModelColumns:this.baseModelColumns,igConfig:n.config,currentReportSettings:this._currentReportSettings(),ig:this}),this.reportSettingsSeq+=1,this._setModel({viewImpl:i}),i.initView({ig$:this.element,ig:this,igConfig:n.config,currentReportSettings:this._currentReportSettings()}),this._updateActions(),this.editMode=!1,this.actions.update("edit"),this._updateChangeViewActions(),this._clearToolbarSearch(),this._trigger(Vi,null,{view:i.internalIdentifier,created:!0}),this._refreshReportSettings(),this._updateModelRegionData(i),this.refresh(),this._trigger("reportChange",null,{report:this._report()})},_currentReportSettings:function(){return this.options.savedReports[this.currentSavedReportIdx]},_updateModelRegionData:function(e){var t=e.internalIdentifier,i=this.options.config.views,n=i[t].useModelFrom,o=e.model.getOption("regionData");o.reportId=this._report(),n&&i[n].shareModel&&(t=n),o.view=t},_updateSummary:function(){var e=this.getCurrentView(),t=e.title,i=this._currentReportSettings(),n=i.name;n||i.type!==Ae||(n=Ci("PRIMARY_REPORT")),e.supports.singleRowView&&e.singleRowMode&&(t+=" ("+_i("SINGLE_ROW_VIEW")+")"),this._getElement("summary").text(o.formatMessage("APEX.IG.SUMMARY",n,t))},_shortenString:function(e,t){var i=t||20;return e.length>i?e.substr(0,i)+"...":e},_adjustControlBreakSort:function(){var t,i,n=[],o=this,a=o._getCurrentView().columns;for(t=0;t<a.length;t++)!a[t].sort||null===a[t].sort.order||a[t].break&&a[t].break.isEnabled||n.push({columnId:a[t].columnId,order:a[t].sort.order});for(n.sort((function(e,t){return e.order-t.order})),t=0;t<n.length;t++)for(i=0;i<a.length;i++)n[t].columnId===a[i].columnId&&e.extend(o._currentViewImpl().modelColumns[o._getColumn(a[i].columnId).name],{sortIndex:t+1})},_getSettingLabel:function(t,i){var n,a,l="APEX.IG.",r=[gt,pt,_t,Ct,mt,ft,"LIKE","NLIKE",bt,Et,Vt,Dt,kt,"OTEXT"],s=[It,vt],d=[St,Tt],c=[Nt,yt,Lt,Ot];function u(e,t){return e&&null!==e.match(/^\d{14}/)?p.format(p.parse(e,hi),t):""}switch(t){case ye:switch(i.type){case oe:l+="X.",i.columnId=i.columnId?i.columnId:this._getCurrentView().columns[0].columnId,e.inArray(i.operator,r)>-1&&(l+=gi[i.operator]+".Y",n=e.inArray(this._getColumn(i.columnId).filter.dataType,[Ht,Ft,Pt,Ut])>-1?o.formatMessage(l,this._getColumnLabel(i.columnId),u(i.hiddenValue?i.hiddenValue:i.value,this._getColumn(i.columnId).appearance.dateFormatMask)):o.formatMessage(l,this._getColumnLabel(i.columnId),i.value)),e.inArray(i.operator,[wt,At])>-1&&(l+=gi[i.operator]+".Y",n=o.formatMessage(l,this._getColumnLabel(i.columnId),i.value.split("").join("; "))),e.inArray(i.operator,s)>-1&&(l+=gi[i.operator],n=o.formatMessage(l,this._getColumnLabel(i.columnId))),e.inArray(i.operator,d)>-1&&(l+=gi[i.operator]+".Y.AND.Z",a=i.hiddenBetween||i.hiddenAnd?[i.hiddenBetween,i.hiddenAnd]:i.value.split(Ye),n=e.inArray(this._getColumn(i.columnId).filter.dataType,[Ht,Ft,Pt,Ut])>-1?o.formatMessage(l,this._getColumnLabel(i.columnId),u(a[0],this._getColumn(i.columnId).appearance.dateFormatMask),u(a[1],this._getColumn(i.columnId).appearance.dateFormatMask)):o.formatMessage(l,this._getColumnLabel(i.columnId),a[0],a[1])),e.inArray(i.operator,c)>-1&&(2!==(a=i.value.split(Ye)).length&&(a=["","MI"]),"1"===a[0]?(l+=gi[i.operator]+"_"+bi[a[1]],n=o.formatMessage(l,this._getColumnLabel(i.columnId))):(l+=gi[i.operator]+".Y."+bi[a[1]]+"S",n=o.formatMessage(l,this._getColumnLabel(i.columnId),a[0])));break;case ae:n=i.name;break;case ne:l+="SEARCH_FOR.X",n=o.formatMessage(l,i.search||i.value)}break;case ke:n=this._getColumnLabel(i.columnId);break;case De:n=Ci(i.function)+" ("+this._getColumnLabel(i.columnId)+")";break;case Le:n=this._shortenString(i.name?i.name:this._getColumnLabel(i.condition.columnId));break;case Oe:1===i.minsAgo?n=_i(l+="REPORT_DATA_AS_OF_ONE_MINUTE_AGO"):(l+="REPORT_DATA_AS_OF.X.MINUTES_AGO",n=o.formatMessage(l,i.minsAgo))}return n},_getSettingSummaryLabel:function(e,t){var i,n="APEX.IG.";switch(e){case ye:switch(t.type){case oe:i=this._getColumnLabel(t.columnId);break;case ae:i=this._shortenString(t.name);break;case ne:i="'"+this._shortenString(t.value,18)+"'"}break;case ke:i=this._getColumnLabel(t.columnId);break;case Le:i=this._shortenString(t.name?t.name:this._getColumnLabel(t.condition.columnId));break;case Oe:1===t.minsAgo?i=_i(n+="ONE_MINUTE_AGO"):(n+="X.MINUTES_AGO",i=o.formatMessage(n,t.minsAgo));break;case De:i=this._shortenString(this._getColumnLabel(t.columnId))}return i},_getTotalReportSettings:function(){var e,t=0,i=this._getCurrentView(),n=this._currentReportSettings();switch(n.filters&&(t+=n.filters.length),n.flashback&&(t+=1),this._view()){case Ie:for(e=0;e<i.columns.length;e++)i.columns[e].break&&(t+=1);i.highlights&&(t+=i.highlights.length),i.aggregations&&(t+=i.aggregations.length);break;case be:i&&(t+=1)}return t},_renderReportSettings:function(t){var i,n=[],a=this,l=this._getCurrentView(),r=this._currentReportSettings(),s=this._getTotalReportSettings()>0;t.markup("<div").attr(tt,"a-MediaBlock a-IG-controlsContainer").attr(it,We).attr(q,Ci("REPORT_SETTINGS")).attr("id",this._getId("report_settings")),s||t.attr("style","display:none;"),t.markup(">"),t.markup("<div").attr(tt,"a-MediaBlock-graphic").attr(it,"heading").attr(K,"3").markup(">"),t.markup("<h3").attr(B,"true").attr(tt,F).markup(">").content(Ci("REPORT_SETTINGS")).markup("</h3>"),ji(t,{buttonClass:"a-Button a-IG-button a-IG-button--controls"}),t.markup("</div>"),function(t){function s(t,i){var n={},l=e.extend({type:"",id:"",active:!1,label:"",excludeToggle:!1,isInvalid:!1,linkStyle:""},i),r="a-IG-controls-item a-IG-controls-item--"+l.type;n.setting=l.type,n["setting-id"]=l.id,l.isInvalid&&(r+=" is-error"),t.markup("<li").attr(tt,r).attr(it,We).attr(X,"control_text"+l.id).markup(">"),t.markup("<span").attr(tt,w).markup(">"),l.excludeToggle||(Zi(t,{id:a._getId("control_"+l.id),cssClasses:A,checked:l.active,ariaLabel:vi[l.type],ariaDescribedBy:"control_text"+l.id,data:n,disabled:l.isInvalid,invalid:l.isInvalid}),Ji(t,{labelFor:a._getId("control_"+l.id),cssClasses:"a-IG-controlsCheckboxLabel",ariaHidden:!0})),t.markup("</span>"),t.markup("<span").attr(tt,w).markup(">").markup("<span").attr(B,"true").attr(tt,"a-Icon a-IG-controlsIcon icon-ig-"+Xi(l.type)).markup("></span>").markup("</span>"),t.markup("<span").attr(tt,"a-IG-controls-cell a-IG-controls-cell--label").markup(">"),l.isInvalid?t.markup("<span").attr("id","control_text"+l.id).attr(tt,R).markup(">").markup(l.label).markup("</span>"):(t.markup("<button type='button'").attr(tt,R).attr(q,o.formatMessage("APEX.IG.EDIT_CONTROL",vi[l.type])).optionalAttr(W,l.excludeToggle?null:a._getId("control_"+l.id)).attr($,"control_text"+l.id).attr("data-setting",l.type).attr("data-setting-id",l.id).optionalAttr("style",l.linkStyle).markup(">"),t.markup("<span").attr("id","control_text"+l.id).markup(">").markup(l.label).markup("</span>"),t.markup("</button>")),t.markup("</span>"),t.markup("<span").attr(tt,"a-IG-controls-cell a-IG-controls-cell--remove").markup(">"),ji(t,{buttonClass:"a-Button a-Button--noUI a-IG-button a-IG-button--remove",iconOnly:!0,icon:"icon-remove",label:o.formatMessage("APEX.IG.REMOVE_CONTROL",vi[l.type]),data:n,ariaControls:l.excludeToggle?null:a._getId("control_"+l.id),ariaDescribedBy:"control_text"+l.id}),t.markup("</span>"),t.markup("</li>")}if(t.markup("<div").attr(tt,k).markup(">"),t.markup("<ul").attr(tt,E).markup(">"),r.views.chart&&a._view()===be&&s(t,{type:be,excludeToggle:!0,label:Ci("EDIT_CHART")}),r.filters)for(i=0;i<r.filters.length;i++)r.filters[i].operation!==$e&&s(t,{type:ye,id:r.filters[i].id,active:r.filters[i].isEnabled,label:a._getSettingLabel(ye,r.filters[i]),isInvalid:r.filters[i].isInvalid});if(a._currentViewImpl().supports.controlBreak&&l){for(i=0;i<l.columns.length;i++)l.columns[i].break&&l.columns[i].break.operation!==$e&&n.push(l.columns[i]);if(n.length>0)for(n.sort((function(e,t){var i=e.break.order,n=t.break.order;return i<n?-1:i>n?1:0})),i=0;i<n.length;i++)s(t,{type:ke,id:n[i].columnId,active:n[i].break.isEnabled,label:a._getSettingLabel(ke,n[i])})}if(a._currentViewImpl().supports.highlight&&l.highlights)for(i=0;i<l.highlights.length;i++)l.highlights[i].operation!==$e&&s(t,{type:Le,id:l.highlights[i].id,active:l.highlights[i].isEnabled,label:a._getSettingLabel(Le,l.highlights[i]),isInvalid:l.highlights[i].isInvalid,linkStyle:"background:"+l.highlights[i].backgroundColor+";color:"+l.highlights[i].textColor});if(a._currentViewImpl().supports.aggregation&&l.aggregations)for(i=0;i<l.aggregations.length;i++)l.aggregations[i].operation!==$e&&s(t,{type:De,id:l.aggregations[i].id,active:l.aggregations[i].isEnabled,label:a._getSettingLabel(De,l.aggregations[i])});r.flashback&&r.flashback.operation!==$e&&s(t,{type:Oe,id:Oe,active:r.flashback.isEnabled,label:a._getSettingLabel(Oe,r.flashback)}),t.markup("</ul></div>")}(t),function(t){var i=0,o=0;function d(e,t,n){var l,r,s,d="",u=[],h=!0;for(l=0;l<n.length;l++)n[l].operation!==$e&&(t===ke?r=n[l].break.isEnabled:(r=n[l].isEnabled,s=n[l].isInvalid),s?o+=1:r?(u.push(l),h||(d+=", "),d+=a._getSettingSummaryLabel(t,n[l]),h=!1):i+=1);u.length>0&&c(e,{type:t,id:n[u[0]],count:u.length,label:d})}function c(t,i){var n=e.extend({type:"",id:"",count:0,label:""},i);t.markup("<li").attr(tt,"a-IG-reportSummary-item a-IG-reportSummary-item--"+n.type).markup(">"),t.markup("<a href='#'").attr(tt,"a-IG-reportSummary-label").attr("data-setting",n.type).optionalAttr("data-setting-id",n.id).markup(">"),t.markup("<span").attr(tt,"a-IG-reportSummary-icon").attr(it,"img").attr(q,vi[n.type]).markup(">"),t.markup("<span").attr(tt,"a-Icon icon-ig-"+Xi(n.type)).markup("></span>"),(n.count>1||n.type===Ee||n.type===we)&&t.markup("<span").attr(tt,"a-IG-reportSummary-count").markup(">").content(n.count).markup("</span>"),t.markup("</span>"),t.markup("<span").attr(tt,"a-IG-reportSummary-value").markup(">").content(n.label).markup("</span>"),t.markup("</a>")}t.markup("<div").attr(tt,"a-IG-reportSummaryContainer"),r.reportSettingsArea===ge&&t.attr("style","display:none;"),t.attr("id",a._getId("report_settings_summary")),s||t.attr("style","display:none;"),t.markup(">"),t.markup("<ul").attr(tt,S).markup(">"),r.views.chart&&a._view()===be&&c(t,{type:be,label:Ci("EDIT_CHART")}),r.filters&&d(t,ye,r.filters),n.length>0&&d(t,ke,n),l.highlights&&d(t,Le,l.highlights),l.aggregations&&d(t,De,l.aggregations),r.flashback&&(r.flashback.isEnabled?c(t,{type:Oe,label:a._getSettingSummaryLabel(Oe,r.flashback)}):i+=1),i>0&&c(t,{type:Ee,count:i,label:Ci(1===i?"INACTIVE_SETTING":"INACTIVE_SETTINGS")}),o>0&&c(t,{type:we,count:o,label:Ci(1===i?"INVALID_SETTING":"INVALID_SETTINGS")}),t.markup("</ul></div>")}(t),t.markup("</div>")},_initReportSettings:function(){var t=this,i=this.options.config.maxHeight,n=this._getElement("report_settings"),o=t._currentReportSettings();function a(e,i,a){if(o.reportSettingsArea===e){var l=n.data("apex-collapsible").controllingElement$.is(":focus");o.reportSettingsArea=i,t._setOperationUpdate(o),t._setReportSettings({},(function(){l&&t._getElement("report_settings").data("apex-collapsible").controllingElement$.trigger("focus")})),t._getElement("report_settings_summary")[a](),t.resize()}}this._getTotalReportSettings()>0&&(this._on(n,{"click button.a-IG-controlsLabel":function(t){var i=e(t.currentTarget);this._openDialog(i.data("setting"),{id:i.data("setting-id")+""}),t.preventDefault()},"click a.a-IG-reportSummary-label":function(t){var i=e(t.currentTarget),o=i.data("setting");o===Ee||o===we?n.collapsible("expand"):this._openDialog(o,{id:i.data("setting-id")+""}),t.preventDefault()},"click input.a-IG-controlsCheckbox":function(t){var i=e(t.target),n=i.prop(_e),o=i.data("setting"),a=i.data("setting-id")+"";switch(o){case ye:this.updateFilter(a,{isEnabled:n});break;case De:this.updateAggregate(a,{isEnabled:n});break;case Le:this.updateHighlight(a,{isEnabled:n});break;case ke:this.updateControlBreak(a,{isEnabled:n});break;case Oe:this.updateFlashback({isEnabled:n})}},"click button.a-IG-button--remove":function(t){var i=e(t.currentTarget),n=i.data("setting"),o=i.data("setting-id")+"";switch(t.preventDefault(),n){case ye:this.deleteFilter(o);break;case De:this.deleteAggregate(o);break;case Le:this.deleteHighlight(o);break;case ke:this.deleteControlBreak(o);break;case Oe:this.deleteFlashback();break;case be:this.deleteChart()}}}),n.collapsible({content:"div.a-MediaBlock-content",collapsed:o.reportSettingsArea===pe,collapse:function(){a(ge,pe,ue)},expand:function(){a(pe,ge,he)}}),i&&n.find(".a-Collapsible-content").css({"max-height":(i-(e(_,this.element).outerHeight()||0))/3+"px",overflow:"auto"}))},_isSettingsCheckboxFocused:function(t,i){var n;return!(!document.activeElement||"checkbox"!==document.activeElement.type)&&((n=e(document.activeElement).data()).setting===i&&""+n.settingId===t)},_focusOnSettingsCheckbox:function(e,t,i){var n;e&&(n=".a-IG-controlsCheckbox[data-setting="+i+"]",t&&(n+="[data-setting-id="+t+"]"),this._getElement("report_settings").find(n).trigger("focus"))},_currentViewColumn:function(t,i){var n,o,a=this._getCurrentView().columns;for(n=0;n<a.length;n++)if(a[n].columnId===t){o=a[n];break}return e.isPlainObject(i)&&(o=e.extend(!0,o,i),this._setOperationUpdate(o)),o},_refreshReportSettings:function(){var e,i=this._getElement("report_settings"),n=t.htmlBuilder();return!(!i[0]||(e=i[0].clientHeight,this._renderReportSettings(n),i.replaceWith(n.toString()),this._initReportSettings(),e===this._getElement("report_settings")[0].clientHeight))&&(this.resize(),!0)},_defaultAjaxRegionData:function(t){var i=this.options.config,n=e.extend(!0,{id:i.regionId,ajaxIdentifier:i.ajaxIdentifier,ajaxColumns:i.ajaxColumns,reportId:this._report(),view:this._view()},t);return this._isCurrentlyEditable()&&(n.allowedOperations=i.editable.allowedOperations.protected),n},_call:function(e,t){var i=this.options.config,o={regions:[this._defaultAjaxRegionData(e)]};return i.parentRegionStaticId&&this.parentItemValues.length>0&&(o.regions[0].parentItems={values:this.parentItemValues}),i.loadingIndicator&&(t.loadingIndicator=i.loadingIndicator),(i.callServer||n.plugin)(o,t)},_setReportSettings:function(t,i){function n(e){for(let t=0;t<e.length;t++)e[t].operation&&!e[t]._isBeingProcessed||(e.splice(t,1),t-=1)}var o,a,l={},r=this.options.config,d=this,c=e.extend({refreshView:!1,refreshModel:!1,affectsOtherViewsModels:!1,refreshColumns:!1,changeIdentifier:""},t);return c.refreshModel=c.refreshModel||!this._currentReportSettings().baseReportId&&this._getCurrentView().highlights.length>0,(o=e.extend(!0,{},this._currentReportSettings())).filters&&o.filters.length>0&&(n(o.filters),function(e){for(let t=0;t<e.length;t++)e[t].operation&&[Xe,$e].includes(e[t].operation)&&(e[t]._isBeingProcessed=!0)}(this._currentReportSettings().filters)),r.views.grid&&n(o.views.grid.columns),r.views.icon&&n(o.views.icon.columns),r.views.detail&&n(o.views.detail.columns),r.features.saveReport&&r.features.saveReport.publicReportCs&&(l.publicReportCs=r.features.saveReport.publicReportCs),a={success:function(e){var t,n=d._defaultSavedReport(e.regions[0].setReportSettings[0]);s.hidePageSuccess(),d._view()!==n.currentView&&d._view(n.currentView,{fetchData:!0}),d.options.savedReports[d.currentSavedReportIdx]=n,d._updateChangeReportAction(),d._updateChangeViewActions(),d._updateReportSettingsActions(),d._refreshReportSettings(),t=d._currentViewImpl(),d._updateModelRegionData(t),n=d._currentReportSettings(),d._forEachView((function(e,t){t.setReportOptions(d,e===n.currentView,n,c.changeIdentifier),t.supports.highlight&&"views.grid.highlights"!==c.changeIdentifier&&t.setReportOptions(d,e===n.currentView,n,"views.grid.highlights")})),c.refreshColumns&&t.refreshColumns(),c.refreshView?t.refresh():c.refreshModel&&(d.reportSettingsSeq+=1,c.affectsOtherViewsModels?d._forEachView((function(e,t){t.model&&t.clearModelData()})):t.clearModelData()),i&&i(),d._trigger("reportSettingsChange",null,{report:n.id})},queue:{name:"set.report.settings.wait",action:"wait"}},e.extend(l,{setReportSettings:[o]}),this._call(l,a)},_downloadReport:function(t){var o,a,r=this.options.config,d=this;o={pageItems:r.itemsToSubmit,regions:[{id:r.regionId,ajaxIdentifier:r.ajaxIdentifier,ajaxColumns:r.ajaxColumns,reportId:this._report(),view:this._view(),download:e.extend({downloadCs:r.features.download.downloadCs},t)}],salt:$v("pSalt")},(a=l(r.regionStaticId).getParentItems())&&(o.regions[0].parentItems=a),t.email?n.plugin(o,{dataType:Z,loadingIndicator:d.element,loadingIndicatorPosition:"centered",success:function(){s.showPageSuccess(Ci("EMAIL_SENT"))}}):n.plugin(o,{loadingIndicator:d.element,loadingIndicatorPosition:"centered",success:function(e){var t;s.showPageSuccess(Ci("FILE_PREPARED")),t=n.ajaxUrl({regions:[{id:r.regionId,reportId:d._report(),ajaxIdentifier:r.ajaxIdentifier,downloadFileId:e.regions[0].download.id}],salt:$v("pSalt")}),i.info("Calling URL to get file:",t),i.info("URL length:",t.length),g.download(t)}})},_saveReport:function(e,t){var n,o={},a=this,l=this.options.config;if(l.features.saveReport)return o.saveReport=e,l.features.saveReport.publicReportCs&&(o.publicReportCs=l.features.saveReport.publicReportCs),this._call(o,{success:function(e){switch(a.options.savedReports=a._defaultSavedReports({reports:e.regions[0].savedReports}),a._updateChangeReportAction(),a._updateReportSettingsActions(),a._refreshReportSettings(),a._updateModelRegionData(a._currentViewImpl()),t){case Xe:case"u":switch(a._currentReportSettings().type){case Ae:n=Ci("REPORT.SAVED.DEFAULT");break;case Re:n=Ci("REPORT.SAVED.ALTERNATIVE");break;case Se:n=Ci("REPORT.SAVED.PRIVATE");break;case Te:n=Ci("REPORT.SAVED.PUBLIC")}break;case $e:n=Ci("REPORT.DELETED")}s.showPageSuccess(n),t===$e&&a.refresh()}});i.warn("Unable to save report settings because the configuration disallows it.")},_getFilterValues:function(e,t,i){var n=this;return this._call({getFilterValues:{columnId:e,columnType:oe,respectFilters:t}},{success:function(e){"function"==typeof i&&i.call(n,e)}})},_updateChangeReportAction:function(){var e,t,i,n,o=[],a=this.options.config,l=this.options.savedReports,r=this.actions;if(l.length>1){for(e=0;e<l.length;e++){switch(n=(t=l[e]).name,t.type){case Ae:i="APEX.IG.SAVED_REPORT_DEFAULT",t.name||(n=Ci("PRIMARY_REPORT"));break;case Re:i="APEX.IG.SAVED_REPORT_DEFAULT";break;case Se:i="APEX.IG.SAVED_REPORT_PRIVATE";break;case Te:i="APEX.IG.SAVED_REPORT_PUBLIC"}o.push({group:_i(i),label:n,value:t.id})}this.actions.lookup("change-report").hide=!(!a.toolbar||a.toolbar&&a.toolbar.savedReports)}else this.actions.lookup("change-report").hide=!0;this.actions.update("change-report"),r.lookup("change-report").choices=o,r.updateChoices("change-report")},_updateAction:function(e,t){this.actions.lookup(t)&&this.actions[e](t)},_toggleEnableAction:function(e,t){this._toggleAction("enable",e,t)},_toggleShowAction:function(e,t){this._toggleAction(ue,e,t)},_toggleAction:function(e,t,i){let n;switch(e){case ue:n=t?ue:he;break;case"enable":n=t?"enable":"disable"}fi(i)?i.forEach((e=>{this._updateAction(n,e)})):this._updateAction(n,i)},_updateToolbarElements:function(){var e=this.options.config.toolbar;e&&(e.searchField&&(e.columnSelection&&this._tbFindElement("column_filter_button").show(),this._tbFindElement("search_field").show()),e.actionMenu&&this._tbFindElement("actions_button").show())},_updateActions:function(){var e=this,t=this.options.config,i=t.features,n=!1,o=!1,a=!1,l=this._isCurrentlyEditable(),r=t.editable.allowedOperations,s=l&&r.create,d=l&&r.delete,c=l&&(r.update||r.delete),u=t.toolbar,h=l&&(r.update||r.create)&&(!u||u&&u.editing),g=l&&(r.create||r.update||r.delete)&&(!u||u&&u.save),p=!u||u&&u.searchField,m=!u||u&&u.reset,f=t.pagination.type===qe;i.saveReport&&this._updateChangeReportAction(),this._toggleShowAction(i.filter,"show-filter-dialog"),this._toggleShowAction(i.download,"show-download-dialog"),this._toggleShowAction(i.flashback,"show-flashback-dialog"),this._updateReportSettingsActions(),this._toggleShowAction(s,["selection-add-row","row-add-row","selection-duplicate","row-duplicate"]),this._toggleShowAction(d,["selection-delete","row-delete"]),this._toggleShowAction(c,["selection-revert","row-revert"]),this._toggleShowAction(h,"edit"),this._toggleShowAction(g,"save"),this._toggleShowAction(p,"search"),this._toggleShowAction(m,"reset-report"),this._forEachView((function(i,r){var c=t.views[i].features;r.supports.singleRowView&&c.singleRowView&&(n=!0),r.supports.highlight&&c.highlight&&(o=!0),r.supports.configurableColumns&&null===c.stretchColumns&&!1!==c.gridView&&(a=!0),r.updateActions({ig:e,editable:l,canDelete:d,canCreate:s,canEdit:h})})),this._toggleShowAction(n,["single-row-view","refresh-record"]),this._toggleShowAction(s&&n,["insert-record","duplicate-record"]),this._toggleShowAction(d&&n,["delete-record"]),this._toggleShowAction(c&&n,["revert-record"]),this._toggleShowAction(o,"show-highlight-dialog"),this._toggleShowAction(f,"change-rows-per-page"),this._toggleShowAction(a,"stretch-columns")},_updateReportSettingsActions:function(){var e=this._currentReportSettings(),t=this.options.config.features.saveReport,i=!e.isReadOnly;this._toggleEnableAction(t&&i&&e.baseReportId,"save-report"),this._toggleEnableAction(t,"show-save-report-as-dialog"),this._toggleEnableAction(t&&i,"show-edit-report-dialog"),this._toggleEnableAction(t&&i&&e.type!==Ae,"delete-report"),this._toggleEnableAction(e.baseReportId,"reset-report")},_updateChangeViewActions:function(){var e=[],t=this.actions;this._forEachView((function(t,i){i.isConfigured()&&e.push({label:i.title,value:t,icon:i.icon})})),this._toggleShowAction(e.length>1,"change-view"),t.lookup("change-view").choices=e,t.updateChoices("change-view")},_updateSelectionActions:function(){var e,t,i,n,o=this.options.config,a=this._currentViewImpl(),l=o.editable&&a.supports.edit;a.singleRowMode||(a.selectCells&&a.selectCells()?(n=a.view$.grid("getSelectedRange").recordIds.length,this._toggleEnableAction(!1,["selection-refresh"]),this._toggleEnableAction(0!==n,["selection-copy"]),l&&(this._toggleEnableAction(this._isCurrentlyEditable()&&0!==n,["selection-fill","selection-clear","selection-revert"]),this._toggleEnableAction(!1,["selection-duplicate","selection-delete","selection-revert","row-delete"]),this._toggleEnableAction(n>=2,["selection-copy-down"]))):(n=(e=a.getSelectedRecords())?e.length:0,this._toggleEnableAction(0!==n,["selection-refresh","selection-copy"]),l&&(this._toggleEnableAction(this._isCurrentlyEditable()&&0!==n,["selection-duplicate","selection-delete","selection-revert","selection-fill","selection-clear"]),o.editable.allowedOperations.delete&&(t=e.some((function(e){return a.model.allowDelete(e)})),this._toggleEnableAction(t,["row-delete","selection-delete","selection-fill","selection-clear"])),i=e.some((function(e){return a.model.canRevertRecord(e)})),this._toggleEnableAction(i,["row-revert","selection-revert"]),this._toggleEnableAction(n>=2,["selection-copy-down"]))))},_setFilterColumn:function(e){var t;this.currentFilterColumnId=e,t=e?o.formatMessage("APEX.IG.SEARCH.COLUMN",this._getColumn(e).heading.label):this.options.config.filter.oracleText?Ci("SEARCH.ORACLE_TEXT"):Ci("SEARCH.ALL_COLUMNS"),this._tbFindElement("search_field").attr({placeholder:t,title:t})},_defaultIGConfig:function(){var t,i,n=this.options.config;if(n.filter.maxRowCount&&(n.text.moreDataFound=o.formatMessage("APEX.IG.MORE_DATA_FOUND",n.filter.maxRowCount)),n.columnGroups.length>0)for(t=0;t<n.columnGroups.length;t++)(i=n.columnGroups[t]).label||(i.label=i.heading);n.editable&&(n.editable=e.extend(!0,{allowedOperations:{create:!0,update:!0,delete:!0,protected:""},autoAddRow:!0},n.editable),n.editable.allowedOperations.create||(n.editable.autoAddRow=!1)),n.features.download&&(n.features.download=e.extend({formats:[],email:!0},n.features.download)),n.views.icon&&(n.views.icon=e.extend(!0,{disabled:!1,labelColumn:"",features:{sort:!0,highlight:!0,rowSelector:{multiSelect:!0,selectAll:!1,hideControl:!1}}},n.views.icon)),n.views.detail&&(n.views.detail=e.extend(!0,{disabled:!1,beforeRows:"",row:"",afterRows:"",features:{sort:!0,controlBreak:!0}},n.views.detail))},_defaultColumns:function(){var t,i,n=this.options.config.columns;for(t=0;t<n.length;t++)(i=e.extend(!0,{id:"",name:"",staticId:"",dataType:Mt,specialType:"",isHidden:!1,isReadOnly:!0,heading:{heading:"",label:"",alignment:re},layout:{columnAlignment:le,groupId:"",useGroupFor:"both"},appearance:{columnCssClasses:"",formatExample:""},validation:{isRequired:!1,restrictedCharacters:""},link:{text:"",attributes:""},filter:{operators:[{name:"$std$"},{name:"$perform$"}],dateRanges:ct,isRequired:!1,hasLov:!0,dataType:Mt},accessibility:{usedAsRowHeader:!1},features:{canHide:!0,highlight:!0,compute:!0,sort:!0,controlBreak:!0,aggregate:!0,groupBy:!0},isPrimaryKey:!1,parentColumnName:"",default:{value:"",duplicate:!0},escape:!0,helpid:""},n[t])).heading.label||(i.heading.label=i.heading.heading),i.filter.dataType!==Mt||i.filter.textCase||(i.filter.textCase="MIXED"),n[t]=i},_createBaseColumnMap:function(){var e,t,i,n=this.options.config.columns,o=0;for(e=0;e<n.length;e++)t=n[e],i=this.baseModelColumns[t.id]={index:e-o,hidden:t.isHidden,readonly:t.isReadOnly,escape:t.escape,id:t.id,dataType:t.dataType},t.isHidden?i.canHide=!1:(i.heading=t.heading.heading,i.headingAlignment=t.heading.alignment,i.label=t.heading.label,i.alignment=t.layout.columnAlignment,t.appearance.formatMask&&(i.formatMask=t.appearance.formatMask)),t.parentColumnName&&(i.parentField=t.parentColumnName,this.parentColumnNames.push(t.parentColumnName)),this.columnMap[t.id]=t,t.isPrimaryKey&&this.primaryKeyColumns.push(t.name),"actions"===t.specialType&&(o+=1);this.baseModelColumns._meta={index:e-o,seq:e,hidden:!0,canHide:!1}},_defaultSavedReport:function(t){var n,o,a,l,r,s,d,c=this,u=this.options.config,h=u.views;function g(t,i){var n,o,a,l={};if(i){for(n=0;n<t.length;n++)l[t[n].columnId]=1;for(n=0;n<u.columns.length;n++)l[(o=u.columns[n]).id]||t.push({columnId:o.id,operation:Xe,isVisible:!1})}for(n=0;n<t.length;n++)(a=e.extend({seq:null,columnType:oe,columnId:"",isVisible:!0,isFrozen:!1,width:null,priority:null,break:!1,sort:!1},t[n])).seq!==n+1&&(a.seq=n+1,c._setOperationUpdate(a)),a.break&&(a.break=e.extend({order:null,isEnabled:!0,direction:Ge,nulls:Pe},a.break)),a.sort&&(a.sort=e.extend({order:null,direction:Ge,nulls:Pe},a.sort)),c._getColumn(a.columnId)?t[n]=a:(t.splice(n,1),n-=1)}if(!h[(o=e.extend(!0,{id:"",baseReportId:"",name:"",isCurrent:!1,type:Ae,isReadOnly:!0,authorizationId:"",rowsPerPage:null,showRowNumbers:!1,reportSettingsArea:pe,defaultFilterColumn:!1,flashback:!1,versionNumber:"",filters:[],currentView:Ie,views:{grid:!1,chart:!1,icon:!1,detail:!1}},t)).currentView]||h[o.currentView].disabled){for(n in o.currentView=null,h)if(mi(h,n)&&h[n]&&!h[n].disabled){o.currentView=n;break}this.options.data=null,u.lazyLoading=!0,i.warn("Current view not available. Using view %s. Forcing lazy load.",o.currentView)}for(o.flashback&&(o.flashback=e.extend({minsAgo:null,isEnabled:!0},o.flashback)),n=0;n<o.filters.length;n++)(a=e.extend(!0,{id:"",type:ne,isCaseSensitive:!1,value:"",isEnabled:!0},o.filters[n])).columnId&&!a.columnType&&(a.columnType=oe),a.type!==oe||this._getColumn(a.columnId)?o.filters[n]=a:(o.filters.splice(n,1),n-=1);if(o.views.grid||h.grid){for(o.views.grid=e.extend(!0,{editMode:!1,singleRowView:{excludeNullValues:!1,onlyDisplayColumns:!0},columns:[],aggregations:[],highlights:[],initialBreakState:pe,stretchColumns:!0},o.views.grid),g(o.views.grid.columns,!0),n=0;n<o.views.grid.aggregations.length;n++)(l=e.extend({id:"",function:"",columnType:oe,columnId:"",tooltip:"",showGrandTotal:!0,isEnabled:!0},o.views.grid.aggregations[n])).label||(l.label=l.function),this._getColumn(l.columnId)?o.views.grid.aggregations[n]=l:(o.views.grid.aggregations.splice(n,1),n-=1);for(n=0;n<o.views.grid.highlights.length;n++)(r=e.extend(!0,{id:"",name:"",type:ne,columnType:oe,columnId:"",backgroundColor:"",textColor:"",condition:{type:oe,columnType:oe,columnId:"",operator:"",isCaseSensitive:!1,value:"",expression:""},isEnabled:!0},o.views.grid.highlights[n])).type===oe&&!this._getColumn(r.columnId)||r.condition.type===oe&&!this._getColumn(r.condition.columnId)?(o.views.grid.highlights.splice(n,1),n-=1):o.views.grid.highlights[n]=r}if((o.views.icon||h.icon)&&(o.views.icon=e.extend(!0,{columns:[],initialBreakState:pe},o.views.icon),g(o.views.icon.columns)),(o.views.detail||h.detail)&&(o.views.detail=e.extend(!0,{columns:[],initialBreakState:pe},o.views.detail),g(o.views.detail.columns)),o.views.chart)for(s in o.views.chart=e.extend(!0,{type:qt,orientation:ti,stack:ni},o.views.chart),o.views.chart.axis&&(o.views.chart.axis=e.extend({label:"",value:"",valueDecimalPlaces:""},o.views.chart.axis)),o.views.chart.chartColumns)mi(o.views.chart.chartColumns,s)&&(d=o.views.chart.chartColumns[s],(d=e.extend({columnType:oe},d)).sort&&(d.sort=e.extend({order:null,direction:Ge,nulls:Pe},d.sort)),o.views.chart.chartColumns[s]=d);return o},_defaultSavedReports:function(t){var i,n=!1,o=e.extend({reports:this.options.savedReports},t);for(i=0;i<o.reports.length;i++)o.reports[i]=this._defaultSavedReport(o.reports[i]),o.reports[i].isCurrent&&(n=!0,this.currentSavedReportIdx=i);return n||(this.currentSavedReportIdx=0),o.reports},_renderColumnHeaderMenu:function(t,i,n,a){function l(t,i){var n=e.extend(!0,{buttonClass:"a-IRR-button a-IRR-sortWidget-button",label:"",iconOnly:!0,icon:"",isToggle:!1,toggleState:null,attributes:{},data:{}},i);t.markup("<li").attr(tt,"a-IRR-sortWidget-actions-item").markup(">"),n.isToggle&&(n.attributes["aria-pressed"]=n.toggleState,n.toggleState&&(n.buttonClass+=" is-active"),delete n.isToggle,delete n.toggleState),ji(t,n),t.markup("</li>")}var r,s,d,c=!1,u=this._getId("column_header_search"),h=this._getColumn(a),g=this._currentReportSettings().views.grid.columns,p=0;for(t.markup("<h1").attr(tt,F).attr("aria-roledescription",o.getMessage("APEX.DIALOG.VISUALLY_HIDDEN_TITLE")).markup(">").content(o.formatMessage("APEX.IG.COLUMN_HEADER_ACTIONS_FOR",h.heading.label)).markup("</h1><ul").attr(tt,N).markup(">"),h.features.controlBreak&&l(t,{label:Ci("CONTROL_BREAK"),icon:"icon-ig-control-break",data:{option:"break"}}),h.features.aggregate&&l(t,{label:Ci("AGGREGATE"),icon:"icon-ig-aggregate",data:{option:"aggregate"}}),r=0;r<g.length;r++)if(g[r].columnId===a){c=g[r].isFrozen;break}for(r=0;r<g.length;r++)g[r].isVisible&&!this._getColumn(g[r].columnId).isHidden&&g[r].seq>p&&(p=g[r].seq),g[r].columnId===a&&(d=g[r].seq);d<p&&l(t,{label:Ci(c?"UNFREEZE":"FREEZE"),icon:"icon-ig-frozen-column",isToggle:!0,toggleState:c,data:{option:"freeze"}}),h.features.canHide&&l(t,{label:Ci("HIDE"),icon:"icon-ig-remove-col",data:{option:he}}),h.helpid&&l(t,{label:Ci("HELP"),icon:"icon-ig-help",data:{option:"help"}}),t.markup("</ul>"),i&&(t.markup("<div").attr(tt,"a-IRR-sortWidget-search").markup(">"),Ji(t,{labelFor:u,cssClasses:"a-IRR-sortWidget-searchLabel",label:Ci("SEARCH"),labelTextHidden:!0}),h.filter.textCase&&(s=this._getTextTransformClass(h)),Ki(t,{id:u,cssClasses:"a-IRR-sortWidget-searchField"+(s?" "+s:""),placeholder:Ci("FILTER_WITH_DOTS")}),n&&(t.markup("<div").attr(tt,"a-IRR-sortWidget-rows").attr("id",this._getId("column_header_menu_rows")).markup(">"),t.markup("</div>")),t.markup("</div>"))},_setOperationUpdate:function(e){e.operation&&e.operation===Xe||(e.operation="u")},_renderIG:function(){var e=this,i=this.element,n=t.htmlBuilder(),o=this.options.config,a=this._getId("summary");o.toolbar&&n.markup("<div").attr(tt,f).markup("><div").attr("id",this._getId("toolbar")).markup(">").markup("</div></div>"),n.markup("<div").attr(tt,C).markup(">"),o.reportSettingsArea&&this._renderReportSettings(n),n.markup("<div class='u-vh'").attr("id",a).markup("></div><div").attr(tt,I).attr("id",this._getId("content_container")).attr(it,We).attr(q,Ci(this.editMode?ci:ui)).markup(">"),this._forEachView((function(t,i){n.markup("<div").attr("id",e._getId(i.elementId)).attr(tt,i.cssClass).attr(X,a).markup(" style='display:none'></div>")})),n.markup("</div></div>"),i.append(n.toString()),o.reportSettingsArea&&this._initReportSettings()},_resetReportSettings:function(){var e=this;this._ifNoChangesDo((function(t){if(e._currentReportSettings().baseReportId)return e._call({resetReportSettings:[e._report()]},{success:function(i){var n=e._defaultSavedReport(i.regions[0].resetReportSettings[0]);e.options.savedReports[e.currentSavedReportIdx]=n,t&&e.clearChanges(),e._report(n.id),e._updateChangeReportAction()}})}))},_openDialog:function(e,t){var i,n=this;function o(e){var t=e+"Dialog$",i="_render"+e.substr(0,1).toUpperCase()+e.substr(1)+"Dialog";return n[t]||n[i](),n[t]}function a(e,t){var i=o(e);t&&i.dialog(Ce,"id",t),i.dialog("open")}switch(t=t||{},e){case Ne:case ye:case Ve:case Le:case ke:a(e,t.id);break;case De:o(e).dialog(Ce,{id:t.id,columnId:t.columnId}).dialog("open");break;case Oe:an({labelKey:"APEX.IG.MINUTES_AGO",titleKey:"APEX.IG.FLASHBACK",okLabelKey:"APEX.DIALOG.SAVE",helpKey:"APEX.IG.HELP.FLASHBACK",helpTitleKey:"APEX.IG.HELP.FLASHBACK_TITLE",value:i=(i=n._currentReportSettings().flashback)?i.minsAgo:5},(function(e){!1!==e&&n.updateFlashback({isEnabled:!0,minsAgo:parseInt(e,10)})}));break;case be:this.viewsImpl.chart.openDialog();break;case Me:o("reportSettings").dialog(Ce,"saveAs",!1).dialog("open");break;case xe:o("reportSettings").dialog(Ce,"saveAs",!0).dialog("open");break;case He:a(e)}},_setModel:function(t){var i,n,o,a,l,r,s,d,u,h,g,p=!1,m=!1,f=!1,_=this.options.config,C=_.pagination.showTotalRowCount,I=t.viewImpl,v=I.internalIdentifier,b=_.views[v];I.model&&(c.release(I.modelName),I.modelName=null,I.model=null),t.remove||(b.useModelFrom&&_.views[b.useModelFrom].shareModel?d=(h=(u=this.getViews(b.useModelFrom)).internalIdentifier)+"_shared":(u=I,h=v,d=b.shareModel?h+"_shared":h),(g=this._isCurrentlyEditable()&&u.supports.edit)&&(p=_.editable.allowedOperations.create,m=_.editable.allowedOperations.update,f=_.editable.allowedOperations.delete),_.parentRegionStaticId&&null===_.modelInstanceId&&(g=!1),s=_.modelInstanceId?[_.regionStaticId+"_"+d,_.modelInstanceId]:_.regionStaticId+"_"+d,I.modelName=s,I.model=c.get(s),_.parentRegionStaticId&&this.parentModel&&I.model&&I.model.getOption("parentModel")!==this.parentModel&&(I.model=null),I.model||(u.supports.totalRows||(C=!1),(i=e.extend({},_.defaultModelOptions,{recordIsArray:!0,hasTotalRecords:C,regionId:_.regionId,regionStaticId:_.regionStaticId,ajaxIdentifier:_.ajaxIdentifier,pageItemsToSubmit:_.itemsToSubmit,parentRecordId:this.parentRecordId,fields:I.modelColumns,editable:g,saveSelection:g&&_.submitSelectedRows,paginationType:"progressive",regionData:{reportId:this._report(),view:h,ajaxColumns:_.ajaxColumns}})).types||(i.types={default:{operations:{canAdd:p,canEdit:m,canDelete:f}}}),["identityField","metaField","typeField","sequenceField"].forEach((e=>{I.specialColumns[e]&&(i[e]=I.specialColumns[e])})),_.parentRegionStaticId&&(this.parentModel?i.parentModel=this.parentModel:(n=e("#"+_.parentRegionStaticId+"_ig"),i.parentModel=_.parentRegionStaticId+"_"+n.interactiveGrid("getCurrentViewId"))),g&&(i.regionData.allowedOperations=_.editable.allowedOperations.protected),t.initialData?(o=t.initialData.values,a=C?t.initialData.totalRows:null,l=t.initialData.moreData,r=t.initialData.dataOverflow,I.model=c.create(s,i,o,a,l,r)):t.fetchData?I.model=c.create(s,i):I.model=c.create(s,i,[],0),this.modelReportSettingsSeq[s]=this.reportSettingsSeq),this._trigger("viewModelCreate",null,{viewId:v,model:I.model}),t.updateComponent&&(this.reportSettingsSeq>this.modelReportSettingsSeq[s]&&(this._updateModelRegionData(I),I.clearModelData()),I.setModelName(I.modelName,I.modelColumns)))},_anyChanges:function(){var e=this.editableViewImpl;return!!(e&&this._isCurrentlyEditable()&&e.model&&c.anyChanges(!1,e.model.name,!0))},_ifNoChangesDo:function(e,t){var i=this,n=this._anyChanges();t||(t=e,e=!1),n?e||setTimeout((function(){s.confirm(Ci("UNSAVED_CHANGES_CONTINUE_CONFIRM"),(function(e){e?(i._setEditMode(!1),t(n)):i._refreshReportSettings()}))}),1):t(n)},_clearToolbarSearch:function(){var e=this.options.config;e.toolbar&&e.toolbar.searchField&&e.toolbarData&&this._tbFindElement("search_field").val("")},_tbFind:function(e){var t=null,i=this.getToolbar();return i&&(t=i.toolbar("find",e)),t},_tbFindElement:function(t){var i=this.getToolbar();return i?i.toolbar("findElement",t):e()},resize:function(){var t,i,n,o,a=this.options.config,l=0,r=0,s=this.element,d=s.width(),c=this._currentViewImpl(),u=e(".a-IG-contentContainer",s).children().addBack();this.ignoreResizeHandler=!0,u.width(d),a.maxHeight&&(t=s.height(),n=e(_,s),o=e(".a-IG-controlsContainer",s),n.filter(":visible").length>0&&(l=n.outerHeight()),o.filter(":visible").length>0&&(r=o.outerHeight()),i=t-(l+r),u.height(i)),e.apex.stickyWidget&&s.find(".a-IG-header.js-stickyWidget-toggle, .a-GV-footer.js-stickyWidget-toggle").stickyWidget(de),c&&c.view$&&c.resize(),this.ignoreResizeHandler=!1},refresh:function(){var e=this;this._ifNoChangesDo((function(){e._forEachView((function(e,t){t.model&&t.clearModelData()}))}))},clearChanges:function(){var e;this.editableViewImpl&&(e=this.editableViewImpl.model)&&e.isChanged()&&e.clearChanges()},setMasterRecord:function(e,t){if(this.options.config.parentRegionStaticId)if(this.parentModel=e.modelId(),t){const i=e.getRecordId(t);this._setModelInstance(i,e,t),e.getRecordMetadata(i).deleted?this.actions.disable("selection-add-row"):this.actions.enable("selection-add-row")}else this._setModelInstance(null),this.actions.disable("selection-add-row");else i.warn("No master region defined.")},gotoCell:function(e,t,i){var n;this._view()!==this.editableView&&this._view(this.editableView),n=this._currentViewImpl(),e&&this._setModelInstance(e),n.gotoCell&&n.gotoCell(t,i)},getActions:function(){return this.actions},getToolbar:function(){return this.toolbar$},getSelectedRecords:function(){var e=this._currentViewImpl();return e.supports.selection?e.getSelectedRecords():null},setSelectedRecords:function(e,t,i){var n,o,a,l,r=this._currentViewImpl();if(r.supports.selection){if(e.length&&"string"==typeof e[0])for(l=r.model,o=e,e=[],n=0;n<o.length;n++)(a=l.getRecord(o[n]))&&e.push(a);r.setSelectedRecords(e,t,i)}},getReports:function(e){var t,n=this.options.savedReports;if(!e)return n;for(t=0;t<n.length;t++)if(n[t].id===e)return n[t];i.warn("No report exists with ID: ",e)},addReport:function(t,n){var o=e.extend(t,{operation:Xe,isEnabled:!0}),a=e.extend({save:!0},n);this.options.config.features.saveReport?(this.getReports().push(o),a.save&&this._saveReport(o,Xe)):i.warn("Unable to add report settings because the configuration disallows it.")},updateReport:function(t,n,o){var a,l,r=this.getReports(),s=e.extend({save:!0},o);if(this.options.config.features.saveReport){for(a=0;a<r.length;a++)if((l=r[a]).id===t){this._setOperationUpdate(n),l=e.extend(!0,l,n);break}s.save&&this._saveReport(l,"u")}else i.warn("Unable to update report settings because the configuration disallows it.")},deleteReport:function(t,n){var o={},a=e.extend({save:!0},n);this.options.config.features.saveReport?(o.id=t,o.operation=$e,a.save&&this._saveReport(o,$e)):i.warn("Unable to delete report settings because the configuration disallows it.")},getFilters:function(e){var t,n=this._currentReportSettings().filters;if(!e)return n;for(t=0;t<n.length;t++)if(n[t].id===e)return n[t];i.warn("No filter exists with ID: ",e)},addFilter:function(t,i){let n=this,o=e.extend(t,{operation:Xe,isEnabled:!0}),a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1,validate:!0},i);function l(){o.columnName&&(o.columnId=n._getColumnByName(o.columnName).id,delete o.columnName),n.getFilters().push(o),a.save&&n._setReportSettings({refreshModel:a.refreshData,affectsOtherViewsModels:!0})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},updateFilter:function(t,i,n){var o=this,a=this.getFilters(),l=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1,validate:!0},n);function r(){var n,r=o._isSettingsCheckboxFocused(t,ye);for(n=0;n<a.length;n++)if(a[n].id===t){o._setOperationUpdate(i),a[n]=e.extend(!0,a[n],i);break}l.save&&o._setReportSettings({refreshModel:l.refreshData,affectsOtherViewsModels:!0},(function(){o._focusOnSettingsCheckbox(r,t,ye)}))}l.skipNoChangesCheck?r():this._ifNoChangesDo(r)},deleteFilter:function(t,i){var n=this,o=this.getFilters(),a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function l(){var i;for(i=0;i<o.length;i++)if(o[i].id===t){o[i]=e.extend(!0,o[i],{operation:$e});break}a.save&&n._setReportSettings({refreshModel:a.refreshData,affectsOtherViewsModels:!0})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},getHighlights:function(e){var t,n=this._getCurrentView().highlights;if(!e)return n;for(t=0;t<n.length;t++)if(n[t].id===e)return n[t];i.warn("No highlight exists with ID: ",e)},addHighlight:function(t,i){var n=this,o=e.extend(t,{operation:Xe,isEnabled:!0}),a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function l(){o.columnName&&(o.columnId=n._getColumnByName(o.columnName).id,delete o.columnName),n.getHighlights().push(o),a.save&&n._setReportSettings({refreshModel:a.refreshData,affectsOtherViewsModels:!0})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},updateHighlight:function(t,i,n){var o=this,a=this.getHighlights(),l=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},n);function r(){var n,r=o._isSettingsCheckboxFocused(t,Le);for(n=0;n<a.length;n++)if(a[n].id===t){o._setOperationUpdate(i),a[n]=e.extend(!0,a[n],i),i.type===ne&&(delete a[n].columnId,delete a[n].columnType);break}l.save&&o._setReportSettings({refreshModel:l.refreshData,affectsOtherViewsModels:!0},(function(){o._focusOnSettingsCheckbox(r,t,Le)}))}l.skipNoChangesCheck?r():this._ifNoChangesDo(r)},deleteHighlight:function(t,i){var n=this,o=this.getHighlights(),a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function l(){var i;for(i=0;i<o.length;i++)if(o[i].id===t){o[i]=e.extend(!0,o[i],{operation:$e});break}a.save&&n._setReportSettings({refreshModel:a.refreshData,affectsOtherViewsModels:!0})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},getAggregates:function(){var e=[];return this._currentViewImpl().supports.aggregation&&(e=this._getCurrentView().aggregations),e},addAggregate:function(t,i){var n=this,o=e.extend(t,{operation:Xe}),a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function l(){n.getAggregates().push(o),a.save&&n._setReportSettings({refreshModel:a.refreshData})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},updateAggregate:function(t,i,n){var o=this,a=this.getAggregates(),l=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},n);function r(){var n,r=o._isSettingsCheckboxFocused(t,De);for(n=0;n<a.length;n++)if(a[n].id===t){o._setOperationUpdate(i),a[n]=e.extend(!0,a[n],i);break}l.save&&o._setReportSettings({refreshModel:l.refreshData},(function(){o._focusOnSettingsCheckbox(r,t,De)}))}l.skipNoChangesCheck?r():this._ifNoChangesDo(r)},deleteAggregate:function(t,i){var n=this,o=this.getAggregates(),a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function l(){var i;for(i=0;i<o.length;i++)if(o[i].id===t){o[i]=e.extend(!0,o[i],{operation:$e});break}a.save&&n._setReportSettings({refreshModel:a.refreshData})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},getFlashback:function(){return this._currentReportSettings().flashback},addFlashback:function(t,i){var n=this,o=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function a(){n._currentReportSettings().flashback=e.extend(t,{isEnabled:!0}),n._setOperationUpdate(n._currentReportSettings()),o.save&&n._setReportSettings({refreshModel:o.refreshData,affectsOtherViewsModels:!0,changeIdentifier:"editable"})}o.skipNoChangesCheck?a():this._ifNoChangesDo(a)},updateFlashback:function(t,i){var n=this,o=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function a(){var i=n._isSettingsCheckboxFocused("",Oe);n._setOperationUpdate(n._currentReportSettings()),n._currentReportSettings().flashback=e.extend(n._currentReportSettings().flashback,t),o.save&&n._setReportSettings({refreshModel:o.refreshData,affectsOtherViewsModels:!0,changeIdentifier:"editable"},(function(){n._focusOnSettingsCheckbox(i,"",Oe)}))}o.skipNoChangesCheck?a():this._ifNoChangesDo(a)},deleteFlashback:function(t){var i=this,n=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},t);function o(){i._setOperationUpdate(i._currentReportSettings()),i._currentReportSettings().flashback=!1,n.save&&i._setReportSettings({refreshModel:n.refreshData,affectsOtherViewsModels:!0,changeIdentifier:"editable"})}n.skipNoChangesCheck?o():this._ifNoChangesDo(o)},addControlBreak:function(t,i,n){var o=this,a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},n||{});function l(){var n,l,r=0,s=o._getCurrentView().columns;for(n=0;n<s.length;n++)if(s[n].columnId===t.id){l=s[n];break}if(!i.order){for(n=0;n<s.length;n++)s[n].break&&(r+=1);i.order=r+1}l=e.extend(!0,l,{isVisible:!i.isEnabled,break:{order:i.order,isEnabled:i.isEnabled,direction:i.direction,nulls:i.nulls}}),o._setOperationUpdate(l),i.isEnabled&&o._adjustControlBreakSort(),i.isEnabled?e.extend(t,{controlBreakIndex:i.order,controlBreakDirection:i.direction,hidden:!0}):e.extend(t,{controlBreakIndex:0,controlBreakDirection:null,hidden:!1}),a.save&&o._setReportSettings({refreshModel:a.refreshData,refreshColumns:a.refreshData})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},updateControlBreak:function(t,i,n){var o=this,a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},n||{});function l(){var n,l,r=o._getCurrentView().columns,s=o._isSettingsCheckboxFocused(t,ke);for(n=0;n<r.length;n++)if(r[n].columnId===t){l=r[n];break}l=e.extend(!0,l,{isVisible:!i.isEnabled,break:{order:i.order,isEnabled:i.isEnabled,direction:i.direction,nulls:i.nulls}}),o._setOperationUpdate(l),i.isEnabled?e.extend(o._currentViewImpl().modelColumns[o._getColumn(t).name],{controlBreakIndex:l.break.order,controlBreakDirection:l.break.direction,hidden:!0}):e.extend(o._currentViewImpl().modelColumns[o._getColumn(t).name],{controlBreakIndex:0,controlBreakDirection:null,hidden:!1}),o._adjustControlBreakSort(),a.save&&o._setReportSettings({refreshModel:a.refreshData,refreshColumns:a.refreshData},(function(){o._focusOnSettingsCheckbox(s,t,ke)}))}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},deleteControlBreak:function(t,i){var n=this,o=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i||{});function a(){var i,a,l=n._getCurrentView().columns;for(i=0;i<l.length;i++)if(l[i].columnId===t){a=l[i];break}a=e.extend(!0,a,{isVisible:!0,break:!1}),n._setOperationUpdate(a),e.extend(n._currentViewImpl().modelColumns[n._getColumn(t).name],{controlBreakIndex:0,controlBreakDirection:null,hidden:!1}),n._adjustControlBreakSort(),o.save&&n._setReportSettings({refreshModel:o.refreshData,refreshColumns:o.refreshData})}o.skipNoChangesCheck?a():this._ifNoChangesDo(a)},getSorts:function(){var t,i,n,o=[],a=this._getCurrentView().columns;for(t=0;t<a.length;t++)(i=a[t]).sort&&(n=e.extend({},{columnId:i.columnId,order:i.sort.order,direction:i.sort.direction,nulls:i.sort.nulls}),o.push(n));for(o.length>0&&(o=o.sort((function(e,t){return e.order-t.order}))),t=0;t<o.length;t++)delete o[t].order;return o},setSorts:function(e){var t,i,n,o,a,l,r,s=this,d=this.options.config,c=this._currentViewImpl(),u=c.internalIdentifier,h=d.views[u],g=this._getCurrentView().columns,p=null;this._ifNoChangesDo((function(){for(h.useModelFrom&&d.views[h.useModelFrom].shareModel&&(c=s.getViews(h.useModelFrom)),c.supports.configurableColumns&&(p=c.getColumns()),i=0;i<e.length;i++){for(a=e[i],o=!1,t=0;t<g.length;t++)if(l=g[t],a.columnId===l.columnId){o=!0;break}o||g.push({columnId:a.columnId,operation:Xe,columnType:oe,isVisible:!1,isFrozen:!1})}for(t=0;t<g.length;t++){if(l=g[t],o=!1,p)for(n=0;n<p.length;n++)if(l.columnId===p[n].id){r=p[n];break}for(i=0;i<e.length;i++)if((a=e[i]).columnId===l.columnId){o=!0,a.order=i+1;break}o?(delete a.columnId,l.sort&&a.order===l.sort.order&&a.direction===l.sort.direction&&a.nulls===l.sort.nulls||(l.sort=a,s._setOperationUpdate(l),r&&(r.sortIndex=l.sort.order,r.sortDirection=l.sort.direction))):l.sort&&(l.sort=!1,s._setOperationUpdate(l),r&&(r.sortIndex=null,r.sortDirection=null))}s._adjustControlBreakSort(),s._setReportSettings({refreshModel:!0,refreshColumns:!0}),c!==s._currentViewImpl()&&(c.refreshColumns(),c.refresh())}))},getChart:function(){return this._currentReportSettings().views.chart},setChart:function(t){var i,n=this,o=this.getChart(),a=this._currentViewImpl(),l={};o?(i=e.extend(o,t),this._setOperationUpdate(i)):i=e.extend({operation:Xe},t),this._currentReportSettings().views.chart=i,this._view()===be?(l.ig=this,l.igConfig=this.options.config,a.initView(l),this._setReportSettings({refreshView:!0,refreshModel:!0})):this._setReportSettings({},(function(){n._view(be,{fetchData:!0})}))},deleteChart:function(){var e=this,t=this._currentViewImpl();this._currentReportSettings().views.chart={operation:$e},this._setReportSettings({},(function(){t.destroyView(e),t.view$=null}))},getViews:function(e){return e?this.viewsImpl[e]:this.viewsImpl},getCurrentView:function(){return this.getViews(this.getCurrentViewId())},getCurrentViewId:function(){return this._view()},focus:function(){var e=this.options.config;e.toolbar&&e.toolbar.searchField&&this.toolbar$?this._tbFindElement("search_field").focus():this._currentViewImpl().focus()}}),e.apex.interactiveGrid.copyDefaultToolbar=xi;var rn=[];function sn(e){rn.push(e)}e.apex.interactiveGrid.registerView=sn;var dn=["selection-fill","selection-clear","selection-copy-down"],cn={setColumnConfig:function(i){var n,o,a,l,r,s,c,u,h={},g=i.baseModelColumns,p=i.igConfig,m=p.views[this.internalIdentifier].features,f=i.currentReportSettings,_=i.ig,C=Ge,I=!1!==p.editable;for(n=0;n<f.views.grid.columns.length;n++)o=f.views.grid.columns[n],a=_._getColumn(o.columnId),(c=e.extend(!0,{},a.defaultGridColumnOptions||{},g[o.columnId])).elementId=a.staticId,c.seq=o.seq,void 0===c.noStretch&&(void 0!==a.layout.noStretch?c.noStretch=a.layout.noStretch:null!==m.stretchColumns?c.noStretch=!m.stretchColumns:c.noStretch=!f.views.grid.stretchColumns),a.isHidden||(c.hidden=!o.isVisible,c.frozen=o.isFrozen,o.width&&(c.width=o.width),o.sort&&(c.sortIndex=o.sort.order,c.sortDirection=o.sort.direction),(s=o.break)&&s.isEnabled&&(C=s.direction,c.controlBreakIndex=s.order,c.controlBreakDirection=C),a.layout.groupId&&("both"===a.layout.useGroupFor?c.useGroupFor="srv,heading":c.useGroupFor=a.layout.useGroupFor,c.groupName=a.layout.groupId),c.helpid=a.helpid,c.canHide=a.features.canHide,c.canSort=a.features.sort,a.link.attributes&&(c.linkAttributes=a.link.attributes),a.link.text&&(c.linkText=a.link.text),a.link.targetColumn&&(c.linkTargetColumn=a.link.targetColumn)),a.accessibility.usedAsRowHeader&&(c.usedAsRowHeader=a.accessibility.usedAsRowHeader),a.appearance.columnCssClasses&&(c.columnCssClasses=a.appearance.columnCssClasses),a.appearance.fieldColSpan&&(c.fieldColSpan=a.appearance.fieldColSpan),a.appearance.fieldCssClasses&&(c.fieldCssClasses=a.appearance.fieldCssClasses),a.validation&&(c.isRequired=a.validation.isRequired),a.appearance.cellTemplate&&(c.cellTemplate=a.appearance.cellTemplate),I&&(c.noCopy=!a.default.duplicate,void 0===c.defaultValue&&(u=a.default.value,e.isPlainObject(u)&&void 0!==u.d&&c.elementId&&(u.d=d(c.elementId).displayValueFor(u.d)),c.defaultValue=u)),"actions"===a.specialType&&(r="a-Button--noLabel a-Button--iconTextButton a-Button--actions",ji(l=t.htmlBuilder(),{label:Ci("ROW_ACTIONS"),buttonClass:r,iconOnly:!0,icon:"icon-ig-actions",attributes:{"data-menu":_._getId("row_actions_menu"),"aria-haspopup":!0,"aria-expanded":!1}}),c.cellTemplate=l.toString(),l.clear(),ji(l,{label:Ci("SEL_ACTIONS"),buttonClass:r+" js-selectionMenu",iconOnly:!0,icon:"icon-ig-actions",attributes:{"data-menu":_._getId("selection_actions_menu"),"aria-haspopup":!0}}),c.heading=l.toString(),c.columnCssClasses?c.columnCssClasses+=" has-button":c.columnCssClasses=P,c.headingCssClasses?c.headingCssClasses+=" has-button":c.headingCssClasses=P,delete c.index,c.virtual=!0,c.noHeaderActivate=!0,c.elementId=null,0===n&&(c.frozen=!0,o.isFrozen=!0),c.noStretch=!0,c.canSort=!1,c.width||(c.width=42)),h[a.name]=c;h._meta=g._meta,this.modelColumns=h,this.specialColumns={identityField:0===_.primaryKeyColumns.length?null:_.primaryKeyColumns,metaField:Ze}},init:function(e){var t=e.options.config;e.getActions().add([{name:"selection-copy-down",labelKey:"APEX.IG.COPY_DOWN",icon:"icon-ig-copy-down",hide:!0,action:function(){var t=e._currentViewImpl();t.singleRowMode||t.view$.grid("copyDownSelection")}},{name:"selection-clear",labelKey:"APEX.IG.CLEAR",icon:"icon-ig-clear",hide:!0,action:function(){var t=e._currentViewImpl();t.singleRowMode||t.view$.grid("fillSelection","")}},{name:"selection-fill",labelKey:"APEX.IG.FILL",icon:"icon-ig-fill",hide:!0,getFillValue:function(e,t,i,n){let o={labelKey:"APEX.IG.FILL_LABEL",titleKey:"APEX.IG.FILL_TITLE"};i&&(o.label=i),t&&e&&(o.type="item",o.columnItem=t,o.viewInst=e),an(o,n)},action:function(){let t=e._currentViewImpl();if(!t.singleRowMode){let e,i,n,o=null,a=null,l=t.view$.grid("instance");l.options.selectCells&&(e=l.getSelectedRange(),e&&1===e.columns.length&&(i=e.columns[0],n=l.options.columns[0][i],a=n.label||n.heading,o=l.columnItems[i],!n.readonly&&o&&o.element$.parent()[0]===l.columnItemsContainer$[0]||(o=null,a=null))),this.getFillValue(l,o,a,(e=>{!1!==e&&t.view$.grid("fillSelection",e)}))}}}]),this._initMenus(t,e)},initView:function(i){var n,o,a,l,d,c,u,g=null,m=t.htmlBuilder(),f=!0,C=i.igConfig,I=C.defaultGridViewOptions,v=I.multiple,b=I.selectAll,E=C.views.grid.features,w=!1,A=I.rowHeader||Ue,R=i.ig,S=R.actions,N=R._isCurrentlyEditable(),y=C.columnGroups,L=!!N&&C.editable.autoAddRow,O=this,V=!0,D=null,k=null;function x(e,t){R.editMode=t.editMode,R.actions.update("edit"),R._trigger("modeChange",e,t)}function H(e){D.hide(),k.removeClass(M).attr(U,"false"),e&&(k.trigger("focus"),O.view$.grid("focus")),k=null,R._off(R.document,"mousedown"),R._off(R.window,"blur"),R._off(D)}function G(){var e,t,i,n=R._currentReportSettings().views.grid.columns,o=O.view$.grid("getColumns"),a=0,l=!1,r=!1;for(e=0;e<n.length;e++)n[e]&&n[e].isVisible&&!R._getColumn(n[e].columnId).isHidden&&n[e].seq>a&&(a=n[e].seq,l=e);if(!1!==l){for(t=n[l],e=0;e<o.length;e++)t.columnId!==o[e].id||o[e].hidden||(i=o[e]);t.isFrozen&&(t.isFrozen=!1,i.frozen=!1,r=!0,R._setOperationUpdate(t))}r?R._setReportSettings({refreshView:!0,refreshColumns:!0}):(R._setReportSettings(),O.singleRowView$&&O.singleRowView$.recordView("refreshFields").recordView(de))}if(!E.gridView&&!E.singleRowView)throw new Error("Interactive Grid grid view must have at least one of grid or single row");switch(e("div.a-GV-columnItemContainer",i.ig$).appendTo(i.ig$),E.gridView&&(m.markup("<div").attr(tt,T).attr("style","display:none;").attr("id",R._getId("column_header_menu")).attr(it,"dialog").attr(q,Ci("COLUMN_HEADER_ACTIONS")).attr("aria-modal","true").markup(">").markup("</div>"),D=e(m.toString()),e("body").append(D),(u=i.currentReportSettings.views.grid.aggregations).length>0&&(A!==Ue&&A!==Qe||(A=Je))),E.rowSelector&&(A===Ue&&(A=Qe),w=!E.rowSelector.hideControl,void 0===v&&(v=E.rowSelector.multiSelect),v&&void 0===b&&(b=E.rowSelector.selectAll)),C.headingFixedTo){case Ue:f=!1,l=!1,d=!1;break;case We:f=!0,l=!1,d=!1;break;case Ke:f=!1,l=function(){return r.defaultStickyTop()+(e(_,i.ig$).outerHeight()||0)},d=I.stickyFooter||!0}if(y.length)for(g={},n=0;n<y.length;n++)g[(o=e.extend({},y[n])).id]=o,delete o.id;if(E.gridView){I.contextMenu&&!mi(I.contextMenu,"actionsContext")&&(I.contextMenu.actionsContext=R.actions),C.editable&&!1===C.editable.allowedOperations.create&&!1===C.editable.allowedOperations.update&&(V=!1);let n=R._getPaginationConfig(C,"defaultGridViewOptions");c={modelName:O.modelName,editable:N,autoAddRecord:L,rowHeader:A,rowHeaderCheckbox:w,aggregateLabels:this._gridAggregateLabels(),highlights:this._gridHighlightsFromReport(i.currentReportSettings),multiple:v,selectAll:b,noDataMessage:C.text.noDataFound,moreDataMessage:C.text.moreDataFound,showNullAs:C.appearance.showNullValue,fixedRowHeight:Ii(I.fixedRowHeight,C.appearance.useFixedRowHeight),columns:[O.modelColumns],columnSort:E.sort,reorderColumns:Ii(I.reorderColumns,E.reorderColumns),resizeColumns:Ii(I.resizeColumns,E.resizeColumns),pagination:n,rowsPerPage:Ii(I.rowsPerPage,i.currentReportSettings.rowsPerPage),hasSize:f,stickyTop:l,stickyFooter:d,allowEditMode:V,persistSelection:Ii(I.persistSelection,C.submitSelectedRows||n.virtual),activateColumnHeader:function(i,n){var o,a,l,d,c,u,g,m=[],f=t.htmlBuilder();function _(i){var n,o,a,l=t.htmlBuilder();for(n=0;n<i.length;n++)e.isPlainObject(i[n])?(o=i[n].r,a=i[n].d):o=a=i[n],Qi(l,{cssClasses:"a-IRR-sortWidget-row",text:a,data:{"return-value":o}});R._getElement("column_header_menu_rows").html(l.toString())}function C(e){var t=D.find(":focusable");e||(o=t.first()).data("first",!0),(a=t.last()).data("last",!0)}D.is(":visible")?H():((l=R._isColumnFilterable(n.column.id))&&(d=R._hasColumnFilterLov(n.column.id)),k=n.header$,n.header$.addClass(M).attr(U,"true"),R._renderColumnHeaderMenu(f,l,d,n.column.id),c>220?(u=n.column.frozen?2:1,c=n.header$.outerWidth(),D.css("min-width",c-u)):D.css("min-width","0"),g=R.isRTL?j:z,D.html(f.toString()).show().css({left:0,top:0}).position({my:g+" top",at:g+" bottom",of:n.header$,collision:"fit"}),d?R._getFilterValues(n.column.id,!0,(function(e){e.regions[0].filterValues&&(R._getElement("column_header_search").focus(),_(m=e.regions[0].filterValues),C())})):(C(),o.trigger("focus")),R._on(D,{"click button.a-IRR-sortWidget-button":function(t){var i,o,a,l=Ge;switch(e(t.currentTarget).data(Ce)){case"hide":O.view$.grid("hideColumn",n.column),R._currentViewColumn(n.column.id,{isVisible:!1}),G(),H(!0);break;case"break":(i=R._currentViewColumn(n.column.id)).sort&&(l=i.sort.direction),R.addControlBreak(n.column,{isEnabled:!0,direction:l}),H(!0);break;case"aggregate":R._openDialog(De,{columnId:n.column.id}),H();break;case"freeze":if(o=R._currentReportSettings().views.grid.columns,O.view$.grid(n.column.frozen?"unfreezeColumn":"freezeColumn",n.column),n.column.frozen)for(a=0;a<o.length;a++)(i=o[a]).seq<=n.column.seq&&!i.isFrozen&&(i.isFrozen=!0,R._setOperationUpdate(i));else for(a=0;a<o.length;a++)(i=o[a]).seq>=n.column.seq&&i.isFrozen&&(i.isFrozen=!1,R._setOperationUpdate(i));R._setReportSettings(),H(!0);break;case"help":H(!0),r.popupFieldHelp(R._getColumn(n.column.id).helpid,apex.env.APP_SESSION)}},keydown:function(t){var i;t.which===e.ui.keyCode.ESCAPE?(H(!0),t.preventDefault()):t.which===e.ui.keyCode.TAB&&(!(i=!!t.shiftKey)&&e(t.target).data("last")&&(t.preventDefault(),o.focus()),i&&e(t.target).data("first")&&(t.preventDefault(),a.trigger("focus")))},"keydown input.a-IRR-sortWidget-searchField":function(t){var i,o,a,r=e(t.target).val();if(l&&t.which===e.ui.keyCode.ENTER){if((a=this._getColumn(n.column.id).filter.dataType)===Ht)try{i=p.parse(r,this._getColumn(n.column.id).appearance.formatMask),R.addFilter({type:oe,columnType:oe,columnId:n.column.id,operator:gt,value:Bi(i),isCaseSensitive:!1})}catch(e){s.alert(Ci("INVALID_DATE_FORMAT"))}else a===xt?(o=h.toNumber(r,this._getColumn(n.column.id).appearance.dateFormatMask),isNaN(o)?s.alert(Ci(si)):R.addFilter({type:oe,columnType:oe,columnId:n.column.id,operator:gt,value:o,isCaseSensitive:!1})):R.addFilter({type:oe,columnType:oe,columnId:n.column.id,operator:a===Mt||a===Gt?bt:gt,value:r,isCaseSensitive:!1});H(!0),t.preventDefault()}},"keyup input.a-IRR-sortWidget-searchField":function(e){if(d){var t=e.target.value;_(m.filter((function(e){return e.d?e.d.toLowerCase().indexOf(t.toLowerCase())>-1:e.toLowerCase().indexOf(t.toLowerCase())>-1}))),C(!0)}},"click a.a-IRR-sortWidget-row":function(t){var i,o,a,l,r=e(t.currentTarget).data("returnValue"),c=R._getColumn(n.column.id);d&&((i=c.filter.dataType)===Ht||i.indexOf(Ft)>-1?(o=r.indexOf(Ye),a=r.substring(0,o),l=r.substring(o+1),o>0&&R.addFilter({type:oe,columnType:oe,columnId:n.column.id,operator:a,value:l,isCaseSensitive:!1})):i===xt?(l=h.toNumber(r,c.appearance.dateFormatMask),isNaN(l)?s.alert(Ci(si)):R.addFilter({type:oe,columnType:oe,columnId:n.column.id,operator:gt,value:l,isCaseSensitive:!1})):R.addFilter({type:oe,columnType:oe,columnId:n.column.id,operator:gt,value:r,isCaseSensitive:!0}),H(!0),t.preventDefault())}}),R._on(R.document,{mousedown:function(t){!e(t.target).closest(D).length>0&&!e(t.target).closest(n.header$).length>0&&D.is(":visible")&&H()}}),R._on(R.window,{blur:function(){D.is(":visible")&&H()}}))},cancelColumnHeader:function(){D.is(":visible")&&H()},sortChange:function(e,t){R._ifNoChangesDo((function(){var e,i,n,o,a,l=t.column.sortIndex,r=O.view$.grid("getColumns");for(n=1,e=0;e<r.length;e++)(i=r[e]).sortIndex&&("change"===t.action?i===t.column&&(n=i.sortIndex):"add"===t.action?i.sortIndex>=n&&(n=i.sortIndex+1):"remove"===t.action?i===t.column?(delete i.sortIndex,delete i.sortDirection,(o=R._currentViewColumn(t.column.id)).sort=!1,R._setOperationUpdate(o)):i.sortIndex>l&&(i.sortIndex-=1,R._currentViewColumn(i.id,{sort:{order:i.sortIndex}})):"clear"!==t.action&&"set"!==t.action||(delete i.sortIndex,delete i.sortDirection,(o=R._currentViewColumn(i.id)).sort=!1,R._setOperationUpdate(o)));"clear"!==t.action&&"remove"!==t.action&&(t.column.sortIndex=n,t.column.sortDirection=t.direction,a=t.direction===Ge?Pe:Fe,R._currentViewColumn(t.column.id,{sort:{order:n,direction:t.direction,nulls:a}})),R._setReportSettings({refreshModel:!0,refreshColumns:!0})}))},columnReorder:function(e,t){var i,n,o,a,l,r=R._currentReportSettings().views.grid.columns,s=r[t.newPosition].isFrozen;for(o=r,a=t.oldPosition,l=t.newPosition,o.splice(l,0,o.splice(a,1)[0]),r[t.newPosition]&&(r[t.newPosition].isFrozen=s),i=0;i<r.length;i++)r[i]||r.splice(i,1);for(i=0;i<r.length;i++)(n=r[i]).seq!==i+1&&(n.seq=i+1,R._setOperationUpdate(n));G()},columnResize:function(e,t){R._currentViewColumn(t.column.id,{width:t.width}),R._setReportSettings()},modeChange:x,selectionChange:function(t){var i=O.view$.grid("getSelection");e(".js-selectionMenu",O.view$).prop(fe,0===i.length),O._selectionChange(R,t)},pageChange:function(e,t){R._pageChange(t)}},u.length>0&&(c.aggregateTooltips=this._gridAggregateTooltipsFromReport(R,i.currentReportSettings)),g&&(c.columnGroups=g),O.view$.grid({},I,c),O.curInst=O.view$.grid("instance")}else O.view$.hide(),O.singleRowMode=!0;O.supports.singleRowView&&E.singleRowView&&(O.singleRowView$=e("<div id='"+R._getId("singleRow_vc")+"' class='a-IG-recordView'></div>").attr(X,R._getId("summary")),O.view$.after(this.singleRowView$),O.singleRowView$.width(O.view$.width()),C.maxHeight&&O.singleRowView$.height(O.view$.height()),(a=e.apex.recordView.copyDefaultToolbar())[0].controls.unshift({type:dt,labelKey:"APEX.IG.SRV_CHANGE_MENU",iconOnly:!0,icon:"icon-ig-actions",menuId:R._getId("srv_actions_menu")}),E.gridView&&(S.remove(["close-single-row-view"]),S.add([{name:"close-single-row-view",labelKey:"APEX.IG.REPORT_VIEW",action:function(){var e,t=R.editMode;return t&&O.singleRowView$.recordView("setEditMode",!1),O.singleRowMode=!1,O.singleRowView$.hide(),O.curInst=O.view$.grid("instance"),R._updateSummary(),(e=R._tbFind("selection_submenu"))&&(e.disabled=!O.supports.selection),O.view$.show().grid(ce),t&&O.view$.grid("setEditMode",!0),O.view$.grid("focus"),!0}}]),a[0].controls.unshift({type:st,action:"close-single-row-view"})),O.singleRowView$.recordView({},C.defaultSingleRowOptions,{modelName:O.modelName,actionsContext:S,toolbar:a,editable:N,autoAddRecord:L,noDataMessage:C.text.noDataFound,moreDataMessage:C.text.moreDataFound,showNullAs:C.appearance.showNullValue,fields:[O.modelColumns],fieldGroups:g,hasSize:f,modeChange:x,recordChange:function(e){O._selectionChange(R,e)}}),E.gridView?(O.singleRowView$.hide(),O.singleRowMode=!1):O.curInst=O.singleRowView$.recordView("instance"))},viewChanged:function(e,t,i){t._toggleEnableAction(e&&i.editable&&this.supports.edit,dn),e&&this._selectionChange(t)},updateActions:function(e){var t=e.ig,i=t.options.config;t._toggleShowAction(e.canEdit&&this.supports.edit&&this.supports.cellSelection&&i.views.grid.features.cellRangeActions,dn)},setReportOptions:function(e,t,i,n){var o,a=this,l=e.options.config;(o={"views.grid.aggregations":function(){a._hasGridView()&&a.view$.grid(Ce,"aggregateTooltips",a._gridAggregateTooltipsFromReport(e,i))},"views.grid.highlights":function(){a._hasGridView()&&a.view$.grid(Ce,"highlights",a._gridHighlightsFromReport(i))},"views.grid.columns":function(){var t,n,o,r,s,d,c=l.views.grid.features,u=i.views.grid.columns,h=a.getColumns(),g=!1!==c.gridView,p=!1;for(t=0;t<u.length;t++)for(s=u[t],o=e._getColumn(s.columnId),n=0;n<h.length;n++)if((r=h[n]).id===s.columnId){g&&(d=r.noStretch,void 0!==o.defaultGridColumnOptions&&void 0!==o.defaultGridColumnOptions.noStretch||(void 0!==o.layout.noStretch?r.noStretch=o.layout.noStretch:null!==c.stretchColumns?r.noStretch=!c.stretchColumns:r.noStretch=!i.views.grid.stretchColumns),r.noStretch!==d&&(p=!0)),r.hidden===s.isVisible&&r.canHide&&(r.hidden=!s.isVisible,p=!0);break}p&&(a.refreshColumns(),a.refresh())},editable:function(){var t=e._isCurrentlyEditable();a.model.getOption("identityField")&&a.model.setOption("editable",t),a.singleRowView$&&(a.singleRowView$.recordView(Ce,"editable",t),a.singleRowView$.recordView(Ce,"autoAddRecord",t)),a._hasGridView()&&(a.view$.grid(Ce,"editable",t),a.view$.grid(Ce,"autoAddRecord",t)),e._updateActions()},rowsPerPage:function(){a._hasGridView()&&(a.view$.grid(Ce,"rowsPerPage",i.rowsPerPage),t||(a.pendingRefresh=!0))}})[n]&&a.view$&&o[n]()},_selectionChange:function(e,t){t&&e._selectionChange(t)},_initMenus:function(t,i){var n=null,o=null,a=null,l=this,r=t.views.grid.features,s=[],d=[],c=[],u=i._tbFind("selection_submenu");function h(e){c.push(e),u&&u.push(e)}u&&(u=u.menu.items,l._selectionMenuItems=u,l._selectionMenuStart=u.length),c.push({type:ot,action:"selection-copy",accelerator:"Ctrl+C"}),c.push(rt),n=e("<div/>",{id:i._getId("row_actions_menu")}).appendTo("body"),o=e("<div/>",{id:i._getId("srv_actions_menu")}).appendTo("body"),a=e("<div/>",{id:i._getId("selection_actions_menu")}).appendTo("body"),l.supports.singleRowView&&(s.push({id:"srv",type:ot,action:"single-row-view"}),s.push(rt)),t.editable&&(t.editable.allowedOperations.create&&(s.push({id:"ins",type:ot,action:"row-add-row"}),d.push({id:"ins",type:ot,label:t.text.addRowButton,action:"insert-record"}),s.push({id:"dup",type:ot,action:"row-duplicate"}),d.push({id:"dup",type:ot,action:"duplicate-record"}),h({id:"dup",type:ot,action:"selection-duplicate"}),s.push(rt),h(rt)),(t.editable.allowedOperations.delete||t.editable.allowedOperations.create)&&(s.push({id:"del",type:ot,action:"row-delete"}),d.push({id:"del",type:ot,action:"delete-record"})),t.editable.allowedOperations.delete&&h({id:"del",type:ot,action:"selection-delete"})),s.push(rt),s.push({id:"refresh",type:ot,action:"row-refresh"}),d.push({id:"refresh",type:ot,action:"refresh-record"}),h(rt),h({id:"refresh",type:ot,action:"selection-refresh"}),t.editable&&((t.editable.allowedOperations.update||t.editable.allowedOperations.delete)&&(s.push({id:"revert",type:ot,action:"row-revert"}),d.push({id:"revert",type:ot,action:"revert-record"}),h({id:"revert",type:ot,action:"selection-revert"})),r.cellRangeActions&&(h(rt),h({id:"copy_down",type:ot,action:"selection-copy-down"}),h({id:"fill",type:ot,action:"selection-fill"}),h({id:"clear",type:ot,action:"selection-clear"}))),n.menu({actionsContext:i.actions,items:s,beforeOpen:function(){var e,o=l.view$.find(".a-Button--actions.is-active").closest("tr");l.singleRowMode?(i._updateAction(he,"single-row-view"),e=l.getSelectedRecords()):e=l.view$.grid("getRecords",[o]),t.editable&&(t.editable.allowedOperations.create&&(n.menu("find","dup").disabled=!l.model.allowAdd(null,"copy"),n.menu("find","ins").disabled=!l.model.allowAdd(null,"new")),(t.editable.allowedOperations.update||t.editable.allowedOperations.delete)&&i._toggleEnableAction(l.model.canRevertRecord(e[0]),["row-revert"]),t.editable.allowedOperations.delete||i._toggleShowAction(l.model.allowDelete(e[0]),"row-delete"),t.editable.allowedOperations.delete&&i._toggleEnableAction(l.model.allowDelete(e[0]),["row-delete"]))},afterClose:function(){l.singleRowMode&&i._updateAction(ue,"single-row-view"),i._updateSelectionActions()}}),o.menu({actionsContext:i.actions,items:d,beforeOpen:function(){var e=l.getSelectedRecords();t.editable&&(t.editable.allowedOperations.create&&(o.menu("find","dup").disabled=!l.model.allowAdd(null,"copy"),o.menu("find","ins").disabled=!l.model.allowAdd(null,"new")),(t.editable.allowedOperations.update||t.editable.allowedOperations.delete)&&(o.menu("find","revert").disabled=!e.length||!l.model.canRevertRecord(e[0])),t.editable.allowedOperations.delete||i._toggleShowAction(l.model.allowDelete(e[0]),"delete-record"),t.editable.allowedOperations.delete&&(o.menu("find","del").disabled=!e.length||!l.model.allowDelete(e[0])))}}),a.menu({actionsContext:i.actions,items:c,beforeOpen:function(){i._updateSelectionActions()}}),u&&i._tbFindElement("actions_button_menu").on("menubeforeopen.gridview",(function(){i._updateSelectionActions()})),l.rowActionMenu$=n,l.srvActionMenu$=o,l.selActionMenu$=a},_gridAggregateLabels:function(){var e=null;return this.aggregateLabels||(this.aggregateLabels=e={},Object.values(pi).forEach((t=>{e[t]={label:Ci(t),overallLabel:Ci(t+"_OVERALL")}}))),this.aggregateLabels},_gridAggregateTooltipsFromReport:function(e,t){var i,n,o=null,a=t.views.grid.aggregations;if(a.length>0)for(o={},i=0;i<a.length;i++)(n=a[i]).tooltip&&(o[n.function+"|"+e._getColumn(n.columnId).name]=n.tooltip);return o},_gridHighlightsFromReport:function(e){var t,i,n={},o=e.views.grid.highlights;for(t=0;t<o.length;t++)n[(i=o[t]).id]={seq:i.seq,row:i.type===ne,color:i.textColor,background:i.backgroundColor};return n},_hasGridView:function(){return this.view$.is(":apex-grid")},destroyView:function(e){this._hasGridView()&&this.view$.grid(se),this.singleRowView$&&this.singleRowView$.remove(),e._getElement("column_header_menu").remove()},destroy:function(){this.rowActionMenu$&&this.rowActionMenu$.length>0&&(this.rowActionMenu$.remove(),this.rowActionMenu$=null),this.selActionMenu$&&this.selActionMenu$.length>0&&(this.selActionMenu$.remove(),this.selActionMenu$=null),this._selectionMenuStart&&this._selectionMenuItems&&(this._selectionMenuItems.length=this._selectionMenuStart,this._selectionMenuItems=this._selectionMenuStart=null)},getContextRecord:function(t){var i;return this.singleRowMode?[this.singleRowView$.recordView("getRecord")]:(i=e(t).closest("tr")).length>0?this.view$.grid("getRecords",[i]):[]},getColumns:function(){return this.singleRowMode?this.curInst.getFields():this.curInst.getColumns()},canCopy2Clipboard:function(){return!this.singleRowMode&&this.curInst.option("allowCopy")},selectCells:function(e){if(!this.singleRowMode){if(void 0===e)return this.view$.grid(Ce,"selectCells");this.view$.grid(Ce,"selectCells",e)}},getSelectedRecords:function(){var e;return this.singleRowMode?(e=this.curInst.getRecord())?[e]:[]:this.curInst.getSelectedRecords()},setSelectedRecords:function(e,t,i){var n;this.singleRowMode?((n=this.model.indexOf(e[0]))<0&&(n=0),this.singleRowView$.recordView(Ce,"recordOffset",n)):this.view$.grid("setSelectedRecords",e,t,i)},getActiveRecordId:function(){return this.curInst.getActiveRecordId()},setModelName:function(e){this.view$&&this.view$.grid("instance").option("modelName",e),this.singleRowView$&&this.singleRowView$.recordView("instance").option("modelName",e)},setEditMode:function(e){this.curInst.setEditMode(e)},finishEditing:function(){return this.curInst.finishEditing()},setNoDataMessage:function(e){this.curInst.option("noDataMessage",e)},focus:function(){this.curInst.focus()},refreshColumns:function(){this._hasGridView()&&this.view$.grid("refreshColumns"),this.singleRowView$&&this.singleRowView$.recordView("refreshFields")},footerHeight:function(){return!this.singleRowMode&&this.view$&&this.view$.find(".a-GV-footer").outerHeight()||0},refresh:function(){this._hasGridView()&&this.view$.grid(de),this.singleRowView$&&this.singleRowView$.recordView(de)},resize:function(){this.curInst.resize()},show:function(){this.curInst.element.show()},hide:function(){this.curInst.element.hide()}},un={setColumnConfig:function(t){var i,n,o={},a={},l=t.baseModelColumns,r=t.igConfig,s=t.ig,d=!1!==r.editable,c=0;for(n in l)mi(l,n)&&(c+=1,o=e.extend(!0,{},l[n]),n!==Ze?(i=s._getColumn(n),o.elementId=i.staticId,o.seq=c,d&&"actions"===i.specialType&&(delete o.index,o.virtual=!0,o.elementId=null),a[i.name]=o):a._meta=o);this.modelColumns=a,this.specialColumns={identityField:0===s.primaryKeyColumns.length?null:s.primaryKeyColumns,metaField:Ze}},initView:function(e){var t=!0,i=!1,n=e.igConfig,o=e.ig,a=this.internalIdentifier===ve?n.defaultIconViewOptions:n.defaultDetailViewOptions;switch(n.headingFixedTo){case Ue:t=!1;break;case Ke:t=!1,i=!0}this.view$.tableModelView(this.viewConfig(e,{modelName:this.modelName,noDataMessage:n.text.noDataFound,moreDataMessage:n.text.moreDataFound,showNullAs:n.appearance.showNullValue,hasSize:t,columns:this.modelColumns,pagination:o._getPaginationConfig(n,this.internalIdentifier===ve?"defaultIconViewOptions":"defaultDetailViewOptions"),rowsPerPage:Ii(a.rowsPerPage,e.currentReportSettings.rowsPerPage),stickyFooter:i,selectionChange:function(e){o._selectionChange(e)},pageChange:function(e,t){o._pageChange(t)}}))},destroyView:function(){this.view$.tableModelView(se)},setReportOptions:function(e,t,i,n){var o,a=this;(o={rowsPerPage:function(){a.view$.tableModelView(Ce,"rowsPerPage",i.rowsPerPage),t||(a.pendingRefresh=!0)}})[n]&&a.view$&&o[n]()},getSelectedRecords:function(){return this.view$.tableModelView("getSelectedRecords")},setSelectedRecords:function(e,t,i){this.view$.tableModelView("setSelectedRecords",e,t,i)},setModelName:function(e){this.view$.tableModelView(Ce,"modelName",e)},setNoDataMessage:function(e){this.view$.tableModelView(Ce,"noDataMessage",e)},footerHeight:function(){return this.view$&&this.view$.find(".a-GV-footer").outerHeight()||0},refresh:function(){this.view$.tableModelView(de)},resize:function(){this.view$.tableModelView(ce)},isConfigured:function(){return!0}};sn(e.extend({},un,{title:Ci("ICON"),internalIdentifier:ve,cssClass:"a-IG-iconView",icon:"icon-ig-icons",supports:{sort:!0},viewConfig:function(t,i){var n,o=t.igConfig,a=o.views.icon.features,l=!1,r=o.views.icon;return i=e.extend(!0,{iconListOptions:{}},o.defaultIconViewOptions,i),r.customIcon?(r.customIcon.trim().toLowerCase().match(/\s*<li/)?i.recordTemplate=r.customIcon:i.recordTemplate="<li>"+r.customIcon+"</li>",r.customIcon.toLowerCase().indexOf("href=")>=0&&(l=!0)):(i.labelColumn=r.labelColumn,r.iconClassColumn&&(i.iconClassColumn=r.iconClassColumn),r.imageURLColumn&&(i.imageURLColumn=r.imageURLColumn),r.imageAttributes&&(i.imageAttributes=r.imageAttributes),r.linkAttributes&&(i.linkAttributes=r.linkAttributes),r.linkTarget&&(i.linkTarget=!0,l=!0),i.linkTargetColumn&&(l=!0)),i.useIconList=!0,n=i.iconListOptions,l&&void 0===n.navigation&&(n.navigation=!0),a.rowSelector&&void 0===n.multiple&&void 0===n.itemSelector&&(n.multiple=a.rowSelector.multiSelect,n.navigation?n.itemSelector=!1:n.itemSelector=!a.rowSelector.hideControl),i.iconListOptions.contextMenu&&!mi(i.iconListOptions.contextMenu,"actionsContext")&&(i.iconListOptions.contextMenu.actionsContext=t.ig.actions),i},focus:function(){this.view$.tableModelView("focus")},getContextRecord:function(t){var i;return this.view$.tableModelView("option").useIconList&&(i=e(t).closest(".a-IconList-item")).length?this.view$.tableModelView("getRecords",i):[]},canCopy2Clipboard:function(){var e=this.view$.tableModelView("option","iconListOptions");return void 0===e.allowCopy||e.allowCopy}})),sn(e.extend({},cn,{title:Ci("GRID"),internalIdentifier:Ie,cssClass:"a-IG-gridView",icon:"icon-ig-report",supports:{cellSelection:!0,edit:!0,highlight:!0,controlBreak:!0,aggregation:!0,singleRowView:!0,configurableColumns:!0,download:!0},gotoCell:function(e,t){return this.singleRowMode?this.curInst.gotoField(e,t):this.curInst.gotoCell(e,t)},lockActive:function(){this.curInst.lockActive()},unlockActive:function(){this.curInst.unlockActive()}})),sn(e.extend({},un,{title:Ci("DETAIL"),internalIdentifier:"detail",cssClass:"a-IG-detailView",icon:"icon-ig-details",supports:{selection:!1,sort:!0},viewConfig:function(t,i){var n=t.igConfig,o=n.views.detail;return i.beforeTemplate=o.beforeRows,i.recordTemplate=o.row,i.afterTemplate=o.afterRows,i.useIconList=!1,(i=e.extend(!0,{},n.defaultDetailViewOptions,i)).fixedRowHeight=Ii(i.fixedRowHeight,n.appearance.useFixedRowHeight),i},focus:function(){this.view$.find(":focusable").first().trigger("focus")}})),sn({title:Ci("CHART"),internalIdentifier:be,cssClass:"a-IG-chartView",icon:"icon-ig-chart",supports:{totalRows:!1,selection:!1,sort:!1,changeRowsPerPage:!1},initDialog:function(t){var i,n,a,l=[],r=[],s=[],d=[],c=Ci(di),u=t.options.config.columns;for(r.push({value:"",label:c}),s.push({value:"",label:c}),d.push({value:"",label:c}),n=0;n<u.length;n++)(i=u[n]).specialType||i.isHidden||(a||(a=i),i.features.sort&&r.push({value:i.id,label:t._getColumnLabel(i.id)}),i.dataType===xt&&s.push({value:i.id,label:t._getColumnLabel(i.id)}),i.dataType!==xt&&i.dataType!==Ht||d.push({value:i.id,label:t._getColumnLabel(i.id)}));[{value:"",label:Ci(di)},{value:pi.CNT,label:Ci(pi.CNT)},{value:pi.CNT_DIST,label:Ci(pi.CNT_DIST)},{value:pi.APPR_CNT_DIST,label:Ci(pi.APPR_CNT_DIST)},{value:pi.MIN,label:Ci(pi.MIN)},{value:pi.MAX,label:Ci(pi.MAX)},{value:pi.SUM,label:Ci(pi.SUM)},{value:pi.AVG,label:Ci(pi.AVG)}].forEach((function(e){t.options.config.unsupported.chartFunctions.includes(e.value)||l.push(e)})),this.dialog$=t._createDialog("chart",(function(e){e(ie,{id:"CH_TYPE",iconOnly:!1,options:[{value:Bt,label:Ci("AREA"),iconCssClasses:"icon-region-chart-area"},{value:qt,label:Ci("BAR"),iconCssClasses:"icon-region-chart-bar"},{value:Xt,label:Ci("BUBBLE"),iconCssClasses:"icon-region-chart-bubble"},{value:$t,label:Ci("DONUT"),iconCssClasses:"icon-region-chart-donut"},{value:Wt,label:Ci("FUNNEL"),iconCssClasses:"icon-region-chart-funnel"},{value:Kt,label:Ci("LINE"),iconCssClasses:"icon-region-chart-line"},{value:Yt,label:Ci("LINE_WITH_AREA"),iconCssClasses:"icon-region-chart-line-area"},{value:zt,label:Ci("PIE"),iconCssClasses:"icon-region-chart-pie"},{value:jt,label:Ci("POLAR"),iconCssClasses:"icon-region-chart-polar"},{value:Zt,label:Ci("RADAR"),iconCssClasses:"icon-region-chart-radar"},{value:Qt,label:Ci("RANGE"),iconCssClasses:"icon-region-chart-range-bar"},{value:Jt,label:Ci("SCATTER"),iconCssClasses:"icon-region-chart-scatter"},{value:ei,label:Ci("STOCK"),iconCssClasses:"icon-region-chart-stock"}]}),e(Q,{id:"CH_ORIENTATION",options:[{value:ti,label:Ci("VERTICAL")},{value:"horizontal",label:Ci("HORIZONTAL")}]}),e(Q,{id:"CH_LABEL_COLUMN",options:r}),e(Q,{id:"CH_VALUE_COLUMN",options:s}),e(Q,{id:"CH_VALUE_FUNCTION",options:l}),e(Q,{id:"CH_X_COLUMN",options:d}),e(Q,{id:"CH_X_FUNCTION",options:l}),e(Q,{id:"CH_Y_COLUMN",options:s}),e(Q,{id:"CH_Y_FUNCTION",options:l}),e(Q,{id:"CH_Z_COLUMN",options:s}),e(Q,{id:"CH_Z_FUNCTION",options:l}),e(Q,{id:"CH_OPEN_COLUMN",options:s}),e(Q,{id:"CH_OPEN_FUNCTION",options:l}),e(Q,{id:"CH_CLOSE_COLUMN",options:s}),e(Q,{id:"CH_CLOSE_FUNCTION",options:l}),e(Q,{id:"CH_HIGH_COLUMN",options:s}),e(Q,{id:"CH_HIGH_FUNCTION",options:l}),e(Q,{id:"CH_LOW_COLUMN",options:s}),e(Q,{id:"CH_LOW_FUNCTION",options:l}),e(Q,{id:"CH_VOLUME_COLUMN",options:s}),e(Q,{id:"CH_VOLUME_FUNCTION",options:l}),e(Q,{id:"CH_TARGET_COLUMN",options:s}),e(Q,{id:"CH_TARGET_FUNCTION",options:l}),e(Q,{id:"CH_SERIES_COLUMN",options:r}),e(Q,{id:"CH_STACK",options:[{value:ni,label:Ci("OFF")},{value:ii,label:Ci("ON")}]}),e(Q,{id:"CH_SORT_BY",options:[]}),t._renderSortControls(e,"CH_SORT_"),e(Z,{id:"CH_AXIS_LABEL_TITLE",maxChars:255}),e(Z,{id:"CH_AXIS_VALUE_TITLE",maxChars:255}),e(Z,{id:"CH_AXIS_VALUE_DECIMAL"})}),{viewDialog:!0,width:750,height:450,titleKey:"CHART",modelOptions:{fields:{id:{canHide:!1,hidden:!0,seq:0},type:{label:"TYPE",elementId:"CH_TYPE",seq:10,defaultValue:qt},orientationId:{label:"ORIENTATION",elementId:"CH_ORIENTATION",seq:20,fieldColSpan:7,defaultValue:ti},labelColumnId:{label:"LABEL_COLUMN",elementId:"CH_LABEL_COLUMN",seq:30,fieldColSpan:7,defaultValue:""},valueColumnId:{label:"VALUE_COLUMN",elementId:"CH_VALUE_COLUMN",seq:40,fieldColSpan:7,defaultValue:""},valueFunctionId:{label:"AGGREGATION",elementId:"CH_VALUE_FUNCTION",seq:45,fieldColSpan:5,defaultValue:""},xColumnId:{label:"X_COLUMN",elementId:"CH_X_COLUMN",seq:50,fieldColSpan:7,defaultValue:""},xFunctionId:{label:"AGGREGATION",elementId:"CH_X_FUNCTION",seq:55,fieldColSpan:5,defaultValue:""},yColumnId:{label:"Y_COLUMN",elementId:"CH_Y_COLUMN",seq:60,fieldColSpan:7,defaultValue:""},yFunctionId:{label:"AGGREGATION",elementId:"CH_Y_FUNCTION",seq:65,fieldColSpan:5,defaultValue:""},openColumnId:{label:"OPEN_COLUMN",elementId:"CH_OPEN_COLUMN",seq:70,fieldColSpan:7,defaultValue:""},openFunctionId:{label:"AGGREGATION",elementId:"CH_OPEN_FUNCTION",seq:75,fieldColSpan:5,defaultValue:""},closeColumnId:{label:"CLOSE_COLUMN",elementId:"CH_CLOSE_COLUMN",seq:80,fieldColSpan:7,defaultValue:""},closeFunctionId:{label:"AGGREGATION",elementId:"CH_CLOSE_FUNCTION",seq:85,fieldColSpan:5,defaultValue:""},highColumnId:{label:"HIGH_COLUMN",elementId:"CH_HIGH_COLUMN",seq:90,fieldColSpan:7,defaultValue:""},highFunctionId:{label:"AGGREGATION",elementId:"CH_HIGH_FUNCTION",seq:95,fieldColSpan:5,defaultValue:""},lowColumnId:{label:"LOW_COLUMN",elementId:"CH_LOW_COLUMN",seq:100,fieldColSpan:7,defaultValue:""},lowFunctionId:{label:"AGGREGATION",elementId:"CH_LOW_FUNCTION",seq:105,fieldColSpan:5,defaultValue:""},volumeColumnId:{label:"VOLUME_COLUMN",elementId:"CH_VOLUME_COLUMN",seq:110,fieldColSpan:7,defaultValue:""},volumeFunctionId:{label:"AGGREGATION",elementId:"CH_VOLUME_FUNCTION",seq:115,fieldColSpan:5,defaultValue:""},targetColumnId:{label:"TARGET_COLUMN",elementId:"CH_TARGET_COLUMN",seq:120,fieldColSpan:7,defaultValue:""},targetFunctionId:{label:"AGGREGATION",elementId:"CH_TARGET_FUNCTION",seq:125,fieldColSpan:5,defaultValue:""},zColumnId:{label:"Z_COLUMN",elementId:"CH_Z_COLUMN",seq:130,fieldColSpan:7,defaultValue:""},zFunctionId:{label:"AGGREGATION",elementId:"CH_Z_FUNCTION",seq:135,fieldColSpan:5,defaultValue:""},seriesColumnId:{label:"SERIES_COLUMN",elementId:"CH_SERIES_COLUMN",seq:140,fieldColSpan:7,defaultValue:""},stackId:{label:"STACK",elementId:"CH_STACK",seq:143,fieldColSpan:5,defaultValue:ni},sortBy:{label:"SORT_BY",elementId:"CH_SORT_BY",seq:145,fieldColSpan:7,defaultValue:Ci("LABEL_COLUMN")},sortDirection:{label:"DIRECTION",elementId:"CH_SORT_DIRECTION",seq:147,fieldColSpan:3,defaultValue:Ge},sortNulls:{label:"NULLS",elementId:"CH_SORT_NULLS",seq:149,fieldColSpan:2,defaultValue:Pe},axisLabelTitle:{label:"AXIS_LABEL_TITLE",elementId:"CH_AXIS_LABEL_TITLE",seq:150,fieldColSpan:7},axisValueTitle:{label:"AXIS_VALUE_TITLE",elementId:"CH_AXIS_VALUE_TITLE",seq:170,fieldColSpan:7},axisValueDecimal:{label:"AXIS_VALUE_DECIMAL",elementId:"CH_AXIS_VALUE_DECIMAL",seq:180,fieldColSpan:3}}},init:function(i,n,o){var a,l,r={},s=t._getElement("CH_TYPE"),d=t._getElement("CH_ORIENTATION"),c=t._getElement("CH_LABEL_COLUMN"),u=t._getElement("CH_VALUE_COLUMN"),h=t._getElement("CH_X_COLUMN"),g=t._getElement("CH_Y_COLUMN"),p=t._getElement("CH_Z_COLUMN"),m=t._getElement("CH_OPEN_COLUMN"),f=t._getElement("CH_CLOSE_COLUMN"),_=t._getElement("CH_HIGH_COLUMN"),C=t._getElement("CH_LOW_COLUMN"),I=t._getElement("CH_VOLUME_COLUMN"),v=t._getElement("CH_TARGET_COLUMN"),b=t._getElement("CH_SERIES_COLUMN"),E=t._getElement("CH_STACK"),w=t._getElement("CH_AXIS_LABEL_TITLE"),A=t._getElement("CH_AXIS_VALUE_TITLE"),R=t._getElement("CH_AXIS_VALUE_DECIMAL"),S=t._getElement("CH_VALUE_FUNCTION"),T=t._getElement("CH_X_FUNCTION"),N=t._getElement("CH_Y_FUNCTION"),y=t._getElement("CH_Z_FUNCTION"),L=t._getElement("CH_OPEN_FUNCTION"),O=t._getElement("CH_CLOSE_FUNCTION"),V=t._getElement("CH_HIGH_FUNCTION"),D=t._getElement("CH_LOW_FUNCTION"),k=t._getElement("CH_VOLUME_FUNCTION"),M=t._getElement("CH_TARGET_FUNCTION"),x=t._getElement("CH_SORT_BY"),H=t._getElement("CH_SORT_DIRECTION"),G=t._getElement("CH_SORT_NULLS"),F=x.val();function P(){for(const[t,i]of Object.entries(r))x.append(e(Y).attr("value",t).text(i))}function U(){const e=s.val();switch(nn([d,c,u,h,g,p,m,f,_,C,I,v,b,E,w,A,R,S,T,N,y,L,O,V,D,k,M,x,H,G]),function(){var e=o.recordView("getRecord");function t(t,n){i.setValue(e,t,n)}t("sortBy",x.val()),t("sortDirection",H.val()),t("sortNulls",G.val()),t("orientationId",d.val()),t("stackId",E.val())}(),a=[d,c,u,b,E,S,w,A,R,x,H,G],l=[c,u,S,x,H,G],e){case Bt:tn(a),on([c,u],!0),on([h,g,p,m,f,_,C],!1),x.empty(),(r={})[Ei]=Ci("LABEL_COLUMN"),r[wi]=Ci("VALUE_COLUMN"),P();break;case qt:tn([d,c,u,p,b,E,S,y,w,A,R,x,H,G]),on([c,u],!0),on([h,g,p,m,f,_,C],!1),F=x.val(),x.empty(),(r={})[Ei]=Ci("LABEL_COLUMN"),r[wi]=Ci("VALUE_COLUMN"),r[Si]=Ci("Z_COLUMN"),P(),null===F&&""===F||x.val(F);break;case Xt:tn([c,h,g,p,T,N,y,w,A,R,x,H,G]),on([c,h,g,p],!0),on([u,m,f,_,C],!1),F=x.val(),x.empty(),(r={})[Ei]=Ci("LABEL_COLUMN"),r[Ai]=Ci("X_COLUMN"),r[Ri]=Ci("Y_COLUMN"),r[Si]=Ci("Z_COLUMN"),P(),null===F&&""===F||x.val(F);break;case $t:tn([c,u,S,x,H,G,R]),on([c,u],!0),on([h,g,p,m,f,_,C],!1),F=x.val(),x.empty(),(r={})[Ei]=Ci("LABEL_COLUMN"),r[wi]=Ci("VALUE_COLUMN"),P(),null===F&&""===F||x.val(F);break;case Wt:tn([d,c,u,v,S,M,x,H,G]),on([c,u],!0),on([h,g,p,m,f,_,C],!1),F=x.val(),x.empty(),(r={})[Ei]=Ci("LABEL_COLUMN"),r[wi]=Ci("VALUE_COLUMN"),r[Ti]=Ci("TARGET_COLUMN"),P(),null===F&&""===F||x.val(F);break;case Kt:case Yt:tn(a),on([c,u],!0),on([h,g,p,m,f,_,C],!1),F=x.val(),x.empty(),(r={})[Ei]=Ci("LABEL_COLUMN"),r[wi]=Ci("VALUE_COLUMN"),P(),null===F&&""===F||x.val(F);break;case zt:tn([c,u,S,R,x,H,G]),on([c,u],!0),on([h,g,p,m,f,_,C],!1);break;case jt:case Zt:tn(l),on([c,u],!0),on([h,g,p,m,f,_,C],!1),F=x.val(),x.empty(),(r={})[Ei]=Ci("LABEL_COLUMN"),r[wi]=Ci("VALUE_COLUMN"),P(),null===F&&""===F||x.val(F);break;case Qt:tn([d,c,_,C,p,b,V,D,y,w,A,R,x,H,G]),on([_,C],!0),on([c,u,h,g,p,m,f],!1),F=x.val(),x.empty(),(r={})[Ei]=Ci("LABEL_COLUMN"),r[Ni]=Ci("HIGH_COLUMN"),r[yi]=Ci("LOW_COLUMN"),r[Si]=Ci("Z_COLUMN"),P(),null===F&&""===F||x.val(F);break;case ei:tn([c,m,f,_,C,I,L,O,V,D,k]),on([c,m,f,_,C],!0),on([u,h,g,p],!1);break;case Jt:tn([c,h,g,b,T,N,w,A,R,x,H,G]),on([c,h,g],!0),on([u,p,m,f,_,C],!1),F=x.val(),x.empty(),(r={})[Ei]=Ci("LABEL_COLUMN"),r[Ai]=Ci("X_COLUMN"),r[Ri]=Ci("Y_COLUMN"),P(),null===F&&""===F||x.val(F)}}s.on(ki,U),o.on("apexbeginrecordedit",(function(){var e=s.val();zi(t._getId("CH_TYPE"),e),U()}))},load:function(i){var n,o,a=e.extend({},t.getChart());for(n in a.axis&&(a.axis.label&&(a.axisLabelTitle=a.axis.label),a.axis.value&&(a.axisValueTitle=a.axis.value),a.axis.valueDecimalPlaces&&(a.axisValueDecimal=a.axis.valueDecimalPlaces),delete a.axis),a.stackId=a.stack,delete a.stack,a.orientationId=a.orientation,delete a.orientation,a.chartColumns)if(mi(a.chartColumns,n))switch(o=a.chartColumns[n],n){case"LABEL":a.type in{bar:1,bubble:1,area:1,funnel:1,pie:1,donut:1,polar:1,radar:1,line:1,lineWithArea:1,range:1,stock:1,scatter:1}&&(a.labelColumnId=o.columnId,o.sort&&(a.sortBy="LABEL",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls));break;case"VALUE":a.valueColumnId=o.columnId,o.function&&(a.valueFunctionId=o.function),o.sort&&(a.sortBy="VALUE",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"X":a.xColumnId=o.columnId,o.function&&(a.xFunctionId=o.function),o.sort&&(a.sortBy="X",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"Y":a.yColumnId=o.columnId,o.function&&(a.yFunctionId=o.function),o.sort&&(a.sortBy="Y",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"Z":a.zColumnId=o.columnId,o.function&&(a.zFunctionId=o.function),o.sort&&(a.sortBy="Z",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"OPEN":a.openColumnId=o.columnId,o.function&&(a.openFunctionId=o.function);break;case"CLOSE":a.closeColumnId=o.columnId,o.function&&(a.closeFunctionId=o.function);break;case"HIGH":a.highColumnId=o.columnId,o.function&&(a.highFunctionId=o.function),o.sort&&(a.sortBy="HIGH",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"LOW":a.lowColumnId=o.columnId,o.function&&(a.lowFunctionId=o.function),o.sort&&(a.sortBy="LOW",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"VOLUME":a.volumeColumnId=o.columnId,o.function&&(a.volumeFunctionId=o.function);break;case"TARGET":a.targetColumnId=o.columnId,o.function&&(a.targetFunctionId=o),o.sort&&(a.sortBy="TARGET",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"SERIES_NAME":a.seriesColumnId=o.columnId}delete a.chartColumns,i.setData(a)},validate:function(e,t,i){var n,a=!0,l=e.getRecord();return l.sortBy&&(n=l.sortBy.toLowerCase()+"ColumnId",mi(l,n)?t(l.sortBy,"sortBy"):(i(l.sortBy,"sortBy",o.formatMessage("APEX.IG.INVALID_SORT_BY",l.sortBy)),a=!1)),a},store:function(i){var n,o,a,l,r,s,d,c,u,h,g,p,m=e.extend({},i.getRecord());m.axis={},m.axis={label:m.axisLabelTitle,value:m.axisValueTitle,valueDecimalPlaces:m.axisValueDecimal},delete m.axisLabelTitle,delete m.axisValueTitle,delete m.axisValueDecimal,m.stack=m.stackId,m.orientation=m.orientationId,m.chartColumns={},m.type in{bar:1,bubble:1,area:1,funnel:1,pie:1,donut:1,polar:1,radar:1,line:1,lineWithArea:1,range:1,stock:1,scatter:1}?m.labelColumnId&&(n={columnId:m.labelColumnId,columnType:oe},m.sortBy===Ei&&(n.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.chartColumns.LABEL=n):delete m.chartColumns.LABEL,m.type in{bar:1,area:1,funnel:1,pie:1,donut:1,polar:1,radar:1,line:1,lineWithArea:1}?m.valueColumnId&&(o={columnId:m.valueColumnId,columnType:oe},m.sortBy===wi&&(o.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.valueFunctionId&&(o.function=m.valueFunctionId),m.chartColumns.VALUE=o):delete m.chartColumns.VALUE,m.type in{bubble:1,scatter:1}?(m.xColumnId&&(a={columnId:m.xColumnId,columnType:oe},"X"===m.sortBy&&(a.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.xFunctionId&&(a.function=m.xFunctionId),m.chartColumns.X=a),m.yColumnId&&(l={columnId:m.yColumnId,columnType:oe},"Y"===m.sortBy&&(l.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.yFunctionId&&(l.function=m.yFunctionId),m.chartColumns.Y=l)):(delete m.chartColumns.X,delete m.chartColumns.Y),m.type in{bar:1,bubble:1}?m.zColumnId&&(r={columnId:m.zColumnId,columnType:oe},"Z"===m.sortBy&&(r.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.zFunctionId&&(r.function=m.zFunctionId),m.chartColumns.Z=r):delete m.chartColumns.Z,m.type===ei?(m.openColumnId&&(s={columnId:m.openColumnId,columnType:oe},m.openFunctionId&&(s.function=m.openFunctionId),m.chartColumns.OPEN=s),m.closeColumnId&&(d={columnId:m.closeColumnId,columnType:oe},m.closeFunctionId&&(d.function=m.closeFunctionId),m.chartColumns.CLOSE=d),m.volumeColumnId&&(h={columnId:m.volumeColumnId,columnType:oe},m.volumeFunctionId&&(h.function=m.volumeFunctionId),m.chartColumns.VOLUME=h)):(delete m.chartColumns.OPEN,delete m.chartColumns.CLOSE,delete m.chartColumns.VOLUME),m.type in{range:1,stock:1}?(m.highColumnId&&(c={columnId:m.highColumnId,columnType:oe},"HIGH"===m.sortBy&&(c.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.highFunctionId&&(c.function=m.highFunctionId),m.chartColumns.HIGH=c),m.lowColumnId&&(u={columnId:m.lowColumnId,columnType:oe},"LOW"===m.sortBy&&(u.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.lowFunctionId&&(u.function=m.lowFunctionId),m.chartColumns.LOW=u)):(delete m.chartColumns.HIGH,delete m.chartColumns.LOW),m.type===Wt?m.targetColumnId&&(g={columnId:m.targetColumnId,columnType:oe},"TARGET"===m.sortBy&&(g.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.targetFunctionId&&(g.function=m.targetFunctionId),m.chartColumns.TARGET=g):delete m.chartColumns.TARGET,m.seriesColumnId&&(p={columnId:m.seriesColumnId,columnType:oe},m.chartColumns.SERIES_NAME=p),delete m.sortBy,delete m.sortDirection,delete m.sortNulls,delete m.stackId,delete m.orientationId,delete m.xColumnId,delete m.xFunctionId,delete m.yFunctionId,delete m.yColumnId,delete m.valueColumnId,delete m.valueFunctionId,delete m.labelColumnId,delete m.zColumnId,delete m.zFunctionId,delete m.openColumnId,delete m.openFunctionId,delete m.closeColumnId,delete m.closeFunctionId,delete m.volumeColumnId,delete m.volumeFunctionId,delete m.highColumnId,delete m.highFunctionId,delete m.lowColumnId,delete m.lowFunctionId,delete m.targetColumnId,delete m.targetFunctionId,delete m.seriesColumnId,t.setChart(m)}})},setColumnConfig:function(t){var i,n,o,a,l,r={},s={},d=t.baseModelColumns,c=t.ig,u=t.igConfig,h=t.currentReportSettings.views.chart.chartColumns,g=["CLOSE","HIGH","LABEL","LOW","OPEN","SERIES_NAME","TARGET","VALUE","VOLUME","X","Y","Z"],p=0;for(l=0;l<g.length;l++)mi(h,o=g[l])&&((r=e.extend(!0,{},d[h[o].columnId])).seq=p,r.index=p,s[o]=r,p+=1);if(u.parentRegionStaticId)for(n in d)mi(d,n)&&(a=d[n]).parentField&&(i=c._getColumn(n),(r=e.extend(!0,{},a)).seq=p,r.virtual=!0,delete r.index,s[i.name]=r,p+=1);this.modelColumns=s,this.specialColumns={}},initView:function(t){var i,n,o,a,l,r,s,d,c,u,h=t.ig,g=this,p=h._currentReportSettings().views.chart,m=t.igConfig,f=[],_="disabled";require(["ojs/ojcore","ojs/ojchart","ojs/ojvalidation"],(function(t){function C(e){var i,n=t.ConverterFactory.CONVERTER_TYPE_NUMBER,o=h._getColumn(e);return o.filter.dataType===Ht||o.filter.dataType===Ft||o.filter.dataType===Pt||o.filter.dataType===Ut?(n=t.ConverterFactory.CONVERTER_TYPE_DATETIME,i=function(e){let t=e.appearance.formatMask;t?Oi.forEach((e=>{e.value===t&&(t=e.label)})):t={formatType:"date",dateFormat:"medium"};return t}(o)):o.filter.dataType===xt&&(i=function(e){let t,i=e.appearance.formatExample.trim();p.axis&&p.axis.valueDecimalPlaces&&(t=p.axis.valueDecimalPlaces);i?Li.forEach((e=>{e.value===i&&(i=e.label)})):i={style:"decimal",maximumFractionDigits:t||2};return i}(o)),i?t.Validation.converterFactory(n).createConverter(i):{}}switch(p.chartColumns.LABEL.columnId&&((l=h._getColumn(p.chartColumns.LABEL.columnId)).filter.dataType!==Ht&&l.filter.dataType!==Ft&&l.filter.dataType!==Pt&&l.filter.dataType!==Ut||(_="enabled")),n={legend:{rendered:oi,position:"end"},orientation:p.orientation,stack:p.stack,animationOnDisplay:oi,animationOnDataChange:oi,hoverBehavior:"dim",groups:[],series:[],valueFormats:[],timeAxisType:_,translations:{labelNoData:m.text.noDataFound}},p.type){case Bt:case qt:o=e.extend({},n,{type:p.type,legend:p.chartColumns.SERIES_NAME?{rendered:oi}:{rendered:ni},coordinateSystem:ai,valueFormats:[{type:Je,converter:C(p.chartColumns.LABEL.columnId)},{type:"y",converter:C(p.chartColumns.VALUE.columnId)}],xAxis:{},yAxis:{}});break;case Xt:o=e.extend({},n,{type:p.type,legend:{rendered:ni},coordinateSystem:ai,xAxis:{},yAxis:{}});break;case $t:o=e.extend({},n,{type:zt,styleDefaults:{pieInnerRadius:.5},legend:{rendered:oi},hideAndShowBehavior:"withRescale",valueFormats:[{type:Je,converter:C(p.chartColumns.LABEL.columnId)},{type:nt,converter:C(p.chartColumns.VALUE.columnId)}]});break;case zt:o=e.extend({},n,{type:p.type,styleDefaults:{pieInnerRadius:0},legend:{rendered:oi},hideAndShowBehavior:"withRescale",valueFormats:[{type:Je,converter:C(p.chartColumns.LABEL.columnId)},{type:nt,converter:C(p.chartColumns.VALUE.columnId)}]});break;case Wt:o=e.extend({},n,{type:p.type,legend:{rendered:oi},valueFormats:[{type:Je,converter:C(p.chartColumns.LABEL.columnId)},{type:nt,converter:C(p.chartColumns.VALUE.columnId)}]}),p.chartColumns.TARGET&&o.valueFormats.push({type:"target",converter:C(p.chartColumns.TARGET.columnId)});break;case Kt:case Yt:o=e.extend({},n,{type:p.type,legend:p.chartColumns.SERIES_NAME?{rendered:oi}:{rendered:ni},coordinateSystem:ai,valueFormats:[{type:Je,converter:C(p.chartColumns.LABEL.columnId)},{type:nt,converter:C(p.chartColumns.VALUE.columnId)}],xAxis:{},yAxis:{}});break;case jt:o=e.extend({},n,{type:qt,coordinateSystem:p.type,legend:{rendered:ni},valueFormats:[{type:Je,converter:C(p.chartColumns.LABEL.columnId)},{type:nt,converter:C(p.chartColumns.VALUE.columnId)}],polarGridShape:"circle",stack:ii});break;case Zt:o=e.extend({},n,{type:Bt,coordinateSystem:jt,legend:{rendered:ni},valueFormats:[{type:Je,converter:C(p.chartColumns.LABEL.columnId)},{type:nt,converter:C(p.chartColumns.VALUE.columnId)}],polarGridShape:"polygon",stack:ii});break;case Qt:o=e.extend({},n,{type:qt,legend:p.chartColumns.SERIES_NAME?{rendered:oi}:{rendered:ni},valueFormats:[{type:Je,converter:C(p.chartColumns.LABEL.columnId)},{type:"high",converter:C(p.chartColumns.HIGH.columnId)},{type:"low",converter:C(p.chartColumns.LOW.columnId)}],xAxis:{},yAxis:{}});break;case Jt:o=e.extend({},n,{type:p.type,legend:p.chartColumns.SERIES_NAME?{rendered:oi}:{rendered:ni},coordinateSystem:ai,valueFormats:[{type:Je,converter:C(p.chartColumns.LABEL.columnId)},{type:"x",converter:C(p.chartColumns.X.columnId)},{type:"y",converter:C(p.chartColumns.Y.columnId)}],xAxis:{},yAxis:{}});break;case ei:o=e.extend({},n,{type:p.type,zoomAndScroll:"delayed",initialZooming:"first",legend:{rendered:oi},dataCursor:ii,dataCursorBehavior:"smooth",valueFormats:[{type:Je,converter:C(p.chartColumns.LABEL.columnId)},{type:"high",converter:C(p.chartColumns.HIGH.columnId)},{type:"low",converter:C(p.chartColumns.LOW.columnId)},{type:"open",converter:C(p.chartColumns.OPEN.columnId)},{type:"close",converter:C(p.chartColumns.CLOSE.columnId)}],xAxis:{},yAxis:{}}),p.chartColumns.VOLUME&&o.valueFormats.push({type:"volume",converter:C(p.chartColumns.VOLUME.columnId)}),o.series.type="candlestick"}if(p.type in{area:1,bar:1,bubble:1,line:1,lineWithArea:1,range:1,stock:1,scatter:1}){switch(p.type){case ei:r=p.chartColumns.OPEN.columnId;break;case Qt:r=p.chartColumns.HIGH.columnId;break;case Jt:case Xt:r=p.chartColumns.X.columnId;break;default:r=p.chartColumns.VALUE.columnId}p.axis&&(p.axis.label&&(s=p.axis.label),p.axis.value&&(d=p.axis.value)),o.xAxis={title:s,baselineScaling:"zero",majorTick:{rendered:ii},minorTick:{rendered:ni},tickLabel:{rendered:ii,converter:C(p.chartColumns.LABEL.columnId),scaling:Ue},position:oi,rotation:ni},o.yAxis={title:d,baselineScaling:"zero",position:p.type===ei?"end":oi,majorTick:{rendered:ii},minorTick:{rendered:ni},tickLabel:{rendered:ii,converter:C(r),scaling:Ue}}}if(p.type in{bar:1,area:1,polar:1,radar:1,range:1,line:1,lineWithArea:1,bubble:1,scatter:1,stock:1}){switch(i={path:"groups",uniqueIndexField:"LABEL",item:{name:"LABEL"}},p.type){case Xt:a={name:"LABEL",x:"X",y:"Y",z:"Z",labelPosition:"'none'"};break;case Jt:a={name:"LABEL",x:"X",y:"Y",labelPosition:"'none'"};break;case ei:a={name:"LABEL",open:"OPEN",close:"CLOSE",high:"HIGH",low:"LOW",volume:"VOLUME"};break;case Qt:a={name:"LABEL",high:"HIGH",low:"LOW",labelPosition:"'none'"};break;default:a={label:"VALUE",value:"VALUE",name:"LABEL",labelPosition:"'none'"}}f=p.chartColumns.SERIES_NAME?[i,{path:"series",uniqueIndexField:"SERIES_NAME",item:{name:"SERIES_NAME",displayInLegend:ii}},{path:"series/[SERIES_NAME]/items",item:a}]:[i,{path:"series/0/items",item:a}]}if(p.type in{pie:1,donut:1,funnel:1}&&(c=g.model.getFieldKey("LABEL"),f=[{path:"series",uniqueIndexField:"LABEL",item:function(e,t){return{name:""+t[c],displayInLegend:ii}}},{path:"series/[LABEL]/items",item:{value:"VALUE",targetValue:"TARGET"}}]),p.chartColumns.VALUE){if(p.chartColumns.VALUE.sort)switch(p.chartColumns.VALUE.sort.direction){case"asc":u="ascending";break;case"desc":u="descending"}}else p.chartColumns.LABEL.sort?u="label-"+p.chartColumns.LABEL.sort.direction:(p.chartColumns.SERIES_NAME&&(u="label-asc"),u="off");o.sorting=u,g._dataTransformOptions={showNullAs:m.appearance.showNullValue,offset:0,template:f},g._chartOptions=o,g._updateChartData(),g.view$.ojChart(o).css({"max-width":"100%"}),g._subscribeModel(),(m.lazyLoad||g.model.getTotalRecords()<0)&&g.refresh()}))},_updateChartData:function(){var t;if(t=this.model.transform(this._dataTransformOptions,this._chartOptions),-1===e.inArray(t.type,["pie","funnel","scatter","bubble","stock","polar","radar"])&&t.series.length>1&&"mixedFrequency"!==t.timeAxisType&&"skipGaps"!==t.timeAxisType){u.chartSortArray(t.groups,t.sorting);for(var i=0;i<t.series.length;i++)u.chartFillGaps(t.groups,t.series[i].items,t.sorting,!0)}},_subscribeModel:function(){var e=this,t=this.view$;this._observedModel&&this._observedModel.unSubscribe(this._observerId),this._observedModel=this.model,this._observerId=this.model.subscribe({viewId:t[0].id,onChange:function(t){t===de&&e.refresh()},progressView:t})},refresh:function(){var e=this;if(this.view$.hasClass("oj-chart")){if(null===this.view$[0].offsetParent)return void(this._pendingRefresh=!0);this._pendingRefresh=!1,this.model.fetch(0,(function(t){t&&i.warn("No data fetched for chart"),e._updateChartData(),e.resize()}))}},resize:function(){if(this.view$.hasClass("oj-chart")){if(this._pendingRefresh)return void this.refresh();this.view$.ojChart(de)}},destroyView:function(){this.model&&this.model.unSubscribe(this.view$[0].id),this.view$.ojChart(se)},setModelName:function(){this._subscribeModel(),this.view$.hasClass("oj-chart")&&(this.model.getTotalRecords()<0?this.refresh():(this._updateChartData(),this.resize()))},setNoDataMessage:function(e){var t=this.view$;t.hasClass("oj-chart")&&t.ojChart(Ce,"translations.labelNoData",e)}})}(apex.jQuery,apex.util,apex.debug,apex.server,apex.lang,apex.actions,apex.region,apex.theme,apex.message,apex.item,apex.model,apex.widget.util,apex.locale,apex.navigation,apex.date);