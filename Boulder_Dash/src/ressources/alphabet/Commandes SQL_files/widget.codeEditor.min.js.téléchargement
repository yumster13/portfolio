!function(e,t,o,n,i,r,a,s){"use strict";const l=e=>o.getMessage("CODE_EDITOR."+e),d=function(){i.trace("Code Editor:",...arguments)},c=function(){i.warn("Code Editor:",...arguments)},u=function(){i.error("Code Editor:",...arguments)},g="is-active",m="sql",p="javascript",f="mle-javascript-snippet",h="mle-javascript-module",b="quicksql",_="file-urls-javascript",C="file-urls-css",E="javascript",S="isSql",y="dbHint",I=l("ACCESSIBILITY_MODE"),v=l("CLOSE"),N=l("FIND"),L=l("HINT"),T=l("INDENTATION"),k=l("INDENT_SIZE"),A=l("INDENT_WITH_TABS"),M=l("MINIMAP"),x=l("MINIMAP_CONDITIONAL"),O=l("QUERY_BUILDER"),P=l("REDO"),w=l("SETTINGS"),q=l("SHOW_LINE_NUMBERS"),R=l("SHOW_RULER"),D=l("SUGGESTIONS"),B=l("TAB_SIZE"),F=l("THEMES"),V=l("THEME_AUTOMATIC"),z=l("THEME_LIGHT"),H=l("THEME_DARK"),K=l("THEME_HIGH_CONTRAST_DARK"),U=l("TRANSFORM_CODE_CASE"),$=l("UNDO"),G=l("UTIL_OFF"),j=l("UTIL_ON"),W=l("VALIDATE"),J=l("VALIDATION_SUCCESS"),X=l("WHITESPACE"),Z=l("BRACKET_PAIR_COLORIZATION");let Q;const Y={THEME:"theme",TABS_INSERT_SPACES:"tabsInsertSpaces",INDENT_SIZE:"indentSize",TAB_SIZE:"tabSize",RULER:"ruler",MINIMAP:"minimap",ACCESSIBILITY_MODE:"accessibilityMode",LINE_NUMBERS:"lineNumbers",WHITESPACE:"whitespace",SHOW_SUGGESTIONS:"showSuggestions",BRACKET_PAIR_COLORIZATION:"bracketPairColorization"},ee=[{label:V,value:"automatic"},{label:z,value:"vs"},{label:H,value:"vs-dark"},{label:K,value:"hc-black"}],te="conditional",oe=[{label:j,value:"on"},{label:G,value:"off"},{label:x,value:te}],ne=[{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"8",value:"8"}],ie=[{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"8",value:"8"}],re=["/","."].includes(s.APEX_FILES[0])?document.location.protocol+"//"+document.location.host+("."===s.APEX_FILES[0]?"/":"")+s.APEX_FILES:s.APEX_FILES,ae=re+`libraries/monaco-editor/${apex.libVersions.monacoEditor}/min`,se=re+"libraries/monaco-editor/apex/custom-languages",le=re+"libraries/monaco-editor/apex/quicksql.js?v="+s.APEX_VERSION,de="minimap",ce={NATIVE_NUMBER_FIELD:"numberFieldItem",NATIVE_COLOR_PICKER:"colorPickerItem"},ue={NATIVE_FACETED_SEARCH:"facetsRegion",NATIVE_SMART_FILTERS:"facetsRegion",NATIVE_MAP_REGION:"mapRegion"},ge=(()=>{const e={GLOBAL:{}};return{existsGlobally:t=>void 0!==e.GLOBAL[t],registerGlobally:(t,o)=>{e.GLOBAL[t]=o},disposeGlobally:t=>{e.GLOBAL[t]&&(e.GLOBAL[t].dispose(),delete e.GLOBAL[t])},deregisterEditor:t=>{if(e[t]){for(let o of Object.keys(e[t]))e[t][o].dispose(),delete e[t][o];delete e[t]}},existsForEditor:(t,o)=>e[t]&&void 0!==e[t][o],registerForEditor:(t,o,n)=>{e[t]=e[t]||{},e[t][o]&&e[t][o].dispose(),e[t][o]=n},disposeForEditor:(t,o)=>{e[t]&&e[t][o]&&(e[t][o].dispose(),delete e[t][o])}}})(),me=(()=>{const e=(()=>{const e={};let t;const o=e=>{if(![p,f,h].includes(e))throw new Error("Only JavaScript and MLE JavaScript are supported")};return{setContext:(n,i,r)=>{o(r),e[n]||(e[n]={code:null,model:null,lang:r}),e[n].code=i,t===r&&(e[n].model?e[n].model.setValue(i):e[n].model=monaco.editor.createModel(i,E)),d("CONTEXT_MANAGER added context",n)},dropContext:t=>{e[t]&&(e[t].model&&(e[t].model.dispose(),e[t].model=null),e[t]=void 0),d("CONTEXT_MANAGER dropped context",t)},_reevaluate:n=>{o(n),t=n,Object.keys(e).forEach((o=>{const n=e[o];t!==n.lang?n.model&&(n.model.dispose(),n.model=null):n.model?n.model.setValue(n.code):n.model=monaco.editor.createModel(e[o].code,E)})),d("CONTEXT_MANAGER contexts reevaluated")}}})(),t="once",o="fresh";let n;const i={[p]:{contexts:[{key:"DTS_JS",contentPath:re+"libraries/monaco-editor/apex/types/browser/types.d.ts?v="+s.APEX_VERSION,load:t,isLoaded:!1},{key:"JS_EXTRAS",contentFunction:e=>e?`\n                        declare namespace apex {\n                            var items: {\n                                ${e.items.map((e=>`${JSON.stringify(e.name)}: ${ce[e.type]||"item"};`)).join("\n")}\n                            };\n                            var regions: {\n                                ${e.regions.map((e=>`${JSON.stringify(e.staticId)}: ${ue[e.type]||"region"};`)).join("\n")}\n                            };\n                        }`:null,load:o}]},[f]:{contexts:[{key:"DTS_JS_MLE_SNIPPET_21",contentPath:`${re}libraries/monaco-editor/apex/types/mle/${s.DB_VERSION}/types.d.ts?v=${s.APEX_VERSION}`,load:t,isLoaded:!1},{key:"DTS_JS_MLE_SNIPPET_1",condition:s.DB_VERSION>=23,contentPath:`${re}libraries/monaco-editor/apex/types/mle/${s.DB_VERSION}/types.d.ts?v=${s.APEX_VERSION}`,load:t,isLoaded:!1},{key:"DTS_JS_MLE_SNIPPET_2",condition:s.DB_VERSION>=23,content:'\n                        import { defaultConnection, default as oracledb } from "mle-js-oracledb";\n                        globalThis.apex = {\n                            db: oracledb,\n                            conn: oracledb.defaultConnection(),\n                            env: {}\n                        };\n                    ',load:t,isLoaded:!1}]},[h]:{contexts:[{key:"DTS_JS_MLE_MODULE",condition:s.DB_VERSION>=23,contentPath:`${re}libraries/monaco-editor/apex/types/mle/${s.DB_VERSION}/types.d.ts?v=${s.APEX_VERSION}`,load:t,isLoaded:!1}]}};return{reevaluate:(r,a)=>{i[r].contexts.forEach((n=>{(void 0===n.condition||n.condition)&&(n.load===t&&!n.isLoaded||n.load===o)&&((async()=>{let t;if(n.content)t=n.content;else if(n.contentPath){const e=await fetch(n.contentPath);if(!e.ok)return void u("Could not fetch file",e);t=await e.text()}else n.contentFunction&&(t=n.contentFunction(a));e.setContext(n.key,t,r)})(),n.load===t&&(n.isLoaded=!0))})),n!==r&&(n=r,monaco.languages.typescript.javascriptDefaults.setCompilerOptions({target:monaco.languages.typescript.ScriptTarget.Latest,allowJs:!0,allowNonTsExtensions:!0,noLib:[f,h].includes(r)}),monaco.languages.typescript.javascriptDefaults.setDiagnosticsOptions({diagnosticCodesToIgnore:[1003]}),e._reevaluate(r))},setContext:e.setContext,dropContext:e.dropContext}})();function pe(e,t){return new Promise((o=>{[p,f,h].includes(e)?(me.reevaluate(e,t.pageInfo),o()):e===b?monaco.languages.getEncodedLanguageId(b)?o():a.loadScript({path:le},o):o()}))}function fe(){monaco.languages.getLanguages().filter((e=>"sql"===e.id))[0].loader=()=>new Promise(((e,t)=>{require(["custom-languages/sql"],e,t)})),monaco.editor.defineTheme("apex-vs",{inherit:!0,base:"vs",rules:[{token:"string.sql",foreground:"b26100"},{token:"keyword.sql",foreground:"c74634"},{token:"predefined.sql",foreground:"7e5e8a"},{token:"operator.sql",foreground:"000000"},{token:"atom.sql",foreground:"398459"},{token:"function.sql",foreground:"795E26"},{token:"pageitem.sql",foreground:"008080",fontStyle:"bold"},{token:"table.quicksql",foreground:"1E84BF",fontStyle:"bold"},{token:"view.quicksql",foreground:"008855",fontStyle:"bold"},{token:"list.quicksql",foreground:"b26100"},{token:"keywords.quicksql",foreground:"c74634"},{token:"types.quicksql",foreground:"398459"}],colors:{"editorBracketHighlight.foreground1":"#0431FA","editorBracketHighlight.foreground2":"#008000","editorBracketHighlight.foreground3":"#7B3814"}}),monaco.editor.defineTheme("apex-vs-dark",{inherit:!0,base:"vs-dark",rules:[{token:"string.sql",foreground:"ecbb76"},{token:"keyword.sql",foreground:"f14840"},{token:"predefined.sql",foreground:"a687b3"},{token:"operator.sql",foreground:"D4D4D4"},{token:"atom.sql",foreground:"259856"},{token:"function.sql",foreground:"DCDCAA"},{token:"pageitem.sql",foreground:"3dc9b0",fontStyle:"bold"},{token:"table.quicksql",foreground:"1E84BF",fontStyle:"bold"},{token:"view.quicksql",foreground:"259856",fontStyle:"bold"},{token:"list.quicksql",foreground:"ecbb76"},{token:"keywords.quicksql",foreground:"f14840"},{token:"types.quicksql",foreground:"A3CDFF"}],colors:{"editorBracketHighlight.foreground1":"#ffd700","editorBracketHighlight.foreground2":"#da70d6","editorBracketHighlight.foreground3":"#179fff"}}),monaco.editor.defineTheme("apex-hc-black",{inherit:!0,base:"hc-black",rules:[{token:"string.sql",foreground:"ecbb76"},{token:"keyword.sql",foreground:"f14840"},{token:"predefined.sql",foreground:"a687b3"},{token:"operator.sql",foreground:"D4D4D4"},{token:"atom.sql",foreground:"259856"},{token:"function.sql",foreground:"DCDCAA"},{token:"pageitem.sql",foreground:"3dc9b0",fontStyle:"bold"},{token:"table.quicksql",foreground:"1E84BF",fontStyle:"bold"},{token:"view.quicksql",foreground:"259856",fontStyle:"bold"},{token:"list.quicksql",foreground:"ecbb76"},{token:"keywords.quicksql",foreground:"f14840"},{token:"types.quicksql",foreground:"259856"}],colors:{"editorBracketHighlight.foreground1":"#ffd700","editorBracketHighlight.foreground2":"#da70d6","editorBracketHighlight.foreground3":"#87cefa"}}),[_,C].forEach((e=>{monaco.languages.register({id:e}),monaco.languages.setLanguageConfiguration(e,{comments:{lineComment:"--",blockComment:["/*","*/"]},brackets:[["[","]"]]}),monaco.languages.setMonarchTokensProvider(e,{tokenizer:{root:[{include:"@whitespace"},[/^\[.+?\]/,"variable"]],whitespace:[[/\/\*/,"comment","@comment"],[/^--.*$/,"comment"],[/#(MIN|MIN_DIRECTORY)#/,"string"],[/#(APEX|APP|WORKSPACE|PLUGIN|THEME|THEME_DB)_FILES#/,"string"],[/#APP_VERSION#/,"string"]],comment:[[/[^\/\*]+/,"comment"],[/\*\//,"comment","@pop"],[/[\/\*]/,"comment"]]}}),monaco.languages.registerCompletionItemProvider(e,{triggerCharacters:["#"],provideCompletionItems:function(e,t,o){if("#"===o.triggerCharacter){const o=e.getWordUntilPosition(t);return{suggestions:["#MIN#","#MIN_DIRECTORY#","#APEX_FILES#","#APP_FILES#","#WORKSPACE_FILES#","#PLUGIN_FILES#","#THEME_FILES#","#THEME_DB_FILES#","#APP_VERSION#"].map((e=>({label:e,insertText:e,kind:monaco.languages.CompletionItemKind.Keyword,range:{startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:o.startColumn-1,endColumn:o.endColumn}})))}}}}),monaco.languages.registerCompletionItemProvider(e,{triggerCharacters:["[",","," "],provideCompletionItems:function(t,o){const n=t.getLineContent(o.lineNumber),i=t.getWordUntilPosition(o);if(n.slice(0,o.column-1).startsWith("[")&&n.slice(o.column-1).includes("]")){if(e===_){let e=[];const t=n.match(/^\[(.*)\].*/);return t&&(e=t[1].split(",").map((e=>e.trim()))),{suggestions:[{label:"module",insertText:"module"},{label:"async",insertText:"async"},{label:"defer",insertText:"defer"},{label:"require requirejs",insertText:"require requirejs"},{label:"require jet",insertText:"require jet"},{label:"define",insertText:"define ${1:moduleName}=${2:globalObject}"}].filter((t=>!e.includes(t.label))).map((e=>({label:e.label,insertText:e.insertText,kind:monaco.languages.CompletionItemKind.Keyword,insertTextRules:e.insertText.includes("${")?monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet:void 0,range:{startLineNumber:o.lineNumber,endLineNumber:o.lineNumber,startColumn:i.startColumn,endColumn:i.endColumn}})))}}return e===C?{suggestions:[{label:"media",insertText:'media="${1}"',kind:monaco.languages.CompletionItemKind.Keyword,insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,range:{startLineNumber:o.lineNumber,endLineNumber:o.lineNumber,startColumn:i.startColumn,endColumn:i.endColumn}}]}:void 0}}})}))}const he=new Promise((e=>{new Promise((e=>{void 0===window.require?a.loadScript({path:ae+"/vs/loader.js"},e):e()})).then((()=>{!function(){window.MonacoEnvironment={getWorkerUrl:function(){return"data:text/javascript;charset=utf-8,"+encodeURIComponent(`\n                    self.MonacoEnvironment = {\n                        baseUrl: "${ae}"\n                    };\n                    importScripts("${ae}/vs/base/worker/workerMain.js");\n                `)}},require.config({paths:{vs:ae+"/vs","custom-languages":se},waitSeconds:0});let e,t=n.getLanguage().toLowerCase();["zh-tw","zh-cn"].includes(t)?e=t:(t=t.split("-")[0],["de","es","fr","it","ja","ko","ru"].includes(t)&&(e=t)),e&&require.config({"vs/nls":{availableLanguages:{"*":e}}})}(),require(["vs/editor/editor.main"],(()=>{fe(),e()}))}))}));function be(){return apex.builder?apex.builder.isBuilderDarkMode()?"vs-dark":"vs":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"vs-dark":"vs"}function _e(e){let t;Q=e,"automatic"===e?t=be():["vs","vs-dark","hc-black"].includes(e)?t=e:(t=be(),d(e+" is not a valid Monaco theme. Using automatic instead.")),he.then((()=>{monaco.editor.setTheme("apex-"+t)}))}function Ce(){return/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)?monaco.KeyMod.WinCtrl:monaco.KeyMod.CtrlCmd}function Ee(e){if(!e)return e;function t(t,o){let i,r,a,s="";for(i=0;i<n.length;i++)r=n[i],a=e.slice(r.start,r.end+1),s+=r.ignore?a:o(a);return s}let o=function(e){let t=[],o=e.matchAll(/('|")[\s\S]*?(\1)/gm);for(let e of o)t.push({start:e.index,end:e.index+e[0].length,ignore:!0});return t}(e),n=function(e,t){let o=[],n=0;function i(e,t,n){o.push({start:e,end:t,ignore:n})}if(0===e.length)i(0,t,!1);else{for(let t=0;t<e.length;t++){let o=e[t];n<o.start&&i(n,o.start-1,!1),i(o.start,o.end,!0),n=o.end+1}n<t-1&&i(n,t,!1)}return o}(o,e.length-1),i=t(0,(function(e){return e.toLocaleLowerCase()}));return e!==i?i:t(0,(function(e){return e.toLocaleUpperCase()}))}apex.builder?e("body").on("apex-builder-theme-changed",(()=>{"automatic"===Q&&_e("automatic")})):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addListener((()=>{"automatic"===Q&&_e("automatic")}));const Se=e=>[p,f,h].includes(e)?E:e,ye=(()=>{let t;const o=()=>["font-family","font-size","line-height","word-spacing","letter-spacing"].map((t=>e("body").css(t))).join("-");return t=o(),()=>{const e=o();t!==e&&(t=e,d("New font values detected. Remeasuring Monaco fonts."),monaco.editor.remeasureFonts())}})();e.widget("apex.codeEditor",{version:"22.2",widgetEventPrefix:"codeEditor",options:{language:E,value:"",readOnly:!1,autofocus:!1,ariaLabel:"",errors:[],warnings:[],suggestions:null,pageInfo:{pageId:null,items:[],regions:[]},showSuggestions:!0,validatePageItems:!1,accessibilityMode:!1,minimap:te,lineNumbers:!0,wordWrap:!1,scrollBeyondLastLine:!0,wordBasedSuggestions:!1,toolbar:!0,whitespace:!1,theme:"automatic",tabsInsertSpaces:!0,indentSize:"4",tabSize:"4",ruler:!1,bracketPairColorization:!1,onInitialized:null,codeComplete:null,validateCode:null,queryBuilder:null,heightFn:null,preferencesChanged:null,lazyLoad:!1},_contextKeys:{},_create:function(){const o=this,n=this.options,i=e(o.element[0]).addClass("a-MonacoEditor"),a=Se(n.language);i.append(e(`\n                <div class="a-MonacoEditorContent">\n                    <div class="a-MonacoEditor-toolbar"></div>\n                    <div class="a-MonacoEditor-notification" style="display:none;">\n                        <div class="a-MonacoEditor-message"></div>\n                        <button title="${v}" aria-label="${v}" class="a-Button a-Button--noLabel a-Button--withIcon a-Button--small a-CodeEditor-searchBar-closeButton" type="button">\n                            <span class="a-Icon ui-icon-closethick" aria-hidden="true"></span>\n                        </button>\n                    </div>\n                    <div class="a-MonacoEditor-editor"></div>\n                </div>\n            `)),o.baseId=o.element[0].id,o._editor$=i,o._toolbar$=i.find(".a-MonacoEditor-toolbar"),o._notification$=i.find(".a-MonacoEditor-notification"),o._monacoEditor$=i.find(".a-MonacoEditor-editor").first(),(async()=>{n.lazyLoad&&(d("Loading halted",i),await new Promise((e=>{i.one("load-resume",(()=>{d("Loading resumed",i),e()}))}))),await he,await pe(o.options.language,o.options),n.toolbar&&(o._context=r.createContext("codeEditor",this.element[0]),o._initToolbar(o._toolbar$)),o._notification$.find("button").on("click",(()=>{o.resetNotification()})),_e(n.theme);const e={readOnly:n.readOnly,detectIndentation:!1,insertSpaces:n.tabsInsertSpaces,indentSize:n.indentSize,tabSize:n.tabSize,rulers:n.ruler?[80]:[],scrollBeyondLastLine:n.scrollBeyondLastLine,lineNumbers:n.lineNumbers,lineNumbersMinChars:4,scrollbar:{alwaysConsumeMouseWheel:!1},fixedOverflowWidgets:!0,ariaLabel:n.ariaLabel,wordWrap:"plaintext"===n.language||(n.wordWrap?"on":"off"),wordBasedSuggestions:n.wordBasedSuggestions,quickSuggestions:n.showSuggestions,accessibilitySupport:n.accessibilityMode?"on":"off",renderWhitespace:n.whitespace?"all":"none",copyWithSyntaxHighlighting:!1,"bracketPairColorization.enabled":n.bracketPairColorization,useTabStops:n.language!==m,mouseWheelZoom:!0,suggest:a===E?{showFiles:!1}:void 0},s=monaco.editor.createModel(n.value,a),l=monaco.editor.create(o._monacoEditor$[0],e);let c;l.setModel(s),o._model=s,o._modelId=s.id,o._editor=l,o._editorId=l.getId(),l.onDidDispose((()=>{o._disposeAllDisposables(),s.dispose()})),o._evaluateContextKeys(n.language),n.toolbar&&(o._updateNotifications(),o._populateContext()),window.addEventListener("resize",t.debounce((()=>{o.resize()}),200)),i.on("resize",(function(e){o.resize(),e.stopPropagation()})),n.autofocus&&o.focus(),l.onKeyDown((e=>{o.element.children("textarea").trigger("keypress",e)})),l.onDidFocusEditorWidget((function(){c=s.getValue()})),l.onDidBlurEditorWidget((function(){let e=o.element.children("textarea"),t=s.getValue();e.trigger("blur"),c!==t&&e.val(t).trigger("change")})),n.validatePageItems&&n.pageInfo.pageId&&o._initializeItemValidator(),o._configureCustomSuggestionProvider(),o._initializeCustomActions(),o._setupMinimap();let u=monaco.editor.EditorOptions.accessibilitySupport.id;l.onDidChangeConfiguration((function(e){e.hasChanged(u)&&(n.accessibilityMode=l.getOption(u)===monaco.editor.AccessibilitySupport.Enabled,o._notifyPreferenceChange())})),o._monacoEditor$.on("change",(function(e){e.stopPropagation()})),void 0!==o._tempValue&&(s.setValue(o._tempValue),o._tempValue=void 0),l.onDidFocusEditorWidget((()=>{[p,f,h].includes(n.language)&&me.reevaluate(n.language,n.pageInfo),ye()})),o._on(o._eventHandlers),n.onInitialized&&n.onInitialized(l)})()},_eventHandlers:{resize:function(e){this.resize(),e.stopPropagation()},focusin:function(){this.element.addClass(g)},focusout:function(){this.element.removeClass(g)}},_destroy:function(){this._editor&&this._editor.dispose()},_setOption:function(e,t){let o=this,n=o.options,i=o._editor;o._super(e,t),["errors","warnings"].includes(e)?o._updateNotifications():"language"===e?o._setLanguage(t):"tabsInsertSpaces"===e?i.updateOptions({insertSpaces:t}):"ruler"===e?i.updateOptions({rulers:t?[80]:[]}):"theme"===e?(n.theme=t,_e(t)):"minimap"===e?o._setupMinimap():"lineNumbers"===e?i.updateOptions({lineNumbers:!!t}):"accessibilityMode"===e?i.updateOptions({accessibilitySupport:t?"on":"off"}):"whitespace"===e?i.updateOptions({renderWhitespace:t?"all":"none"}):"showSuggestions"===e?i.updateOptions({quickSuggestions:!!t}):"bracketPairColorization"===e&&i.updateOptions({"bracketPairColorization.enabled":!!t})},setValue:function(e){this._model?this._model.setValue(e):this._tempValue=e},getValue:function(){return this._model?this._model.getValue():void 0!==this._tempValue?this._tempValue:this.options.value},getEditor:function(){return this._editor},resize:function(){let e=this,t=e._editor;e.options.heightFn&&e._editor$.outerHeight(e.options.heightFn()),t&&t.layout()},getSelection:function(){return this._model.getValueInRange(this._editor.getSelection())},showNotification:function(e){let t=this._notification$.show().children().first();"string"==typeof e?t.html(e):"object"==typeof e&&e instanceof jQuery?(t.empty(),t.append(e)):u("The notification message must be a string or a jQuery object"),this.resize()},resetNotification:function(){this._notification$.hide().children().first().empty(),this.resize()},showSuccessNotification:function(e){this.showNotification(`<ul><li class="is-success">${e}</li></ul>`)},focus:function(){this.element.addClass(g),this._editor.focus()},setCursor:function(e,t){this._editor.setPosition({lineNumber:e,column:t})},setCursorToEnd:function(e){let t=this._editor,o=this._model,n=o.getLineCount(),i=o.getLineMaxColumn(n);this.setCursor(n,i),e&&t.revealLine(n)},changeGeneration:function(){return this._model.getAlternativeVersionId()},isClean:function(e){return this._model.getAlternativeVersionId()===e},getPreferencesString:function(){let e=this.options,t={},o=Object.values(Y);for(let n=0;n<o.length;n++){let i=o[n];t[i]=e[i]}return JSON.stringify(t)},_disposableExists:function(e){return ge.existsForEditor(this._editorId,e)},_registerDisposable:function(e,t){ge.registerForEditor(this._editorId,e,t)},_disposeDisposable:function(e){ge.disposeForEditor(this._editorId,e)},_disposeAllDisposables:function(){ge.deregisterEditor(this._editorId)},_triggerMonacoAction:function(e){const t=this._editor;this.focus(),t.trigger(null,e)},_configureCustomSuggestionProvider:function(){let e,t,o=this,n=o._editor,i=o.options,r=Se(i.language),a=i.suggestions;if(a){if(Array.isArray(a))e=a;else{if("function"!=typeof a)return void u("Suggestions type not supported");e=a(r)}e=e.map((e=>(e.insertText=e.insertText||e.label,e))),o._registerDisposable("global-suggestions",monaco.languages.registerCompletionItemProvider(r,{provideCompletionItems:function(o,i){if(n.hasTextFocus()){t=o.getWordUntilPosition(i);const n=e.map((e=>(e.range={startLineNumber:i.lineNumber,endLineNumber:i.lineNumber,startColumn:t.startColumn,endColumn:t.endColumn},e.kind=monaco.languages.CompletionItemKind.Constructor,e)));return n.length?{suggestions:n}:void 0}}})),i.language===f&&o._registerDisposable("mle-env",monaco.languages.registerCompletionItemProvider(E,{triggerCharacters:["."],provideCompletionItems:function(o,i,r){if(n.hasTextFocus()&&r.triggerKind===monaco.languages.CompletionTriggerKind.TriggerCharacter&&"."===r.triggerCharacter&&o.getLineContent(i.lineNumber).substr(0,i.column-2).endsWith("apex.env")){t=o.getWordUntilPosition(i);const n=e.map((e=>(e.range={startLineNumber:i.lineNumber,endLineNumber:i.lineNumber,startColumn:t.startColumn,endColumn:t.endColumn},e.kind=monaco.languages.CompletionItemKind.Constructor,e)));return n.length?{suggestions:n}:void 0}}}))}},_setupMinimap:function(){const e=this,o=e.options,n=e._editor,i=e._model;function r(){n&&i&&!i.isDisposed()&&n.updateOptions({minimap:{enabled:"on"===o.minimap||o.minimap===te&&i.getLineCount()>=100}})}e._disposableExists(de)&&e._disposeDisposable(de),o.minimap===te&&e._registerDisposable(de,i.onDidChangeContent(t.debounce(r,1e3))),r()},_getLineFromMessage:function(e){let t=e.indexOf("ORA-06550");if(t>-1){let o=e.slice(t).match(/\d{1,}/g),n=parseInt(o[1],10),i=parseInt(o[2],10);return isNaN(n)&&(n=0),isNaN(i)&&(i=0),{lineNumber:n,columnNumber:i}}return null},gotoPosition:function(e,t,o=!0){let n=this._editor;n&&(n.revealLineInCenter(e),n.setPosition({lineNumber:e,column:t}),o&&setTimeout((function(){n&&n.focus()}),100))},_updateNotifications:function(){let o=this,n=o.options,i=e("<ul/>");if(n.errors.length||n.warnings.length){for(let r=0;r<n.errors.length;r++){let a=t.escapeHTML(n.errors[r]),s=o._getLineFromMessage(a),l=e('<li class="is-error" style="cursor: pointer;"></li>');s?l.append(e(`<a data-line="${s.lineNumber}" data-column="${s.columnNumber}"></a>`).html(a)):l.html(a),i.append(l)}for(let r=0;r<n.warnings.length;r++){let a=t.escapeHTML(n.warnings[r]),s=o._getLineFromMessage(a),l=e('<li class="is-warning" style="cursor: pointer;"></li>');s?l.append(e(`<a data-line="${s.lineNumber}" data-column="${s.columnNumber}"></a>`).html(a)):l.html(a),i.append(l)}o.showNotification(i)}else o.resetNotification();e("a[data-line]",i).on("click",(function(){o.gotoPosition(e(this).data("line"),e(this).data("column"))})),o._updateLineMessages()},_updateLineMessages:function(){let e,o=this,n=o.options,i=o._model,r=[];function a(e){let o=e.message.split(":").slice(e.afterColonIndex).join(":").trim();return e.removeHtmlTags&&(o=t.stripHTML(o)),o.length?o:e.message}for(let t=0;t<n.errors.length;t++)e=o._getLineFromMessage(n.errors[t]),e&&r.push({startLineNumber:e.lineNumber,endLineNumber:e.lineNumber,startColumn:e.columnNumber,endColumn:1e3,message:a({message:n.errors[t],afterColonIndex:4,removeHtmlTags:!0}),severity:monaco.MarkerSeverity.Error});for(let t=0;t<n.warnings.length;t++)e=o._getLineFromMessage(n.warnings[t]),e&&r.push({startLineNumber:e.lineNumber,endLineNumber:e.lineNumber,startColumn:e.columnNumber,endColumn:1e3,message:a({message:n.warnings[t],afterColonIndex:3,removeHtmlTags:!1}),severity:monaco.MarkerSeverity.Warning});monaco.editor.setModelMarkers(i,"lineMessages",r),r.length&&o.gotoPosition(r[0].startLineNumber,r[0].startColumn)},_queryBuilder:function(){let e=this.options.queryBuilder;e&&e(this,this.getValue())},_codeComplete:function(){if(!this.options.codeComplete||![m,f].includes(this.options.language))return;let e,o,n,i,r,a,s=this,l=s.options.language,d=s._editor,c=s._model,u=d.getPosition(),p=c.getLineContent(u.lineNumber),h=!1,b=s.element[0];if(e=function(e,t){for(;" "===e[t];)t-=1;t=e.lastIndexOf(" ",t)+1;let o=e.indexOf(" ",t);return-1===o&&(o=e.length),e.substring(t,o)}(p,u.column-1),o=e.split("."),l===m)1===o.length&&[":","&"].includes(e.charAt(0))?(h=!0,n=e.slice(1)):(i=o[o.length-2],r=o[o.length-3]);else if(l===f){if(3!==o.length||"apex"!==o[0]||"env"!==o[1])return void s._triggerMonacoAction("editor.action.triggerSuggest");h=!0,n=o[2],i=void 0,r=void 0}t.delayLinger.start("autocompleteSpinner",(function(){a=t.showSpinner(b)})),s.options.codeComplete({type:h?"item":"",search:h?n:o[o.length-1],parent:i,grantParent:r},(function(e){apex.util.delayLinger.finish("autocompleteSpinner",(function(){a&&(a.remove(),a=null)}));let t,o,n=monaco.languages.CompletionItemKind,i={template:n.Constructor,application_item:n.Constructor,page_item:n.Constructor,package:n.Constructor,procedure:n.Method,function:n.Function,constant:n.Constructor,variable:n.Constructor,type:n.Constructor,table:n.Constructor,view:n.Constructor,keyword:n.Constructor,sequence:n.Constructor},r=[];for(let n=0;n<e.length;n++){t=e[n];for(let e=0;e<t.completions.length;e++){o=t.completions[e];let n=o.r||o;r.push({label:o.d||o,insertText:n,detail:t.title,kind:i[t.type]})}}let l=!1;s._registerDisposable("ajax-suggestions",monaco.languages.registerCompletionItemProvider(c._languageId,{provideCompletionItems:function(){return s.element.hasClass(g)&&!l?(l=!0,r.length?{suggestions:r}:void 0):void 0}})),s._triggerMonacoAction("editor.action.triggerSuggest")}))},_validateCode:function(){if(!this.options.validateCode)return;let o=this;o.options.validateCode(o.getValue(),(function(n){n=e.extend({},{errors:[],warnings:[]},n),o._setOption("errors",n.errors),o._setOption("warnings",n.warnings),0===n.errors.length&&0===n.warnings.length&&o.showSuccessNotification(t.escapeHTML(J))}))},_notifyPreferenceChange:function(){let t=this.element[0];this._trigger("preferencesChanged",e.Event("click",{target:t}))},_populateContext:function(){let e=this,t=e.options,o=t.language,n=e._editor,i=e._model,r=e._context;function a(){i.updateOptions({insertSpaces:t.tabsInsertSpaces,tabSize:t.tabSize,indentSize:t.indentSize})}r.add([{name:"undo",action:function(){e._triggerMonacoAction("undo")}},{name:"redo",action:function(){e._triggerMonacoAction("redo")}},{name:"find",action:function(){e._triggerMonacoAction(t.readOnly?"actions.find":"editor.action.startFindReplaceAction")}},{name:"theme",get:function(){return t.theme},set:function(o){t.theme=o,_e(o),e._notifyPreferenceChange()},choices:ee},{name:"minimap",get:function(){return t.minimap},set:function(o){t.minimap=o,e._setupMinimap(),e._notifyPreferenceChange()},choices:oe},{name:"tabs-insert-spaces",label:A,get:function(){return t.tabsInsertSpaces},set:function(o){t.tabsInsertSpaces=o,a(),e._notifyPreferenceChange()}},{name:"tab-size",get:function(){return t.tabSize},set:function(o){t.tabSize=o,a(),e._notifyPreferenceChange()},choices:ne},{name:"indent-size",get:function(){return t.indentSize},set:function(o){t.indentSize=o,a(),e._notifyPreferenceChange()},choices:ie},{name:"show-ruler",label:R,get:function(){return t.ruler},set:function(t){e._setOption("ruler",t),e._notifyPreferenceChange()}},{name:"line-numbers",label:q,get:function(){return t.lineNumbers},set:function(t){e._setOption("lineNumbers",t),e._notifyPreferenceChange()}},{name:"whitespace",label:X,get:function(){return t.whitespace},set:function(t){e._setOption("whitespace",t),e._notifyPreferenceChange()}},{name:"show-suggestions",label:D,get:function(){return t.showSuggestions},set:function(t){e._setOption("showSuggestions",t),e._notifyPreferenceChange()}},{name:"accessibility-mode",label:I,get:function(){return t.accessibilityMode},set:function(t){e._setOption("accessibilityMode",t),e._notifyPreferenceChange()}},{name:"bracket-pair-colorization",label:Z,get:function(){return t.bracketPairColorization},set:function(t){e._setOption("bracketPairColorization",t),e._notifyPreferenceChange()}}]),t.queryBuilder&&r.add({name:"query-builder",hide:o!==m,action:function(){e._queryBuilder()}}),t.codeComplete&&(r.add({name:"code-complete",hide:![m,f].includes(o),action:function(){e._codeComplete()}}),n.addAction({id:"apex-code-complete",label:L,keybindings:[Ce()|monaco.KeyCode.Space],precondition:y,run:function(){e._codeComplete()}})),t.validateCode&&(r.add({name:"validate",hide:o!==m,action:function(){e._validateCode()}}),n.addAction({id:"apex-code-validate",label:W,keybindings:[Ce()|monaco.KeyMod.Alt|monaco.KeyCode.KeyV],precondition:S,run:function(){e._validateCode()}})),function(){let e=i.getAlternativeVersionId(),t=e,o=e;n.onDidChangeModelContent((()=>{let n=i.getAlternativeVersionId();n<t?(r.enable("redo"),n===e&&r.disable("undo")):(n<=o?n===o&&r.disable("redo"):(r.disable("redo"),t>o&&(o=t)),r.enable("undo")),t=n})),r.disable("undo"),r.disable("redo")}()},_initToolbar:function(e){let t,o=this.options,n={actionsContext:this._context,simple:!0,data:[]},i=[];i.push({type:"BUTTON",title:$,label:$,iconOnly:!0,icon:"icon-undo",action:"undo"}),i.push({type:"BUTTON",title:P,label:P,iconOnly:!0,icon:"icon-redo",action:"redo"}),n.data.push({id:"undoControls",align:"start",groupTogether:!0,controls:i});let r=[];if(r.push({type:"BUTTON",title:N,label:N,iconOnly:!0,icon:"icon-cm-find",action:"find"}),n.data.push({id:"searchControls",align:"start",groupTogether:!0,controls:r}),o.queryBuilder||o.codeComplete||o.validateCode){let e={id:"helperControls",align:"start",groupTogether:!0,controls:[]};o.queryBuilder&&e.controls.push({type:"BUTTON",title:O,label:O,iconOnly:!0,icon:"icon-cm-query-builder",action:"query-builder"}),o.codeComplete&&(t=L+" - Ctrl+Space",e.controls.push({type:"BUTTON",title:t,label:t,iconOnly:!0,icon:"icon-cm-autocomplete",action:"code-complete"})),o.validateCode&&(t=W+" - Ctrl+Alt+V",e.controls.push({type:"BUTTON",title:t,label:t,iconOnly:!0,icon:"icon-cm-validate",action:"validate"})),n.data.push(e)}n.data.push({id:"menuControls",align:"end",groupTogether:!1,controls:[{type:"MENU",title:w,label:w,iconOnly:!0,icon:"icon-gear",menu:{items:[{type:"subMenu",label:T,menu:{items:[{type:"toggle",action:"tabs-insert-spaces"},{type:"subMenu",label:B,menu:{items:[{type:"radioGroup",action:"tab-size"}]}},{type:"subMenu",label:k,menu:{items:[{type:"radioGroup",action:"indent-size"}]}}]}},{type:"subMenu",label:F,menu:{items:[{type:"radioGroup",action:"theme"}]}},{type:"subMenu",label:M,menu:{items:[{type:"radioGroup",action:"minimap"}]}},{type:"toggle",action:"accessibility-mode"},{type:"toggle",action:"line-numbers"},{type:"toggle",action:"show-ruler"},{type:"toggle",action:"show-suggestions"},{type:"toggle",action:"whitespace"},{type:"toggle",action:"bracket-pair-colorization"}]}}]}),e.toolbar(n)},_evaluateContextKeys:function(e){const t=this._contextKeys,o=this._editor;t.isSql||(t.isSql=o.createContextKey(S,!0)),t.dbHint||(t.dbHint=o.createContextKey(y,!0)),t.isSql.set(e===m),t.dbHint.set([m,f].includes(e))},_setLanguage:function(e){let t=this,o=t._model,n=t.options,i=t._context;function r(e){i.lookup(e)&&i.hide(e)}function a(e){i.lookup(e)&&i.show(e)}monaco.editor.setModelMarkers(o,"lineMessages",[]),t.resetNotification(),t._configureCustomSuggestionProvider(),[m,f].includes(e)?a("code-complete"):r("code-complete"),e===m?(a("validate"),a("query-builder")):(r("validate"),r("query-builder")),t._evaluateContextKeys(e),pe(e,n),monaco.editor.setModelLanguage(o,Se(e))},_initializeItemValidator:function(){let e=this._model,n=this.options,i=n.pageInfo.pageId,r=new RegExp("P("+i+"|0)_[A-Z0-9_]*","gi"),a=[],s=n.pageInfo.items.map((e=>e.name.toLowerCase())),l=t.debounce((function(){if(a=[],e&&!e.isDisposed()){const t=e.getLineCount();for(let n=1;n<=t;n++){const t=e.getLineContent(n).matchAll(r);for(let e of t){let t=e[0].toLowerCase(),i=e.index+1;s.includes(t)||a.push({startLineNumber:n,endLineNumber:n,startColumn:i,endColumn:i+t.length,message:o.formatMessage("CODE_EDITOR.ITEM_DOES_NOT_EXIST",t.toUpperCase()),severity:monaco.MarkerSeverity.Warning})}}monaco.editor.setModelMarkers(e,"itemValidations",a)}}),100);e.onDidChangeContent(l),l()},_initializeCustomActions:function(){let e=this,t=e._editor,o=e._model,n=Ce();function i(e,o){let n=t.getAction(e);t.addAction({id:e,label:n.label,alias:n.alias,keybindings:[o],run:function(){n.run()}})}i("editor.action.transformToUppercase",n|monaco.KeyMod.Alt|monaco.KeyCode.KeyU),i("editor.action.transformToLowercase",n|monaco.KeyMod.Alt|monaco.KeyCode.KeyL),t.addAction({id:"editor.action.toggleSmartCase",label:U,alias:U,keybindings:[n|monaco.KeyMod.Alt|monaco.KeyCode.KeyC],run:function(){let e=t.getSelections();if(!e.length)return;if(!o)return;let n=[];for(let t=0;t<e.length;t++){let i=e[t];if(!i.isEmpty()){let e=Ee(o.getValueInRange(i));n.push({range:i,text:e})}}t.pushUndoStop(),t.executeEdits(null,n),t.pushUndoStop()}}),t.addCommand(monaco.KeyMod.CtrlCmd|monaco.KeyMod.Shift|monaco.KeyCode.KeyP,(()=>{e._triggerMonacoAction("editor.action.quickCommand")}))}}),e.apex.codeEditor=e.apex.codeEditor||{},e.apex.codeEditor.LANG_SQL=m,e.apex.codeEditor.LANG_JAVASCRIPT=p,e.apex.codeEditor.LANG_JAVASCRIPT_MLE_SNIPPET=f,e.apex.codeEditor.LANG_JAVASCRIPT_MLE_MODULE=h,e.apex.codeEditor.LANG_CSS="css",e.apex.codeEditor.LANG_FILE_URLS_JAVASCRIPT=_,e.apex.codeEditor.LANG_FILE_URLS_CSS=C,e.apex.codeEditor.LANG_HTML="html",e.apex.codeEditor.LANG_XML="xml",e.apex.codeEditor.LANG_QUICKSQL=b,e.apex.codeEditor.registerJavaScriptContextCode=me.setContext,e.apex.codeEditor.deregisterJavaScriptContextCode=me.dropContext,e.apex.codeEditor.preferencesObjectFromString=function(e){let t,o={};if(!e)return{};try{t=JSON.parse(e)}catch(e){return c("Could not parse optionsString"),{}}return Object.values(Y).forEach((e=>{let n=t[e],i=e;if(i===Y.THEME){if(!ee.map((e=>e.value)).includes(n))return void c("Bad theme ignored: "+n)}else if([Y.INDENT_SIZE,Y.TAB_SIZE].includes(i)){if(!["2","3","4","8"].includes(n))return void c("Bad number ignored: "+n)}else if("minimap"===i){if(!oe.map((e=>e.value)).includes(n))return void c("Bad minimap ignored: "+n)}else{if(![Y.TABS_INSERT_SPACES,Y.RULER,Y.ACCESSIBILITY_MODE,Y.LINE_NUMBERS,Y.WHITESPACE,Y.SHOW_SUGGESTIONS,Y.BRACKET_PAIR_COLORIZATION].includes(i))return void c("Unknown preference: "+i);n=!!n}o[i]=n})),o}}(apex.jQuery,apex.util,apex.lang,apex.locale,apex.debug,apex.actions,apex.server,apex.env);